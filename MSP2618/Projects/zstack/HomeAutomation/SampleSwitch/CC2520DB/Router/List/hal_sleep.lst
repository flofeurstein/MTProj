###############################################################################
#                                                                             #
# IAR C/C++ Compiler V5.52.1.50724/W32 for MSP430       10/Jun/2013  16:30:19 #
# Copyright 1996-2013 IAR Systems AB.                                         #
#                                                                             #
#    __rt_version  =  3                                                       #
#    __double_size =  32                                                      #
#    __reg_r4      =  free                                                    #
#    __reg_r5      =  free                                                    #
#    __pic         =  no                                                      #
#    __core        =  430X                                                    #
#    __data_model  =  small                                                   #
#    Source file   =  C:\Texas Instruments\ZStack-MSP2618-2.5.1\Components\ha #
#                     l\target\MSP2618CC2520\hal_sleep.c                      #
#    Command line  =  -f "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\ #
#                     zstack\HomeAutomation\SampleSwitch\CC2520DB\..\..\..\To #
#                     ols\MSP2618\f8wConfig.cfg" (-DZIGBEEPRO -DSECURE=0      #
#                     -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                       #
#                     -DDEFAULT_CHANLIST=0x00000800                           #
#                     -DZDAPP_CONFIG_PAN_ID=0xFFFF -DNWK_START_DELAY=100      #
#                     -DEXTENDED_JOINING_RANDOM_MASK=0x007F                   #
#                     -DBEACON_REQUEST_DELAY=100                              #
#                     -DBEACON_REQ_DELAY_MASK=0x00FF                          #
#                     -DLINK_STATUS_JITTER_MASK=0x007F                        #
#                     -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_POLLED= #
#                     3000 -DNWK_INDIRECT_MSG_TIMEOUT=7 -DMAX_RREQ_ENTRIES=8  #
#                     -DAPSC_MAX_FRAME_RETRIES=3 -DNWK_MAX_DATA_RETRIES=2     #
#                     -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9              #
#                     -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40                #
#                     -DNWK_MAX_BINDING_ENTRIES=4                             #
#                     -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,       #
#                     0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00, 0x02,   #
#                     0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"                    #
#                     -DMAC_MAX_FRAME_SIZE=116 -DZDNWKMGR_MIN_TRANSMISSIONS=2 #
#                     0 -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000           #
#                     -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100         #
#                     -DREJOIN_POLL_RATE=440) -f "C:\Texas                    #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\Tools\MSP2618\f #
#                     8wRouter.cfg" (-DCPU6MHZ -DMAC_CFG_APP_PENDING_QUEUE=TR #
#                     UE -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8           #
#                     -DMAC_CFG_RX_MAX=5 -DRTR_NWK) -f "C:\Texas              #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\Tools\MSP2618\f #
#                     8wZCL.cfg" (-DZCL_READ -DZCL_WRITE -DZCL_BASIC          #
#                     -DZCL_IDENTIFY -DZCL_ON_OFF -DZCL_KEY_ESTABLISH         #
#                     -DZCL_KEY_ESTABLISHMENT_KEY_GENERATE_TIMEOUT=4          #
#                     -DZCL_KEY_ESTABLISHMENT_MAC_GENERATE_TIMEOUT=10         #
#                     -DZCL_KEY_ESTABLISHMENT_EKEY_GENERATE_TIMEOUT=10        #
#                     -DZCL_LOAD_CONTROL -DZCL_SIMPLE_METERING -DZCL_PRICING  #
#                     -DZCL_MESSAGE -DZCL_TUNNELING -DZCL_TOU)                #
#                     -DZCL_DEVICE_MGMT "C:\Texas                             #
#                     Instruments\ZStack-MSP2618-2.5.1\Components\hal\target\ #
#                     MSP2618CC2520\hal_sleep.c" -D MSP430F2618 -D ZTOOL_P1   #
#                     -D MT_TASK -D MT_SYS_FUNC -D MT_ZDO_FUNC -D             #
#                     LCD_SUPPORTED -lC "C:\Texas                             #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\Router\List\" -lA        #
#                     "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\zst #
#                     ack\HomeAutomation\SampleSwitch\CC2520DB\Router\List\"  #
#                     --remarks --diag_suppress Pe001,Pe193,Pe236,Pe826 -o    #
#                     "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\zst #
#                     ack\HomeAutomation\SampleSwitch\CC2520DB\Router\Obj\"   #
#                     --debug -D__MSP430F2618__ -e --double=32 --clib -I      #
#                     "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\zst #
#                     ack\HomeAutomation\SampleSwitch\CC2520DB\" -I           #
#                     "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\zst #
#                     ack\HomeAutomation\SampleSwitch\CC2520DB\..\Source\"    #
#                     -I "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\ #
#                     zstack\HomeAutomation\SampleSwitch\CC2520DB\..\..\Sourc #
#                     e\" -I "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Proje #
#                     cts\zstack\HomeAutomation\SampleSwitch\CC2520DB\..\..\. #
#                     .\ZMain\MSP2618\" -I "C:\Texas                          #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\hal\include\" -I "C:\Texas                            #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\hal\target\MSP2618CC2520\" -I "C:\Texas               #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\mac\include\" -I "C:\Texas                            #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\mac\high_level\" -I "C:\Texas                         #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\mac\low_level\srf04\" -I "C:\Texas                    #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\mac\low_level\srf04\dual_chip\" -I "C:\Texas          #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\mt\" -I "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Pr #
#                     ojects\zstack\HomeAutomation\SampleSwitch\CC2520DB\..\. #
#                     .\..\..\..\Components\osal\include\" -I "C:\Texas       #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\osal\mcu\msp430\" -I "C:\Texas                        #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\services\saddr\" -I "C:\Texas                         #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\services\sdata\" -I "C:\Texas                         #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\stack\af\" -I "C:\Texas Instruments\ZStack-MSP2618-2. #
#                     5.1\Projects\zstack\HomeAutomation\SampleSwitch\CC2520D #
#                     B\..\..\..\..\..\Components\stack\nwk\" -I "C:\Texas    #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\stack\sec\" -I "C:\Texas                              #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\stack\sapi\" -I "C:\Texas                             #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\stack\sys\" -I "C:\Texas                              #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\stack\zcl\" -I "C:\Texas                              #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\stack\zdo\" -I "C:\Texas                              #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\zmac\" -I "C:\Texas Instruments\ZStack-MSP2618-2.5.1\ #
#                     Projects\zstack\HomeAutomation\SampleSwitch\CC2520DB\.. #
#                     \..\..\..\..\Components\zmac\f8w\" --core=430X          #
#                     --data_model=small -Ohz --multiplier=16s                #
#                     --require_prototypes                                    #
#    List file     =  C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\zsta #
#                     ck\HomeAutomation\SampleSwitch\CC2520DB\Router\List\hal #
#                     _sleep.lst                                              #
#    Object file   =  C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\zsta #
#                     ck\HomeAutomation\SampleSwitch\CC2520DB\Router\Obj\hal_ #
#                     sleep.r43                                               #
#                                                                             #
#                                                                             #
###############################################################################

C:\Texas Instruments\ZStack-MSP2618-2.5.1\Components\hal\target\MSP2618CC2520\hal_sleep.c
      1          /**************************************************************************************************
      2            Filename:       hal_sleep.c
      3            Revised:        $Date: 2012-02-26 13:16:49 -0800 (Sun, 26 Feb 2012) $
      4            Revision:       $Revision: 29524 $
      5          
      6            Description:    This module contains the HAL power management procedures for the MSP430.
      7          
      8          
      9            Copyright 2006-2012 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License"). You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product. Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /* ------------------------------------------------------------------------------------------------
     41           *                                          Includes
     42           * ------------------------------------------------------------------------------------------------
     43           */
     44          #include <intrinsics.h>
     45          #include "hal_types.h"
     46          #include "hal_mcu.h"

   \                                 In  segment DATA16_AN, at 0x160
   \   unsigned short volatile TACTL
   \                     TACTL:
   \   000000                DS8 2

   \                                 In  segment DATA16_AN, at 0x162
   \   unsigned short volatile TACCTL0
   \                     TACCTL0:
   \   000000                DS8 2

   \                                 In  segment DATA16_AN, at 0x170
   \   unsigned short volatile TAR
   \                     TAR:
   \   000000                DS8 2

   \                                 In  segment DATA16_AN, at 0x172
   \   unsigned short volatile TACCR0
   \                     TACCR0:
   \   000000                DS8 2
     47          #include "hal_board.h"
     48          #include "hal_sleep.h"
     49          #include "hal_mac_cfg.h"
     50          #include "hal_led.h"
     51          #include "hal_key.h"
     52          #include "hal_drivers.h"
     53          #include "mac_pib.h"
     54          #include "mac_api.h"
     55          #include "OSAL.h"
     56          #include "mac_radio_defs.h"
     57          #include "OnBoard.h"
     58          #include "hal_assert.h"
     59          
     60          
     61          /* ------------------------------------------------------------------------------------------------
     62           *                                           Macros
     63           * ------------------------------------------------------------------------------------------------
     64           */
     65          
     66          /* POWER CONSERVATION DEFINITIONS
     67           * Sleep mode definitions (enabled with POWER_SAVING compile option)
     68           */
     69          #define MSP430_AM             0        /* All clocks are active */
     70          #define MSP430_LPM3           1        /* CPU is disabled; MCLK, FLL+ loop control, and DCOCLK are disabled;
     71                                                  * DCO's dc-generator is disabled; ACLK remains active */
     72          #define MSP430_LPM4           2        /* In addition to LPM3, Crystal oscillator is stopped */
     73          
     74          /* HAL power management mode is set according to the power management state. The default
     75           * setting is HAL_SLEEP_OFF. The actual value is tailored to different HW platform. Both
     76           * HAL_SLEEP_TIMER and HAL_SLEEP_DEEP selections will:
     77           *   1. turn off the system clock, and
     78           *   2. halt the MCU.
     79           * HAL_SLEEP_TIMER can be woken up by sleep timer interrupt, I/O interrupt and reset.
     80           * HAL_SLEEP_DEEP can be woken up by I/O interrupt and reset.
     81           */
     82          #define HAL_SLEEP_OFF         MSP430_AM
     83          #define HAL_SLEEP_TIMER       MSP430_LPM3
     84          #define HAL_SLEEP_DEEP        MSP430_LPM4
     85          
     86          /* minimum time to sleep */
     87          #define MIN_SLEEP_TIME        14
     88          
     89          /* MAX_SLEEP_COUNT calculation:
     90           * 16-bit MAC timer maximum sleep duration = 0xFFFF/(32.768KHz/8) = 16 seconds
     91           */
     92          #define MAX_SLEEP_COUNT                  0xFFFF              /* maximum sleep count allowed by H/W */
     93          
     94          /* set MSP430 power mode */
     95          #define HAL_SLEEP_TIMER_SLEEP()             st( (macPib.beaconOrder == MAC_BO_NON_BEACON)? \
     96                                                           __low_power_mode_3() : __low_power_mode_1(); \
     97                                                        )
     98          
     99          #define HAL_SLEEP_SET_POWER_MODE(mode)      st( if ( mode == MSP430_LPM3 ) { HAL_SLEEP_TIMER_SLEEP(); }   \
    100                                                          else if ( mode == MSP430_LPM4 ) { __low_power_mode_4(); } \
    101                                                        )
    102          
    103          /* sleep timer interrupt control */
    104          #define HAL_SLEEP_TIMER_ENABLE_INT()        MAC_RADIO_TIMER_WAKE_UP()
    105          #define HAL_SLEEP_TIMER_DISABLE_INT()       MAC_RADIO_TIMER_SLEEP()
    106          
    107          /* convert msec to 320 usec units with round */
    108          #define HAL_SLEEP_MS_TO_320US(ms)           (((((uint32) (ms)) * 100) + 31) / 32)
    109          
    110          /* convert 320 usec units to msec with round */
    111          #define HAL_SLEEP_320US_TO_MS(u320)         (((((uint32) (u320)) * 8) + 24) / 25)
    112          
    113          /* Cannot turn off interrupt for Beacon Enabled MAC */
    114          #define HAL_SLEEP_DISABLE_INTERRUPTS()      st( if (macPib.beaconOrder == MAC_BO_NON_BEACON) HAL_DISABLE_INTERRUPTS(); )
    115          
    116          /* Wakeup early so that the radio is powered up before RX is enabled */
    117          #define HAL_BEACON_ENABLE_EARLY_WAKEUP()    ((uint8) ((macPib.beaconOrder == MAC_BO_NON_BEACON) ? 0 : 2 ))
    118          
    119          
    120          /* ------------------------------------------------------------------------------------------------
    121           *                                        Local Variables
    122           * ------------------------------------------------------------------------------------------------
    123           */
    124          
    125          /* HAL power management mode is set according to the power management state.
    126           */

   \                                 In  segment DATA16_Z, align 1, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
    127          static uint8 halPwrMgtMode = HAL_SLEEP_OFF;
   \                     halPwrMgtMode:
   \   000000                DS8 1
    128          
    129          /* stores the sleep timer count upon entering sleep */

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
    130          static uint16 halSleepTimerStart;
   \                     halSleepTimerStart:
   \   000000                DS8 2
    131          
    132          /* stores the sleep timer compare count upon entering sleep */

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
    133          static uint16 halSleepTimerCompareStart;
   \                     halSleepTimerCompareStart:
   \   000000                DS8 2
    134          
    135          /* stores the accumulated sleep time */

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
    136          static uint32 halAccumulatedSleepTime;
   \                     halAccumulatedSleepTime:
   \   000000                DS8 4
    137          
    138          /* ------------------------------------------------------------------------------------------------
    139           *                                      Function Prototypes
    140           * ------------------------------------------------------------------------------------------------
    141           */
    142          
    143          void halSleepSetTimer( uint32 timeout );
    144          uint32 halMacTimerElapsed( uint32 *timeout );
    145          
    146          /**************************************************************************************************
    147           * @fn          halSleep
    148           *
    149           * @brief       This function is called from the OSAL task loop using and existing OSAL
    150           *              interface.  It sets the low power mode of the MAC and MCU.
    151           *
    152           * input parameters
    153           *
    154           * @param       osal_timeout - Next OSAL timer timeout.
    155           *
    156           * output parameters
    157           *
    158           * None.
    159           *
    160           * @return      None.
    161           **************************************************************************************************
    162           */

   \                                 In  segment CODE, align 2
   \                     ?Subroutine1:
   \   000000   924260016001 MOV.W   &0x160, &0x160
   \   000006   B2D010006001 BIS.W   #0x10, &0x160
   \   00000C   1001         RETA

   \                                 In  segment CODE, align 2
    163          void halSleep( uint16 osal_timeout )
   \                     halSleep:
    164          {
   \   000000   0A12         PUSH.W  R10
   \   000002   2182         SUB.W   #0x4, SP
   \   000004   0A4C         MOV.W   R12, R10
    165            uint32        timeout;
    166            uint32        macTimeout;
    167          
    168            /* Avoid using critical section macros because low power mode macros.
    169             * Assert if we enter sleep without interrupt enabled.
    170             */
    171            HAL_ASSERT( HAL_INTERRUPTS_ARE_ENABLED() );
   \   000006   0F42         MOV.W   SR, R15
   \   000008   3FB2         BIT.W   #0x8, R15
   \   00000A   022C         JC      ??halSleep_7
   \   00000C   ........     CALLA   #halAssertHandler
    172          
    173            /* Don't sleep if time too short or if a key is pressed */
    174            if ( osal_timeout && (osal_timeout < MIN_SLEEP_TIME) )
   \                     ??halSleep_7:
   \   000010   0A93         CMP.W   #0x0, R10
   \   000012   0324         JEQ     ??halSleep_5
   \   000014   3A900E00     CMP.W   #0xe, R10
   \   000018   B128         JNC     ??halSleep_4
    175              return;
    176          
    177            /* initialize the accumulated sleep time */
    178            halAccumulatedSleepTime = 0;
   \                     ??halSleep_5:
   \   00001A   8243....     MOV.W   #0x0, &halAccumulatedSleepTime
   \   00001E   8243....     MOV.W   #0x0, &halAccumulatedSleepTime + 2
    179          
    180            /* get next OSAL timer expiration converted to 320 usec units */
    181            timeout = HAL_SLEEP_MS_TO_320US(osal_timeout);
   \   000022   0C4A         MOV.W   R10, R12
   \   000024   0D43         MOV.W   #0x0, R13
   \   000026   ........     CALLA   #?Subroutine0
   \                     ??CrossCallReturnLabel_0:
   \   00002A   ........     CALLA   #?Subroutine3
    182            if (timeout == 0)
   \                     ??CrossCallReturnLabel_9:
   \   00002E   2F41         MOV.W   @SP, R15
   \   000030   0FDD         BIS.W   R13, R15
   \   000032   0F93         CMP.W   #0x0, R15
   \   000034   0320         JNE     ??halSleep_8
    183            {
    184              timeout = MAC_PwrNextTimeout();
   \   000036   ........     CALLA   #MAC_PwrNextTimeout
   \   00003A   0C3C         JMP     ??halSleep_6
    185            }
    186            else
    187            {
    188              /* get next MAC timer expiration */
    189              macTimeout = MAC_PwrNextTimeout();
   \                     ??halSleep_8:
   \   00003C   ........     CALLA   #MAC_PwrNextTimeout
    190          
    191              /* get lesser of two timeouts */
    192              if ((macTimeout != 0) && (macTimeout < timeout))
   \   000040   0F4C         MOV.W   R12, R15
   \   000042   0FDD         BIS.W   R13, R15
   \   000044   0F93         CMP.W   #0x0, R15
   \   000046   0824         JEQ     ??halSleep_9
   \   000048   1D910200     CMP.W   0x2(SP), R13
   \   00004C   0328         JNC     ??halSleep_6
   \   00004E   0420         JNE     ??halSleep_9
   \   000050   2C91         CMP.W   @SP, R12
   \   000052   022C         JC      ??halSleep_9
    193              {
    194                timeout = macTimeout;
   \                     ??halSleep_6:
   \   000054   ........     CALLA   #?Subroutine3
    195              }
    196            }
    197          
    198            /* Adjust the wakup time so that the radio is awake in time
    199             * for beacon transmission.
    200             */
    201            if ( timeout > HAL_BEACON_ENABLE_EARLY_WAKEUP() )
   \                     ??halSleep_9:
   \   000058   7A400F00     MOV.B   #0xf, R10
   \   00005C   C29A....     CMP.B   R10, &macPib + 9
   \   000060   0224         JEQ     ??halSleep_10
   \   000062   6E43         MOV.B   #0x2, R14
   \   000064   013C         JMP     ??halSleep_11
   \                     ??halSleep_10:
   \   000066   4E43         MOV.B   #0x0, R14
   \                     ??halSleep_11:
   \   000068   0F43         MOV.W   #0x0, R15
   \   00006A   1F910200     CMP.W   0x2(SP), R15
   \   00006E   0328         JNC     ??halSleep_12
   \   000070   0920         JNE     ??halSleep_13
   \   000072   2E91         CMP.W   @SP, R14
   \   000074   072C         JC      ??halSleep_13
    202            {
    203              timeout -= HAL_BEACON_ENABLE_EARLY_WAKEUP();
   \                     ??halSleep_12:
   \   000076   2C41         MOV.W   @SP, R12
   \   000078   1D410200     MOV.W   0x2(SP), R13
   \   00007C   0C8E         SUB.W   R14, R12
   \   00007E   0D73         SUBC.W  #0x0, R13
   \   000080   ........     CALLA   #?Subroutine3
    204            }
    205          
    206            /* HAL_SLEEP_PM2 is entered only if the timeout is zero */
    207            halPwrMgtMode = (timeout == 0)? HAL_SLEEP_DEEP : HAL_SLEEP_TIMER;
   \                     ??halSleep_13:
   \   000084   ........     CALLA   #?Subroutine2
   \                     ??CrossCallReturnLabel_4:
   \   000088   0320         JNE     ??halSleep_14
   \   00008A   E243....     MOV.B   #0x2, &halPwrMgtMode
   \   00008E   093C         JMP     ??halSleep_3
   \                     ??halSleep_14:
   \   000090   D243....     MOV.B   #0x1, &halPwrMgtMode
    208          
    209            if ( (timeout > HAL_SLEEP_MS_TO_320US(MIN_SLEEP_TIME)) || (timeout == 0) )
   \   000094   81930200     CMP.W   #0x0, 0x2(SP)
   \   000098   0420         JNE     ??halSleep_3
   \   00009A   B1902D000000 CMP.W   #0x2d, 0(SP)
   \   0000A0   6D28         JNC     ??halSleep_4
    210            {
    211          
    212              HAL_SLEEP_DISABLE_INTERRUPTS();
   \                     ??halSleep_3:
   \   0000A2   C29A....     CMP.B   R10, &macPib + 9
   \   0000A6   0220         JNE     ??halSleep_15
   \   0000A8   32C2         dint
   \   0000AA   0343         nop
    213          
    214              /* always use "deep sleep" to turn off radio VREG on MSP430 */
    215              if (MAC_PwrOffReq(MAC_PWR_SLEEP_DEEP) == MAC_SUCCESS)
   \                     ??halSleep_15:
   \   0000AC   6C43         MOV.B   #0x2, R12
   \   0000AE   ........     CALLA   #MAC_PwrOffReq
   \   0000B2   4C93         CMP.B   #0x0, R12
   \   0000B4   6220         JNE     ??halSleep_16
    216              {
    217                /* Shut down LED */
    218                HalLedEnterSleep();
   \   0000B6   ........     CALLA   #HalLedEnterSleep
    219          
    220                while ( (HAL_SLEEP_MS_TO_320US(halAccumulatedSleepTime) < timeout) || (timeout == 0) )
   \                     ??halSleep_2:
   \   0000BA   1C42....     MOV.W   &halAccumulatedSleepTime, R12
   \   0000BE   1D42....     MOV.W   &halAccumulatedSleepTime + 2, R13
   \   0000C2   ........     CALLA   #?Subroutine0
   \                     ??CrossCallReturnLabel_1:
   \   0000C6   1D910200     CMP.W   0x2(SP), R13
   \   0000CA   1428         JNC     ??halSleep_17
   \   0000CC   0220         JNE     ??halSleep_18
   \   0000CE   2C91         CMP.W   @SP, R12
   \   0000D0   1128         JNC     ??halSleep_17
   \                     ??halSleep_18:
   \   0000D2   ........     CALLA   #?Subroutine2
   \                     ??CrossCallReturnLabel_5:
   \   0000D6   4520         JNE     ??halSleep_19
    221                {
    222                  if (timeout != 0)
    223                  {
    224                    /* set sleep timer, timeout is adjusted for the next time */
    225                    halSleepSetTimer( timeout );
    226          
    227                    /* set up sleep timer interrupt */
    228                    HAL_SLEEP_TIMER_ENABLE_INT();
    229                  }
    230                  else
    231                  {
    232                    /* Halt the timer */
    233                    HAL_MAC_SLEEP_TIMER_HALT();
   \                     ??halSleep_0:
   \   0000D8   B2F0CFFF6001 AND.W   #0xffcf, &0x160
    234                  }
    235          
    236                  HalKeyEnterSleep();
   \                     ??halSleep_1:
   \   0000DE   ........     CALLA   #HalKeyEnterSleep
    237          
    238                  /* set MSP430 power mode, global interrupt will be enabled in the macro */
    239                  HAL_SLEEP_SET_POWER_MODE(halPwrMgtMode);
   \   0000E2   D293....     CMP.B   #0x1, &halPwrMgtMode
   \   0000E6   1820         JNE     ??halSleep_20
   \   0000E8   C29A....     CMP.B   R10, &macPib + 9
   \   0000EC   1220         JNE     ??halSleep_21
   \   0000EE   32D0D800     BIS.W   #0xd8, SR
   \   0000F2   173C         JMP     ??halSleep_22
   \                     ??halSleep_17:
   \   0000F4   ........     CALLA   #?Subroutine2
   \                     ??CrossCallReturnLabel_6:
   \   0000F8   EF27         JEQ     ??halSleep_0
   \   0000FA   2C41         MOV.W   @SP, R12
   \   0000FC   1D410200     MOV.W   0x2(SP), R13
   \   000100   ........     CALLA   #halSleepSetTimer
   \   000104   C29A....     CMP.B   R10, &macPib + 9
   \   000108   EA23         JNE     ??halSleep_1
   \   00010A   B2D010006201 BIS.W   #0x10, &0x162
   \   000110   E63F         JMP     ??halSleep_1
   \                     ??halSleep_21:
   \   000112   32D05800     BIS.W   #0x58, SR
   \   000116   053C         JMP     ??halSleep_22
   \                     ??halSleep_20:
   \   000118   E293....     CMP.B   #0x2, &halPwrMgtMode
   \   00011C   0220         JNE     ??halSleep_22
   \   00011E   32D0F800     BIS.W   #0xf8, SR
    240                  /* wake up from sleep in ISR */
    241          
    242                  HAL_SLEEP_DISABLE_INTERRUPTS();
   \                     ??halSleep_22:
   \   000122   C29A....     CMP.B   R10, &macPib + 9
   \   000126   0220         JNE     ??halSleep_23
   \   000128   32C2         dint
   \   00012A   0343         nop
    243          
    244                  /* disable sleep timer interrupt */
    245                  HAL_SLEEP_TIMER_DISABLE_INT();
   \                     ??halSleep_23:
   \   00012C   C29A....     CMP.B   R10, &macPib + 9
   \   000130   0320         JNE     ??halSleep_24
   \   000132   B2C010006201 BIC.W   #0x10, &0x162
    246          
    247                  if (timeout != 0)
   \                     ??halSleep_24:
   \   000138   ........     CALLA   #?Subroutine2
   \                     ??CrossCallReturnLabel_7:
   \   00013C   0924         JEQ     ??halSleep_25
    248                  {
    249                    /* Calculate timer elapsed only if timer sleep */
    250                    halAccumulatedSleepTime += halMacTimerElapsed( &timeout );
   \   00013E   0C41         MOV.W   SP, R12
   \   000140   0C53         ADD.W   #0x0, R12
   \   000142   ........     CALLA   #halMacTimerElapsed
   \   000146   825C....     ADD.W   R12, &halAccumulatedSleepTime
   \   00014A   826D....     ADDC.W  R13, &halAccumulatedSleepTime + 2
   \   00014E   023C         JMP     ??halSleep_26
    251                  }
    252                  else
    253                  {
    254                    /* Restart timer */
    255                    HAL_MAC_SLEEP_TIMER_RESTART();
   \                     ??halSleep_25:
   \   000150   ........     CALLA   #?Subroutine1
    256                  }
    257          
    258                  /* Process keyboard "wake-up" interrupt, exit while loop if key interrupt */
    259                  if ( HalKeyExitSleep() || timeout == 0 )
   \                     ??halSleep_26:
   \   000154   ........     CALLA   #HalKeyExitSleep
   \   000158   4C93         CMP.B   #0x0, R12
   \   00015A   0320         JNE     ??halSleep_19
   \   00015C   ........     CALLA   #?Subroutine2
    260                  {
    261                    break;
    262                  }
    263                }
   \                     ??CrossCallReturnLabel_8:
   \   000160   AC23         JNE     ??halSleep_2
    264          
    265                /* Restart the LED */
    266                HalLedExitSleep();
   \                     ??halSleep_19:
   \   000162   ........     CALLA   #HalLedExitSleep
    267          
    268                /* power on the MAC; blocks until completion.
    269                 * the MAC timer will be turned on if off.
    270                 */
    271                MAC_PwrOnReq();
   \   000166   ........     CALLA   #MAC_PwrOnReq
    272          
    273                /* Update MAC timer count for OSAL */
    274                macMcuPrecisionCountSleepUpdate( halAccumulatedSleepTime );
   \   00016A   1C42....     MOV.W   &halAccumulatedSleepTime, R12
   \   00016E   1D42....     MOV.W   &halAccumulatedSleepTime + 2, R13
   \   000172   ........     CALLA   #macMcuPrecisionCountSleepUpdate
    275                
    276                HAL_ENABLE_INTERRUPTS();
   \   000176   32D2         eint
   \   000178   013C         JMP     ??halSleep_4
    277              }
    278              else
    279              {
    280                HAL_ENABLE_INTERRUPTS();
   \                     ??halSleep_16:
   \   00017A   32D2         eint
    281              }
    282            }
    283          }
   \                     ??halSleep_4:
   \   00017C   2152         ADD.W   #0x4, SP
   \   00017E   3A41         POP.W   R10
   \   000180   1001         RETA
   \   000182                REQUIRE TACCTL0
   \   000182                REQUIRE TACTL

   \                                 In  segment CODE, align 2
   \                     ?Subroutine3:
   \   000000   814C0400     MOV.W   R12, 0x4(SP)
   \   000004   814D0600     MOV.W   R13, 0x6(SP)
   \   000008   1001         RETA

   \                                 In  segment CODE, align 2
   \                     ?Subroutine2:
   \   000000   1F410400     MOV.W   0x4(SP), R15
   \   000004   1FD10600     BIS.W   0x6(SP), R15
   \   000008   0F93         CMP.W   #0x0, R15
   \   00000A   1001         RETA

   \                                 In  segment CODE, align 2
   \                     ?Subroutine0:
   \   000000   3E406400     MOV.W   #0x64, R14
   \   000004   0F43         MOV.W   #0x0, R15
   \   000006   ........     CALLA   #?Mul32
   \   00000A   3C501F00     ADD.W   #0x1f, R12
   \   00000E   0D63         ADDC.W  #0x0, R13
   \   000010   ........     BRA     #?ShiftRight32u_5
    284          
    285          /**************************************************************************************************
    286           * @fn          halSleepSetTimer
    287           *
    288           * @brief       This function sets the MSP430 MAC timer compare value.  First it reads and
    289           *              stores the value of the sleep timer; this value is used later to update MAC
    290           *              timers.  Then the timeout value is converted from 320 usec units to system clock
    291           *              period units and the compare value is set to the timeout.
    292           *
    293           * input parameters
    294           *
    295           * @param       timeout - Pointer to the timeout value in 320 usec units.  The sleep timer compare
    296           *                        is set to this value.
    297           *
    298           * output parameters - none
    299           *
    300           * None.
    301           *
    302           * @return      None.
    303           **************************************************************************************************
    304           */

   \                                 In  segment CODE, align 2
    305          void halSleepSetTimer( uint32 timeout )
   \                     halSleepSetTimer:
    306          {
   \   000000   1B15         PUSHM.W #0x2, R11
    307            halIntState_t  s;
    308            uint32         ticks;
    309          
    310            HAL_ENTER_CRITICAL_SECTION(s);
   \   000002   0F42         MOV.W   SR, R15
   \   000004   32C2         dint
   \   000006   0343         nop
    311          
    312          #ifdef __msp430x54x
    313            /* read the current MAC timer and store value for later */
    314            ticks = halSleepTimerStart = HAL_MAC_SLEEP_TIMER_TAR();
    315          #endif
    316          
    317            /* Switch MAC timer clock source and change prescaler
    318             * halt the timer while updating
    319             */
    320            HAL_MAC_SLEEP_TIMER_SLOW_DOWN();
   \   000008   B2F00FFC6001 AND.W   #0xfc0f, &0x160
   \   00000E   B2D0C0016001 BIS.W   #0x1c0, &0x160
    321          
    322            HAL_EXIT_CRITICAL_SECTION(s);
   \   000014   024F         MOV.W   R15, SR
    323          
    324          #ifdef __msp430x54x
    325            /* With MSP430F5438 RTM silicon, when the counter mode is moved from 'up'
    326             * to 'stop' and the timer counter equals the capture/compare value in a
    327             * TACCRx register the transition of modes will pull the TAR bits (15:4)
    328             * to a '1' momentarily. Re-initialize TAR as a temporary workaround until
    329             * the post-RTM revisions of silicon with this bug fixed.
    330             */
    331            HAL_MAC_SLEEP_TIMER_TAR() = halSleepTimerStart;
    332          #else
    333            /* read the current MAC timer and store value for later */
    334            ticks = halSleepTimerStart = HAL_MAC_SLEEP_TIMER_TAR();
   \   000016   1A427001     MOV.W   &0x170, R10
   \   00001A   824A....     MOV.W   R10, &halSleepTimerStart
    335          #endif
    336          
    337            /* read the current MAC timer compare count and store value for later */
    338            halSleepTimerCompareStart = HAL_MAC_SLEEP_TIMER_COMPARE();
   \   00001E   92427201.... MOV.W   &0x172, &halSleepTimerCompareStart
    339          
    340            /* The MAC tick is 32KHz/8 = 4096Hz. The ratio of 4096Hz ticks
    341             * to 320 usec ticks is (320e-6)/(1/4096) = 1.31072 = 4096 / 3125.
    342             */
    343            ticks += (timeout * 4096 / 3125);
   \   000024   0B43         MOV.W   #0x0, R11
   \   000026   ........     CALLA   #?ShiftLeft32_12
   \   00002A   3E40350C     MOV.W   #0xc35, R14
   \   00002E   0F43         MOV.W   #0x0, R15
   \   000030   ........     CALLA   #?DivMod32u
   \   000034   0A5C         ADD.W   R12, R10
   \   000036   0B6D         ADDC.W  R13, R11
    344          
    345            /* sleep away one chunk at a time */
    346            if ( ticks > MAX_SLEEP_COUNT )
   \   000038   1B93         CMP.W   #0x1, R11
   \   00003A   0128         JNC     ??halSleepSetTimer_0
    347            {
    348              /* adjust timeout for the next sleep cycle */
    349              ticks = MAX_SLEEP_COUNT;
   \   00003C   3A43         MOV.W   #0xffff, R10
    350            }
    351          
    352            /* set MAC timer compare */
    353            HAL_MAC_SLEEP_TIMER_SET_COMPARE(((uint16)ticks));
   \                     ??halSleepSetTimer_0:
   \   00003E   824A7201     MOV.W   R10, &0x172
    354          
    355            /* restart the timer */
    356            HAL_MAC_SLEEP_TIMER_RESTART();
   \   000042   ........     CALLA   #?Subroutine1
    357          }
   \                     ??CrossCallReturnLabel_3:
   \   000046   1A17         POPM.W  #0x2, R11
   \   000048   1001         RETA
   \   00004A                REQUIRE TACTL
   \   00004A                REQUIRE TAR
   \   00004A                REQUIRE TACCR0
    358          
    359          /**************************************************************************************************
    360           * @fn          TimerElapsed
    361           *
    362           * @brief       Determine the number of MAC timer ticks elapsed during sleep.
    363           *              Deprecated for MSP430.
    364           *
    365           * input parameters
    366           *
    367           * @param       None.
    368           *
    369           * output parameters
    370           *
    371           * None.
    372           *
    373           * @return      Number of msec elapsed during sleep.
    374           **************************************************************************************************
    375           */

   \                                 In  segment CODE, align 2
    376          uint32 TimerElapsed( void )
   \                     TimerElapsed:
    377          {
    378            /* Stubs */
    379            return (0);
   \   000000   0C43         MOV.W   #0x0, R12
   \   000002   0D43         MOV.W   #0x0, R13
   \   000004   1001         RETA
    380          }
    381          
    382          /**************************************************************************************************
    383           * @fn          halMacTimerElapsed
    384           *
    385           * @brief       Determine the number of MAC timer ticks elapsed during sleep.
    386           *
    387           * input parameters
    388           *
    389           * @param       timeout - pointer to the 320us timeout.
    390           *
    391           * output parameters
    392           *
    393           * None.
    394           *
    395           * @return      Number of timer ticks elapsed during sleep.
    396           **************************************************************************************************
    397           */

   \                                 In  segment CODE, align 2
    398          uint32 halMacTimerElapsed( uint32 *timeout )
   \                     halMacTimerElapsed:
    399          {
   \   000000   2A15         PUSHM.W #0x3, R10
   \   000002   2182         SUB.W   #0x4, SP
   \   000004   0A4C         MOV.W   R12, R10
    400            volatile uint16 tar;
    401            volatile uint16 taccr;
    402            uint32          ticks;
    403            uint32          timeout_u320; /* 320 us timeout */
    404            halIntState_t   s;
    405          
    406            /* read the currrent count + compare count (MAC timer must be in CTC mode) */
    407            HAL_ENTER_CRITICAL_SECTION(s);
   \   000006   0F42         MOV.W   SR, R15
   \   000008   32C2         dint
   \   00000A   0343         nop
    408          
    409          #ifdef __msp430x54x
    410            tar = HAL_MAC_SLEEP_TIMER_TAR();
    411          #endif
    412          
    413            /* Halt timer before read anything */
    414            HAL_MAC_SLEEP_TIMER_SPEED_UP();
   \   00000C   B2F00FFC6001 AND.W   #0xfc0f, &0x160
   \   000012   B2D000026001 BIS.W   #0x200, &0x160
    415          
    416            HAL_EXIT_CRITICAL_SECTION(s);
   \   000018   024F         MOV.W   R15, SR
    417          
    418          #ifdef __msp430x54x
    419            /* With MSP430F5438 RTM silicon, when the counter mode is moved from 'up'
    420             * to 'stop' and the timer counter equals the capture/compare value in a
    421             * TACCRx register the transition of modes will pull the TAR bits (15:4)
    422             * to a '1' momentarily. Re-initialize TAR as a temporary workaround until
    423             * the post-RTM revisions of silicon with this bug fixed.
    424             */
    425            HAL_MAC_SLEEP_TIMER_TAR() = tar;
    426          #else
    427            /* Read timer registers */
    428            tar = HAL_MAC_SLEEP_TIMER_TAR();
   \   00001A   914270010200 MOV.W   &0x170, 0x2(SP)
    429          #endif
    430          
    431            taccr = HAL_MAC_SLEEP_TIMER_COMPARE();
   \   000020   914272010000 MOV.W   &0x172, 0(SP)
    432          
    433            /* store current timer count */
    434            ticks = tar;
   \   000026   1C410200     MOV.W   0x2(SP), R12
   \   00002A   0D43         MOV.W   #0x0, R13
    435          
    436            /* calculate elapsed time or somthing else woke up the MCU */
    437            if ( taccr <= halSleepTimerStart )
   \   00002C   1842....     MOV.W   &halSleepTimerStart, R8
   \   000030   2891         CMP.W   @SP, R8
   \   000032   0328         JNC     ??halMacTimerElapsed_0
    438            {
    439              ticks += taccr;
   \   000034   2E41         MOV.W   @SP, R14
   \   000036   0C5E         ADD.W   R14, R12
   \   000038   0D63         ADDC.W  #0x0, R13
    440            }
    441            ticks -= halSleepTimerStart;
    442          
    443            /* adjust timeout for the next sleep cycle */
    444            timeout_u320 = ticks * 3125 / 4096;
   \                     ??halMacTimerElapsed_0:
   \   00003A   0F43         MOV.W   #0x0, R15
   \   00003C   0C88         SUB.W   R8, R12
   \   00003E   0D73         SUBC.W  #0x0, R13
   \   000040   3E40350C     MOV.W   #0xc35, R14
   \   000044   ........     CALLA   #?Mul32
   \   000048   ........     CALLA   #?ShiftRight32u_12
    445            if ( *timeout >= timeout_u320 )
   \   00004C   8A9D0200     CMP.W   R13, 0x2(R10)
   \   000050   0828         JNC     ??halMacTimerElapsed_1
   \   000052   0320         JNE     ??halMacTimerElapsed_2
   \   000054   8A9C0000     CMP.W   R12, 0(R10)
   \   000058   0428         JNC     ??halMacTimerElapsed_1
    446            {
    447              *timeout -= timeout_u320;
   \                     ??halMacTimerElapsed_2:
   \   00005A   8A8C0000     SUB.W   R12, 0(R10)
   \   00005E   8A7D0200     SUBC.W  R13, 0x2(R10)
    448            }
    449          
    450            /* Restore current MAC count */
    451            HAL_MAC_SLEEP_TIMER_SET_COMPARE(halSleepTimerCompareStart);
   \                     ??halMacTimerElapsed_1:
   \   000062   9242....7201 MOV.W   &halSleepTimerCompareStart, &0x172
    452            HAL_MAC_SLEEP_TIMER_TAR() = halSleepTimerStart;
   \   000068   82487001     MOV.W   R8, &0x170
    453          
    454            /* Restart timer */
    455            HAL_MAC_SLEEP_TIMER_RESTART();
   \   00006C   ........     CALLA   #?Subroutine1
    456          
    457            /* Return elapsed time in units of 320us */
    458            return ( timeout_u320 );
   \                     ??CrossCallReturnLabel_2:
   \   000070   2152         ADD.W   #0x4, SP
   \   000072   2817         POPM.W  #0x3, R10
   \   000074   1001         RETA
   \   000076                REQUIRE TACTL
   \   000076                REQUIRE TAR
   \   000076                REQUIRE TACCR0
    459          }
    460          
    461          /**************************************************************************************************
    462           * @fn          halRestoreSleepLevel
    463           *
    464           * @brief       Restore the deepest timer sleep level (used in CC2430). This is a stub here.
    465           *
    466           * input parameters
    467           *
    468           * @param       None
    469           *
    470           * output parameters
    471           *
    472           *              None.
    473           *
    474           * @return      None.
    475           **************************************************************************************************
    476           */

   \                                 In  segment CODE, align 2
    477          void halRestoreSleepLevel( void )
   \                     halRestoreSleepLevel:
    478          {
    479            /* Stub */
    480          }
   \   000000   1001         RETA

   Maximum stack usage in bytes:

   CSTACK Function
   ------ --------
      4   TimerElapsed
     14   halMacTimerElapsed
      4   halRestoreSleepLevel
     10   halSleep
       10   -> HalKeyEnterSleep
       10   -> HalKeyExitSleep
       10   -> HalLedEnterSleep
       10   -> HalLedExitSleep
       10   -> MAC_PwrNextTimeout
       10   -> MAC_PwrOffReq
       10   -> MAC_PwrOnReq
       10   -> halAssertHandler
       10   -> halMacTimerElapsed
       10   -> halSleepSetTimer
       10   -> macMcuPrecisionCountSleepUpdate
      8   halSleepSetTimer


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
      20  ?Subroutine0
      14  ?Subroutine1
      12  ?Subroutine2
      10  ?Subroutine3
       2  TACCR0
       2  TACCTL0
       2  TACTL
       2  TAR
       6  TimerElapsed
       4  halAccumulatedSleepTime
     118  halMacTimerElapsed
       1  halPwrMgtMode
       2  halRestoreSleepLevel
     386  halSleep
      74  halSleepSetTimer
       2  halSleepTimerCompareStart
       2  halSleepTimerStart

 
 642 bytes in segment CODE
   8 bytes in segment DATA16_AN
   9 bytes in segment DATA16_Z
 
 642 bytes of CODE memory
   9 bytes of DATA memory (+ 8 bytes shared)

Errors: none
Warnings: none
