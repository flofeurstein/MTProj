///////////////////////////////////////////////////////////////////////////////
//                                                                            /
// IAR C/C++ Compiler V5.52.1.50724/W32 for MSP430      10/Jun/2013  16:27:29 /
// Copyright 1996-2013 IAR Systems AB.                                        /
//                                                                            /
//    __rt_version  =  3                                                      /
//    __double_size =  32                                                     /
//    __reg_r4      =  free                                                   /
//    __reg_r5      =  free                                                   /
//    __pic         =  no                                                     /
//    __core        =  430X                                                   /
//    __data_model  =  small                                                  /
//    Source file   =  C:\Texas Instruments\ZStack-MSP2618-2.5.1\Components\s /
//                     tack\zdo\ZDSecMgr.c                                    /
//    Command line  =  -f "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects /
//                     \zstack\HomeAutomation\SampleLight\CC2520DB\..\..\..\T /
//                     ools\MSP2618\f8wConfig.cfg" (-DZIGBEEPRO -DSECURE=0    /
//                     -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                      /
//                     -DDEFAULT_CHANLIST=0x00000800                          /
//                     -DZDAPP_CONFIG_PAN_ID=0xFFFF -DNWK_START_DELAY=100     /
//                     -DEXTENDED_JOINING_RANDOM_MASK=0x007F                  /
//                     -DBEACON_REQUEST_DELAY=100                             /
//                     -DBEACON_REQ_DELAY_MASK=0x00FF                         /
//                     -DLINK_STATUS_JITTER_MASK=0x007F                       /
//                     -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_POLLED /
//                     =3000 -DNWK_INDIRECT_MSG_TIMEOUT=7                     /
//                     -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3        /
//                     -DNWK_MAX_DATA_RETRIES=2 -DMAX_POLL_FAILURE_RETRIES=2  /
//                     -DMAX_BCAST=9 -DAPS_MAX_GROUPS=16                      /
//                     -DMAX_RTG_ENTRIES=40 -DNWK_MAX_BINDING_ENTRIES=4       /
//                     -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,      /
//                     0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00, 0x02,  /
//                     0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"                   /
//                     -DMAC_MAX_FRAME_SIZE=116 -DZDNWKMGR_MIN_TRANSMISSIONS= /
//                     20 -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000         /
//                     -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100        /
//                     -DREJOIN_POLL_RATE=440) -f "C:\Texas                   /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\Tools\MSP2618\ /
//                     f8wRouter.cfg" (-DCPU6MHZ -DMAC_CFG_APP_PENDING_QUEUE= /
//                     TRUE -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8        /
//                     -DMAC_CFG_RX_MAX=5 -DRTR_NWK) -f "C:\Texas             /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\Tools\MSP2618\ /
//                     f8wZCL.cfg" (-DZCL_READ -DZCL_WRITE -DZCL_BASIC        /
//                     -DZCL_IDENTIFY -DZCL_ON_OFF -DZCL_KEY_ESTABLISH        /
//                     -DZCL_KEY_ESTABLISHMENT_KEY_GENERATE_TIMEOUT=4         /
//                     -DZCL_KEY_ESTABLISHMENT_MAC_GENERATE_TIMEOUT=10        /
//                     -DZCL_KEY_ESTABLISHMENT_EKEY_GENERATE_TIMEOUT=10       /
//                     -DZCL_LOAD_CONTROL -DZCL_SIMPLE_METERING               /
//                     -DZCL_PRICING -DZCL_MESSAGE -DZCL_TUNNELING            /
//                     -DZCL_TOU) -DZCL_DEVICE_MGMT "C:\Texas                 /
//                     Instruments\ZStack-MSP2618-2.5.1\Components\stack\zdo\ /
//                     ZDSecMgr.c" -D MSP430F2618 -D ZTOOL_P1 -D MT_TASK -D   /
//                     MT_SYS_FUNC -D MT_ZDO_FUNC -D LCD_SUPPORTED -lC        /
//                     "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\zs /
//                     tack\HomeAutomation\SampleLight\CC2520DB\Router\List\" /
//                      -lA "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projec /
//                     ts\zstack\HomeAutomation\SampleLight\CC2520DB\Router\L /
//                     ist\" --remarks --diag_suppress                        /
//                     Pe001,Pe193,Pe236,Pe826 -o "C:\Texas                   /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\Router\Obj\" --debug    /
//                     -D__MSP430F2618__ -e --double=32 --clib -I "C:\Texas   /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\" -I "C:\Texas          /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\Source\" -I          /
//                     "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\zs /
//                     tack\HomeAutomation\SampleLight\CC2520DB\..\..\Source\ /
//                     " -I "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projec /
//                     ts\zstack\HomeAutomation\SampleLight\CC2520DB\..\..\.. /
//                     \ZMain\MSP2618\" -I "C:\Texas                          /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\hal\include\" -I "C:\Texas                          /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\hal\target\MSP2618CC2520\" -I "C:\Texas             /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\mac\include\" -I "C:\Texas                          /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\mac\high_level\" -I "C:\Texas                       /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\mac\low_level\srf04\" -I "C:\Texas                  /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\mac\low_level\srf04\dual_chip\" -I "C:\Texas        /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\mt\" -I "C:\Texas Instruments\ZStack-MSP2618-2.5.1\ /
//                     Projects\zstack\HomeAutomation\SampleLight\CC2520DB\.. /
//                     \..\..\..\..\Components\osal\include\" -I "C:\Texas    /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\osal\mcu\msp430\" -I "C:\Texas                      /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\services\saddr\" -I "C:\Texas                       /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\services\sdata\" -I "C:\Texas                       /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\stack\af\" -I "C:\Texas                             /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\stack\nwk\" -I "C:\Texas                            /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\stack\sec\" -I "C:\Texas                            /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\stack\sapi\" -I "C:\Texas                           /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\stack\sys\" -I "C:\Texas                            /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\stack\zcl\" -I "C:\Texas                            /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\stack\zdo\" -I "C:\Texas                            /
//                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeA /
//                     utomation\SampleLight\CC2520DB\..\..\..\..\..\Componen /
//                     ts\zmac\" -I "C:\Texas Instruments\ZStack-MSP2618-2.5. /
//                     1\Projects\zstack\HomeAutomation\SampleLight\CC2520DB\ /
//                     ..\..\..\..\..\Components\zmac\f8w\" --core=430X       /
//                     --data_model=small -Ohz --multiplier=16s               /
//                     --require_prototypes                                   /
//    List file     =  C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\zst /
//                     ack\HomeAutomation\SampleLight\CC2520DB\Router\List\ZD /
//                     SecMgr.s43                                             /
//                                                                            /
//                                                                            /
///////////////////////////////////////////////////////////////////////////////

        NAME ZDSecMgr

        RTMODEL "__SystemLibrary", "CLib"
        RTMODEL "__core", "430X"
        RTMODEL "__data_model", "small"
        RTMODEL "__double_size", "32"
        RTMODEL "__pic", "no"
        RTMODEL "__reg_r4", "free"
        RTMODEL "__reg_r5", "free"
        RTMODEL "__rt_version", "3"

        RSEG CSTACK:DATA:SORT:NOROOT(0)

        EXTERN ?cstart_init_copy
        EXTERN ?cstart_init_zero
        EXTERN ?longjmp_r4
        EXTERN ?longjmp_r5
        EXTERN ?setjmp_r4
        EXTERN ?setjmp_r5

        PUBWEAK ?setjmp_save_r4
        PUBWEAK ?setjmp_save_r5
        PUBLIC APSME_IsDefaultTCLK
        FUNCTION APSME_IsDefaultTCLK,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC APSME_IsLinkKeyValid
        FUNCTION APSME_IsLinkKeyValid,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 26, STACK
        PUBLIC APSME_KeyFwdToChild
        FUNCTION APSME_KeyFwdToChild,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC APSME_LinkKeyNVIdGet
        FUNCTION APSME_LinkKeyNVIdGet,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 8, STACK
        PUBLIC APSME_LinkKeySet
        FUNCTION APSME_LinkKeySet,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 16, STACK
        PUBLIC APSME_MasterKeyGet
        FUNCTION APSME_MasterKeyGet,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 10, STACK
        PUBLIC APSME_SKA_TimerExpired
        FUNCTION APSME_SKA_TimerExpired,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC APSME_TCLinkKeyInit
        FUNCTION APSME_TCLinkKeyInit,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 38, STACK
        PUBLIC APSME_TCLinkKeyLoad
        FUNCTION APSME_TCLinkKeyLoad,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 58, STACK
        PUBLIC APSME_TCLinkKeySync
        FUNCTION APSME_TCLinkKeySync,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 44, STACK
        PUBLIC ApsLinkKeyFrmCntr
        PUBLIC TCLinkKeyFrmCntr
        PUBLIC TrustCenterLinkKey
        PUBLIC ZDSecMgrAPSRemove
        FUNCTION ZDSecMgrAPSRemove,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 14, STACK
        PUBLIC ZDSecMgrAddLinkKey
        FUNCTION ZDSecMgrAddLinkKey,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 12, STACK
        PUBLIC ZDSecMgrAddrClear
        FUNCTION ZDSecMgrAddrClear,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 22, STACK
        PUBLIC ZDSecMgrAddrMgrUpdate
        FUNCTION ZDSecMgrAddrMgrUpdate,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 20, STACK
        PUBLIC ZDSecMgrAddrStore
        FUNCTION ZDSecMgrAddrStore,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 20, STACK
        PUBLIC ZDSecMgrAppKeyGet
        FUNCTION ZDSecMgrAppKeyGet,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 6, STACK
        PUBLIC ZDSecMgrAppKeyReq
        FUNCTION ZDSecMgrAppKeyReq,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 56, STACK
        PUBLIC ZDSecMgrAppKeyType
        PUBLIC ZDSecMgrApsLinkKeyInit
        FUNCTION ZDSecMgrApsLinkKeyInit,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 36, STACK
        PUBLIC ZDSecMgrAssocDeviceAuth
        FUNCTION ZDSecMgrAssocDeviceAuth,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrAuthInitiate
        FUNCTION ZDSecMgrAuthInitiate,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 14, STACK
        PUBLIC ZDSecMgrAuthNwkKey
        FUNCTION ZDSecMgrAuthNwkKey,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrAuthenticateCfm
        FUNCTION ZDSecMgrAuthenticateCfm,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrAuthenticateInd
        FUNCTION ZDSecMgrAuthenticateInd,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 28, STACK
        PUBLIC ZDSecMgrAuthenticationCheck
        FUNCTION ZDSecMgrAuthenticationCheck,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrAuthenticationSet
        FUNCTION ZDSecMgrAuthenticationSet,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 8, STACK
        PUBLIC ZDSecMgrConfig
        FUNCTION ZDSecMgrConfig,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrCtrlAdd
        FUNCTION ZDSecMgrCtrlAdd,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 8, STACK
        PUBLIC ZDSecMgrCtrlData
        PUBLIC ZDSecMgrCtrlInit
        FUNCTION ZDSecMgrCtrlInit,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrCtrlLookup
        FUNCTION ZDSecMgrCtrlLookup,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 8, STACK
        PUBLIC ZDSecMgrCtrlRelease
        FUNCTION ZDSecMgrCtrlRelease,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrCtrlReset
        FUNCTION ZDSecMgrCtrlReset,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 10, STACK
        PUBLIC ZDSecMgrCtrlSet
        FUNCTION ZDSecMgrCtrlSet,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrCtrlTerm
        FUNCTION ZDSecMgrCtrlTerm,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 6, STACK
        PUBLIC ZDSecMgrDeviceCtrlHandler
        FUNCTION ZDSecMgrDeviceCtrlHandler,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 8, STACK
        PUBLIC ZDSecMgrDeviceCtrlSetup
        FUNCTION ZDSecMgrDeviceCtrlSetup,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrDeviceCtrlUpdate
        FUNCTION ZDSecMgrDeviceCtrlUpdate,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 10, STACK
        PUBLIC ZDSecMgrDeviceEntryAdd
        FUNCTION ZDSecMgrDeviceEntryAdd,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 14, STACK
        PUBLIC ZDSecMgrDeviceEntryRemove
        FUNCTION ZDSecMgrDeviceEntryRemove,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrDeviceJoin
        FUNCTION ZDSecMgrDeviceJoin,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 10, STACK
        PUBLIC ZDSecMgrDeviceJoinDirect
        FUNCTION ZDSecMgrDeviceJoinDirect,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 8, STACK
        PUBLIC ZDSecMgrDeviceJoinFwd
        FUNCTION ZDSecMgrDeviceJoinFwd,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 12, STACK
        PUBLIC ZDSecMgrDeviceNew
        FUNCTION ZDSecMgrDeviceNew,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrDeviceRemove
        FUNCTION ZDSecMgrDeviceRemove,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 16, STACK
        PUBLIC ZDSecMgrDeviceRemoveByExtAddr
        FUNCTION ZDSecMgrDeviceRemoveByExtAddr,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 8, STACK
        PUBLIC ZDSecMgrDeviceValidate
        FUNCTION ZDSecMgrDeviceValidate,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrDeviceValidateCM
        FUNCTION ZDSecMgrDeviceValidateCM,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 30, STACK
        PUBLIC ZDSecMgrDeviceValidateRM
        FUNCTION ZDSecMgrDeviceValidateRM,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrDeviceValidateSKKE
        FUNCTION ZDSecMgrDeviceValidateSKKE,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 10, STACK
        PUBLIC ZDSecMgrEntries
        PUBLIC ZDSecMgrEntryFree
        FUNCTION ZDSecMgrEntryFree,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 8, STACK
        PUBLIC ZDSecMgrEntryInit
        FUNCTION ZDSecMgrEntryInit,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrEntryLookup
        FUNCTION ZDSecMgrEntryLookup,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 20, STACK
        PUBLIC ZDSecMgrEntryLookupAMI
        FUNCTION ZDSecMgrEntryLookupAMI,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 8, STACK
        PUBLIC ZDSecMgrEntryLookupAMIGetIndex
        FUNCTION ZDSecMgrEntryLookupAMIGetIndex,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 8, STACK
        PUBLIC ZDSecMgrEntryLookupExt
        FUNCTION ZDSecMgrEntryLookupExt,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 10, STACK
        PUBLIC ZDSecMgrEntryLookupExtGetIndex
        FUNCTION ZDSecMgrEntryLookupExtGetIndex,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 10, STACK
        PUBLIC ZDSecMgrEntryNew
        FUNCTION ZDSecMgrEntryNew,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 6, STACK
        PUBLIC ZDSecMgrEstablishKey
        FUNCTION ZDSecMgrEstablishKey,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 14, STACK
        PUBLIC ZDSecMgrEstablishKeyCfm
        FUNCTION ZDSecMgrEstablishKeyCfm,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrEstablishKeyInd
        FUNCTION ZDSecMgrEstablishKeyInd,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 24, STACK
        PUBLIC ZDSecMgrEvent
        FUNCTION ZDSecMgrEvent,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 36, STACK
        PUBLIC ZDSecMgrExtAddrLookup
        FUNCTION ZDSecMgrExtAddrLookup,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 20, STACK
        PUBLIC ZDSecMgrExtAddrStore
        FUNCTION ZDSecMgrExtAddrStore,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 20, STACK
        PUBLIC ZDSecMgrInit
        FUNCTION ZDSecMgrInit,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrInitNVKeyTables
        FUNCTION ZDSecMgrInitNVKeyTables,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 6, STACK
        PUBLIC ZDSecMgrMasterKeyInit
        FUNCTION ZDSecMgrMasterKeyInit,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 30, STACK
        PUBLIC ZDSecMgrMasterKeyLoad
        FUNCTION ZDSecMgrMasterKeyLoad,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 12, STACK
        PUBLIC ZDSecMgrMasterKeyLookup
        FUNCTION ZDSecMgrMasterKeyLookup,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 34, STACK
        PUBLIC ZDSecMgrMasterKeyStore
        FUNCTION ZDSecMgrMasterKeyStore,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 34, STACK
        PUBLIC ZDSecMgrNewDeviceEvent
        FUNCTION ZDSecMgrNewDeviceEvent,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 36, STACK
        PUBLIC ZDSecMgrNwkKeyInit
        FUNCTION ZDSecMgrNwkKeyInit,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 48, STACK
        PUBLIC ZDSecMgrPermitJoining
        FUNCTION ZDSecMgrPermitJoining,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrPermitJoiningEnabled
        PUBLIC ZDSecMgrPermitJoiningTimed
        PUBLIC ZDSecMgrPermitJoiningTimeout
        FUNCTION ZDSecMgrPermitJoiningTimeout,0203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrReadKeyFromNv
        FUNCTION ZDSecMgrReadKeyFromNv,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrRemoveDeviceInd
        FUNCTION ZDSecMgrRemoveDeviceInd,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 16, STACK
        PUBLIC ZDSecMgrRequestAppKey
        FUNCTION ZDSecMgrRequestAppKey,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 8, STACK
        PUBLIC ZDSecMgrRequestKeyInd
        FUNCTION ZDSecMgrRequestKeyInd,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrSaveApsLinkKey
        FUNCTION ZDSecMgrSaveApsLinkKey,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 12, STACK
        PUBLIC ZDSecMgrSaveTCLinkKey
        FUNCTION ZDSecMgrSaveTCLinkKey,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 6, STACK
        PUBLIC ZDSecMgrSendMasterKey
        FUNCTION ZDSecMgrSendMasterKey,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 40, STACK
        PUBLIC ZDSecMgrSendNwkKey
        FUNCTION ZDSecMgrSendNwkKey,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 40, STACK
        PUBLIC ZDSecMgrSetDefaultNV
        FUNCTION ZDSecMgrSetDefaultNV,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 16, STACK
        PUBLIC ZDSecMgrSetupPartner
        FUNCTION ZDSecMgrSetupPartner,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 26, STACK
        PUBLIC ZDSecMgrSwitchKeyInd
        FUNCTION ZDSecMgrSwitchKeyInd,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 4, STACK
        PUBLIC ZDSecMgrTCAuthenticated
        PUBLIC ZDSecMgrTCDataLoad
        FUNCTION ZDSecMgrTCDataLoad,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 40, STACK
        PUBLIC ZDSecMgrTCExtAddr
        PUBLIC ZDSecMgrTCExtAddrCheck
        FUNCTION ZDSecMgrTCExtAddrCheck,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 16, STACK
        PUBLIC ZDSecMgrTCMasterKey
        PUBLIC ZDSecMgrTransportKeyInd
        FUNCTION ZDSecMgrTransportKeyInd,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 22, STACK
        PUBLIC ZDSecMgrUpdateDeviceInd
        FUNCTION ZDSecMgrUpdateDeviceInd,021203H
        ARGFRAME CSTACK, 0, STACK
        LOCFRAME CSTACK, 14, STACK
        
          CFI Names cfiNames0
          CFI StackFrame CFA SP DATA
          CFI Resource PC:20, SP:20, SR:16, R4L:16, R4H:4, R4:20, R5L:16, R5H:4
          CFI Resource R5:20, R6L:16, R6H:4, R6:20, R7L:16, R7H:4, R7:20, R8L:16
          CFI Resource R8H:4, R8:20, R9L:16, R9H:4, R9:20, R10L:16, R10H:4
          CFI Resource R10:20, R11L:16, R11H:4, R11:20, R12L:16, R12H:4, R12:20
          CFI Resource R13L:16, R13H:4, R13:20, R14L:16, R14H:4, R14:20, R15L:16
          CFI Resource R15H:4, R15:20
          CFI ResourceParts R4 R4H, R4L
          CFI ResourceParts R5 R5H, R5L
          CFI ResourceParts R6 R6H, R6L
          CFI ResourceParts R7 R7H, R7L
          CFI ResourceParts R8 R8H, R8L
          CFI ResourceParts R9 R9H, R9L
          CFI ResourceParts R10 R10H, R10L
          CFI ResourceParts R11 R11H, R11L
          CFI ResourceParts R12 R12H, R12L
          CFI ResourceParts R13 R13H, R13L
          CFI ResourceParts R14 R14H, R14L
          CFI ResourceParts R15 R15H, R15L
          CFI EndNames cfiNames0
        
          CFI Common cfiCommon0 Using cfiNames0
          CFI CodeAlign 2
          CFI DataAlign 2
          CFI ReturnAddress PC CODE
          CFI CFA SP+4
          CFI PC Frame(CFA, -4)
          CFI SR Undefined
          CFI R4L SameValue
          CFI R4H 0
          CFI R4 Concat
          CFI R5L SameValue
          CFI R5H 0
          CFI R5 Concat
          CFI R6L SameValue
          CFI R6H 0
          CFI R6 Concat
          CFI R7L SameValue
          CFI R7H 0
          CFI R7 Concat
          CFI R8L SameValue
          CFI R8H 0
          CFI R8 Concat
          CFI R9L SameValue
          CFI R9H 0
          CFI R9 Concat
          CFI R10L SameValue
          CFI R10H 0
          CFI R10 Concat
          CFI R11L SameValue
          CFI R11H 0
          CFI R11 Concat
          CFI R12L Undefined
          CFI R12H Undefined
          CFI R12 Undefined
          CFI R13L Undefined
          CFI R13H Undefined
          CFI R13 Undefined
          CFI R14L Undefined
          CFI R14H Undefined
          CFI R14 Undefined
          CFI R15L Undefined
          CFI R15H Undefined
          CFI R15 Undefined
          CFI EndCommon cfiCommon0
        
        
          CFI Common cfiCommon1 Using cfiNames0
          CFI CodeAlign 2
          CFI DataAlign 2
          CFI ReturnAddress PC CODE
          CFI CFA SP+4
          CFI PC Frame(CFA, -4)
          CFI SR Undefined
          CFI R4L SameValue
          CFI R4H 0
          CFI R4 Concat
          CFI R5L SameValue
          CFI R5H 0
          CFI R5 Concat
          CFI R6L SameValue
          CFI R6H 0
          CFI R6 Concat
          CFI R7L SameValue
          CFI R7H 0
          CFI R7 Concat
          CFI R8L SameValue
          CFI R8H 0
          CFI R8 Concat
          CFI R9L SameValue
          CFI R9H 0
          CFI R9 Concat
          CFI R10L SameValue
          CFI R10H 0
          CFI R10 Concat
          CFI R11L SameValue
          CFI R11H 0
          CFI R11 Concat
          CFI R12L SameValue
          CFI R12H 0
          CFI R12 Concat
          CFI R13L SameValue
          CFI R13H 0
          CFI R13 Concat
          CFI R14L SameValue
          CFI R14H 0
          CFI R14 Concat
          CFI R15L SameValue
          CFI R15H 0
          CFI R15 Concat
          CFI EndCommon cfiCommon1
        
        EXTERN osal_mem_alloc
        FUNCTION osal_mem_alloc,0202H
        EXTERN osal_nv_read
        FUNCTION osal_nv_read,0202H
        EXTERN osal_nv_write
        FUNCTION osal_nv_write,0202H
        EXTERN osal_memset
        FUNCTION osal_memset,0202H
        EXTERN osal_mem_free
        FUNCTION osal_mem_free,0202H
        EXTERN osal_nv_item_init
        FUNCTION osal_nv_item_init,0202H
        EXTERN APSME_LookupExtAddr
        FUNCTION APSME_LookupExtAddr,0202H
        EXTERN AddrMgrExtAddrValid
        FUNCTION AddrMgrExtAddrValid,0202H
        EXTERN AddrMgrExtAddrEqual
        FUNCTION AddrMgrExtAddrEqual,0202H
        EXTERN AddrMgrEntryLookupNwk
        FUNCTION AddrMgrEntryLookupNwk,0202H
        EXTERN AddrMgrEntryRelease
        FUNCTION AddrMgrEntryRelease,0202H
        EXTERN zgUseDefaultTCLK
        EXTERN defaultTCLinkKey
        EXTERN osal_memcpy
        FUNCTION osal_memcpy,0202H
        EXTERN AssocGetWithExt
        FUNCTION AssocGetWithExt,0202H
        EXTERN osal_memcmp
        FUNCTION osal_memcmp,0202H
        EXTERN AddrMgrExtAddrSet
        FUNCTION AddrMgrExtAddrSet,0202H
        EXTERN AddrMgrEntryUpdate
        FUNCTION AddrMgrEntryUpdate,0202H
        EXTERN ZDP_NwkAddrReq
        FUNCTION ZDP_NwkAddrReq,0202H
        EXTERN ZDP_IEEEAddrReq
        FUNCTION ZDP_IEEEAddrReq,0202H
        EXTERN APSME_RequestKeyReq
        FUNCTION APSME_RequestKeyReq,0202H
        EXTERN devState
        EXTERN ZDAppTaskID
        EXTERN osal_set_event
        FUNCTION osal_set_event,0202H
        EXTERN APSME_AuthenticateReq
        FUNCTION APSME_AuthenticateReq,0202H
        EXTERN SSP_SwitchNwkKey
        FUNCTION SSP_SwitchNwkKey,0202H
        EXTERN ZDApp_NVUpdate
        FUNCTION ZDApp_NVUpdate,0202H
        EXTERN APSME_LookupNwkAddr
        FUNCTION APSME_LookupNwkAddr,0202H
        EXTERN NLME_GetShortAddr
        FUNCTION NLME_GetShortAddr,0202H
        EXTERN _NIB
        EXTERN SSP_UpdateNwkKey
        FUNCTION SSP_UpdateNwkKey,0202H
        EXTERN APSME_EstablishKeyRsp
        FUNCTION APSME_EstablishKeyRsp,0202H
        EXTERN zgTrustCenterAddr
        EXTERN zgPreConfigKeys
        EXTERN AddrMgrExtAddrLookup
        FUNCTION AddrMgrExtAddrLookup,0202H
        EXTERN AddrMgrEntryGet
        FUNCTION AddrMgrEntryGet,0202H
        EXTERN osal_start_timerEx
        FUNCTION osal_start_timerEx,0202H
        EXTERN AssocMatchDeviceStatus
        FUNCTION AssocMatchDeviceStatus,0202H
        EXTERN AssocRemove
        FUNCTION AssocRemove,0202H
        EXTERN APSME_SecurityNM
        FUNCTION APSME_SecurityNM,0202H
        EXTERN APSME_UpdateDeviceReq
        FUNCTION APSME_UpdateDeviceReq,0202H
        EXTERN AssocGetWithShort
        FUNCTION AssocGetWithShort,0202H
        EXTERN zgSecurePermitJoin
        EXTERN NLME_LeaveReq
        FUNCTION NLME_LeaveReq,0202H
        EXTERN APSME_RemoveDeviceReq
        FUNCTION APSME_RemoveDeviceReq,0202H
        EXTERN NLME_ReadNwkKeyInfo
        FUNCTION NLME_ReadNwkKeyInfo,0202H
        EXTERN APSME_TransportKeyReq
        FUNCTION APSME_TransportKeyReq,0202H
        EXTERN APSME_EstablishKeyReq
        FUNCTION APSME_EstablishKeyReq,0202H
        EXTERN SSP_GetTrueRand
        FUNCTION SSP_GetTrueRand,0202H
        EXTERN AddrMgrEntryLookupExt
        FUNCTION AddrMgrEntryLookupExt,0202H

// C:\Texas Instruments\ZStack-MSP2618-2.5.1\Components\stack\zdo\ZDSecMgr.c
//    1 /******************************************************************************
//    2   Filename:       ZDSecMgr.c
//    3   Revised:        $Date: 2012-02-16 13:22:48 -0800 (Thu, 16 Feb 2012) $
//    4   Revision:       $Revision: 29339 $
//    5 
//    6   Description:    The ZigBee Device Security Manager.
//    7 
//    8 
//    9   Copyright 2005-2012 Texas Instruments Incorporated. All rights reserved.
//   10 
//   11   IMPORTANT: Your use of this Software is limited to those specific rights
//   12   granted under the terms of a software license agreement between the user
//   13   who downloaded the software, his/her employer (which must be your employer)
//   14   and Texas Instruments Incorporated (the "License"). You may not use this
//   15   Software unless you agree to abide by the terms of the License. The License
//   16   limits your use, and you acknowledge, that the Software may not be modified,
//   17   copied or distributed unless embedded on a Texas Instruments microcontroller
//   18   or used solely and exclusively in conjunction with a Texas Instruments radio
//   19   frequency transceiver, which is integrated into your product. Other than for
//   20   the foregoing purpose, you may not use, reproduce, copy, prepare derivative
//   21   works of, modify, distribute, perform, display or sell this Software and/or
//   22   its documentation for any purpose.
//   23 
//   24   YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
//   25   PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
//   26   INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
//   27   NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
//   28   TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
//   29   NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
//   30   LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
//   31   INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
//   32   OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
//   33   OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
//   34   (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
//   35 
//   36   Should you have any questions regarding your right to use this Software,
//   37   contact Texas Instruments Incorporated at www.TI.com.
//   38 ******************************************************************************/
//   39 
//   40 #ifdef __cplusplus
//   41 extern "C"
//   42 {
//   43 #endif
//   44 
//   45 /******************************************************************************
//   46  * INCLUDES
//   47  */
//   48 #include "ZComdef.h"
//   49 #include "OSAL.h"
//   50 #include "OSAL_NV.h"
//   51 #include "ZGlobals.h"
//   52 #include "ssp.h"
//   53 #include "nwk_globals.h"
//   54 #include "nwk.h"
//   55 #include "NLMEDE.h"
//   56 #include "AddrMgr.h"
//   57 #include "AssocList.h"
//   58 #include "APSMEDE.h"
//   59 #include "ZDConfig.h"
//   60 #include "ZDSecMgr.h"
//   61 
//   62 /******************************************************************************
//   63  * CONSTANTS
//   64  */
//   65 // maximum number of devices managed by this Security Manager
//   66 #if !defined ( ZDSECMGR_DEVICE_MAX )
//   67   #define ZDSECMGR_DEVICE_MAX 3
//   68 #endif
//   69 
//   70 // total number of preconfigured devices (EXT address, MASTER key)
//   71 //devtag.pro.security
//   72 //#define ZDSECMGR_PRECONFIG_MAX ZDSECMGR_DEVICE_MAX
//   73 #define ZDSECMGR_PRECONFIG_MAX 0
//   74 
//   75 // maximum number of MASTER keys this device may hold
//   76 #define ZDSECMGR_MASTERKEY_MAX ZDSECMGR_DEVICE_MAX
//   77 
//   78 // maximum number of LINK keys this device may store
//   79 #define ZDSECMGR_ENTRY_MAX ZDSECMGR_DEVICE_MAX
//   80 
//   81 // total number of devices under control - authentication, SKKE, etc.
//   82 #define ZDSECMGR_CTRL_MAX ZDSECMGR_DEVICE_MAX
//   83 
//   84 // total number of stored devices
//   85 #if !defined ( ZDSECMGR_STORED_DEVICES )
//   86   #define ZDSECMGR_STORED_DEVICES 3
//   87 #endif
//   88 
//   89 // Total number of preconfigured trust center link key
//   90 #if !defined ( ZDSECMGR_TC_DEVICE_MAX )
//   91   #define ZDSECMGR_TC_DEVICE_MAX 1
//   92 #endif
//   93 
//   94 #if ( ZDSECMGR_TC_DEVICE_MAX < 1 ) || ( ZDSECMGR_TC_DEVICE_MAX > 255 )
//   95   #error "ZDSECMGR_TC_DEVICE_MAX shall be between 1 and 255 !"
//   96 #endif
//   97 
//   98 #define ZDSECMGR_CTRL_NONE       0
//   99 #define ZDSECMGR_CTRL_INIT       1
//  100 #define ZDSECMGR_CTRL_TK_MASTER  2
//  101 #define ZDSECMGR_CTRL_SKKE_INIT  3
//  102 #define ZDSECMGR_CTRL_SKKE_WAIT  4
//  103 #define ZDSECMGR_CTRL_SKKE_DONE  5
//  104 #define ZDSECMGR_CTRL_SKKE_FAIL  6
//  105 #define ZDSECMGR_CTRL_TK_NWK     7
//  106 
//  107 #define ZDSECMGR_CTRL_BASE_CNTR      1
//  108 #define ZDSECMGR_CTRL_SKKE_INIT_CNTR 1
//  109 #define ZDSECMGR_CTRL_TK_NWK_CNTR    1
//  110 
//  111 // set SKA slot maximum
//  112 #define ZDSECMGR_SKA_SLOT_MAX 1
//  113 
//  114 // APSME Stub Implementations
//  115 #define ZDSecMgrMasterKeyGet   APSME_MasterKeyGet
//  116 #define ZDSecMgrLinkKeySet     APSME_LinkKeySet
//  117 #define ZDSecMgrLinkKeyNVIdGet APSME_LinkKeyNVIdGet
//  118 #define ZDSecMgrKeyFwdToChild  APSME_KeyFwdToChild
//  119 #define ZDSecMgrIsLinkKeyValid APSME_IsLinkKeyValid
//  120 
//  121 /******************************************************************************
//  122  * TYPEDEFS
//  123  */
//  124 typedef struct
//  125 {
//  126   uint8 extAddr[Z_EXTADDR_LEN];
//  127   uint8 key[SEC_KEY_LEN];
//  128 } ZDSecMgrPreConfigData_t;
//  129 
//  130 typedef struct
//  131 {
//  132   uint16 ami;
//  133   uint8  key[SEC_KEY_LEN];
//  134 } ZDSecMgrMasterKeyData_t;
//  135 
//  136 typedef struct
//  137 {
//  138   uint16            ami;
//  139   uint16            keyNvId;   // index to the Link Key table in NV
//  140   ZDSecMgr_Authentication_Option authenticateOption;
//  141 } ZDSecMgrEntry_t;
//  142 
//  143 typedef struct
//  144 {
//  145   ZDSecMgrEntry_t* entry;
//  146   uint16           parentAddr;
//  147   uint8            secure;
//  148   uint8            state;
//  149   uint8            cntr;
//  150 } ZDSecMgrCtrl_t;
//  151 
//  152 typedef struct
//  153 {
//  154   uint16          nwkAddr;
//  155   uint8*          extAddr;
//  156   uint16          parentAddr;
//  157   uint8           secure;
//  158   uint8           devStatus;
//  159   ZDSecMgrCtrl_t* ctrl;
//  160 } ZDSecMgrDevice_t;
//  161 
//  162 /******************************************************************************
//  163  * LOCAL VARIABLES
//  164  */
//  165 #if 0 // Taken out because the following functionality is only used for test
//  166       // purpose. A more efficient (above) way is used. It can be put
//  167       // back in if customers request for a white/black list feature.
//  168 uint8 ZDSecMgrStoredDeviceList[ZDSECMGR_STORED_DEVICES][Z_EXTADDR_LEN] =
//  169 {
//  170   { 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },
//  171   { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01 },
//  172   { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },
//  173 };
//  174 #endif
//  175 

        RSEG DATA16_Z:DATA:SORT:NOROOT(0)
        REQUIRE ?cstart_init_zero
//  176 uint8 ZDSecMgrTCExtAddr[Z_EXTADDR_LEN]=
ZDSecMgrTCExtAddr:
        DS8 8
//  177   { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
//  178 
//  179 // Key data is put in CONST area for security reasons

        RSEG DATA16_C:CONST:SORT:NOROOT(0)
//  180 CONST uint8 ZDSecMgrTCMasterKey[SEC_KEY_LEN] =
ZDSecMgrTCMasterKey:
        DC8 0, 0, 0, 0, 0, 0, 0, 0, 137, 103, 69, 35, 1, 239, 205, 171
//  181   {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//  182    0x89,0x67,0x45,0x23,0x01,0xEF,0xCD,0xAB};
//  183 

        RSEG DATA16_Z:DATA:SORT:NOROOT(0)
        REQUIRE ?cstart_init_zero
//  184 uint8 ZDSecMgrTCAuthenticated = FALSE;
ZDSecMgrTCAuthenticated:
        DS8 1
//  185 
//  186 //devtag.pro.security - remove this
//  187 #if ( ZDSECMGR_PRECONFIG_MAX != 0 )
//  188 const ZDSecMgrPreConfigData_t ZDSecMgrPreConfigData[ZDSECMGR_PRECONFIG_MAX] =
//  189 {
//  190   //---------------------------------------------------------------------------
//  191   // DEVICE A
//  192   //---------------------------------------------------------------------------
//  193   {
//  194     // extAddr
//  195     {0x7C,0x01,0x12,0x13,0x14,0x15,0x16,0x17},
//  196 
//  197     // key
//  198     {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//  199      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}
//  200   },
//  201   //---------------------------------------------------------------------------
//  202   // DEVICE B
//  203   //---------------------------------------------------------------------------
//  204   {
//  205     // extAddr
//  206     {0x84,0x03,0x00,0x00,0x00,0x4B,0x12,0x00},
//  207 
//  208     // key
//  209     {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//  210      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}
//  211   },
//  212   //---------------------------------------------------------------------------
//  213   // DEVICE C
//  214   //---------------------------------------------------------------------------
//  215   {
//  216     // extAddr
//  217     {0x3E,0x01,0x12,0x13,0x14,0x15,0x16,0x17},
//  218 
//  219     // key
//  220     {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
//  221      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}
//  222   },
//  223 };
//  224 #endif // ( ZDSECMGR_PRECONFIG_MAX != 0 )
//  225 

        RSEG DATA16_Z:DATA:SORT:NOROOT(1)
        REQUIRE ?cstart_init_zero
//  226 ZDSecMgrEntry_t* ZDSecMgrEntries  = NULL;
ZDSecMgrEntries:
        DS8 2

        RSEG DATA16_Z:DATA:SORT:NOROOT(1)
        REQUIRE ?cstart_init_zero
//  227 ZDSecMgrCtrl_t*  ZDSecMgrCtrlData = NULL;
ZDSecMgrCtrlData:
        DS8 2
//  228 void ZDSecMgrAddrMgrUpdate( uint16 ami, uint16 nwkAddr );
//  229 void ZDSecMgrAddrMgrCB( uint8 update, AddrMgrEntry_t* newEntry, AddrMgrEntry_t* oldEntry );
//  230 

        RSEG DATA16_Z:DATA:SORT:NOROOT(0)
        REQUIRE ?cstart_init_zero
//  231 uint8 ZDSecMgrPermitJoiningEnabled;
ZDSecMgrPermitJoiningEnabled:
        DS8 1

        RSEG DATA16_Z:DATA:SORT:NOROOT(0)
        REQUIRE ?cstart_init_zero
//  232 uint8 ZDSecMgrPermitJoiningTimed;
ZDSecMgrPermitJoiningTimed:
        DS8 1
//  233 

        RSEG DATA16_Z:DATA:SORT:NOROOT(1)
        REQUIRE ?cstart_init_zero
//  234 APSME_TCLinkKey_t TrustCenterLinkKey;
TrustCenterLinkKey:
        DS8 32
//  235 

        RSEG DATA16_Z:DATA:SORT:NOROOT(1)
        REQUIRE ?cstart_init_zero
//  236 APSME_ApsLinkKeyFrmCntr_t ApsLinkKeyFrmCntr[ZDSECMGR_ENTRY_MAX];
ApsLinkKeyFrmCntr:
        DS8 30

        RSEG DATA16_Z:DATA:SORT:NOROOT(1)
        REQUIRE ?cstart_init_zero
//  237 APSME_TCLinkKeyFrmCntr_t TCLinkKeyFrmCntr[ZDSECMGR_TC_DEVICE_MAX];
TCLinkKeyFrmCntr:
        DS8 10
//  238 
//  239 /******************************************************************************
//  240  * PRIVATE FUNCTIONS
//  241  *
//  242  *   ZDSecMgrMasterKeyInit
//  243  *   ZDSecMgrAddrStore
//  244  *   ZDSecMgrExtAddrStore
//  245  *   ZDSecMgrExtAddrLookup
//  246  *   ZDSecMgrMasterKeyLookup
//  247  *   ZDSecMgrMasterKeyStore
//  248  *   ZDSecMgrEntryInit
//  249  *   ZDSecMgrEntryLookup
//  250  *   ZDSecMgrEntryLookupAMI
//  251  *   ZDSecMgrEntryLookupExt
//  252  *   ZDSecMgrEntryLookupExtGetIndex
//  253  *   ZDSecMgrEntryFree
//  254  *   ZDSecMgrEntryNew
//  255  *   ZDSecMgrCtrlInit
//  256  *   ZDSecMgrCtrlRelease
//  257  *   ZDSecMgrCtrlLookup
//  258  *   ZDSecMgrCtrlSet
//  259  *   ZDSecMgrCtrlAdd
//  260  *   ZDSecMgrCtrlTerm
//  261  *   ZDSecMgrCtrlReset
//  262  *   ZDSecMgrMasterKeyLoad
//  263  *   ZDSecMgrAppKeyGet
//  264  *   ZDSecMgrAppKeyReq
//  265  *   ZDSecMgrEstablishKey
//  266  *   ZDSecMgrSendMasterKey
//  267  *   ZDSecMgrSendNwkKey
//  268  *   ZDSecMgrDeviceEntryRemove
//  269  *   ZDSecMgrDeviceEntryAdd
//  270  *   ZDSecMgrDeviceCtrlHandler
//  271  *   ZDSecMgrDeviceCtrlSetup
//  272  *   ZDSecMgrDeviceCtrlUpdate
//  273  *   ZDSecMgrDeviceRemove
//  274  *   ZDSecMgrDeviceValidateSKKE
//  275  *   ZDSecMgrDeviceValidateRM
//  276  *   ZDSecMgrDeviceValidateCM
//  277  *   ZDSecMgrDeviceValidate
//  278  *   ZDSecMgrDeviceJoin
//  279  *   ZDSecMgrDeviceJoinDirect
//  280  *   ZDSecMgrDeviceJoinFwd
//  281  *   ZDSecMgrDeviceNew
//  282  *   ZDSecMgrAssocDeviceAuth
//  283  *   ZDSecMgrAuthInitiate
//  284  *   ZDSecMgrAuthNwkKey
//  285  *   APSME_TCLinkKeyInit
//  286  *   APSME_IsDefaultTCLK
//  287  */
//  288 //-----------------------------------------------------------------------------
//  289 // master key data
//  290 //-----------------------------------------------------------------------------
//  291 void ZDSecMgrMasterKeyInit( void );
//  292 
//  293 //-----------------------------------------------------------------------------
//  294 // address management
//  295 //-----------------------------------------------------------------------------
//  296 ZStatus_t ZDSecMgrAddrStore( uint16 nwkAddr, uint8* extAddr, uint16* ami );
//  297 ZStatus_t ZDSecMgrExtAddrStore( uint16 nwkAddr, uint8* extAddr, uint16* ami );
//  298 ZStatus_t ZDSecMgrExtAddrLookup( uint8* extAddr, uint16* ami );
//  299 
//  300 //-----------------------------------------------------------------------------
//  301 // Trust Center management
//  302 //-----------------------------------------------------------------------------
//  303 uint8 ZDSecMgrTCExtAddrCheck( uint8* extAddr );
//  304 void ZDSecMgrTCDataLoad( uint8* extAddr );
//  305 
//  306 //-----------------------------------------------------------------------------
//  307 // MASTER key data
//  308 //-----------------------------------------------------------------------------
//  309 ZStatus_t ZDSecMgrMasterKeyLookup( uint16 ami, uint16* pKeyNvId );
//  310 ZStatus_t ZDSecMgrMasterKeyStore( uint16 ami, uint8* key );
//  311 
//  312 //-----------------------------------------------------------------------------
//  313 // entry data
//  314 //-----------------------------------------------------------------------------
//  315 void ZDSecMgrEntryInit(uint8 state);
//  316 ZStatus_t ZDSecMgrEntryLookup( uint16 nwkAddr, ZDSecMgrEntry_t** entry );
//  317 ZStatus_t ZDSecMgrEntryLookupAMI( uint16 ami, ZDSecMgrEntry_t** entry );
//  318 ZStatus_t ZDSecMgrEntryLookupExt( uint8* extAddr, ZDSecMgrEntry_t** entry );
//  319 ZStatus_t ZDSecMgrEntryLookupExtGetIndex( uint8* extAddr, ZDSecMgrEntry_t** entry, uint16* entryIndex );
//  320 ZStatus_t ZDSecMgrEntryLookupAMIGetIndex( uint16 ami, uint16* entryIndex );
//  321 void ZDSecMgrEntryFree( ZDSecMgrEntry_t* entry );
//  322 ZStatus_t ZDSecMgrEntryNew( ZDSecMgrEntry_t** entry );
//  323 ZStatus_t ZDSecMgrAuthenticationSet( uint8* extAddr, ZDSecMgr_Authentication_Option option );
//  324 void ZDSecMgrApsLinkKeyInit(void);
//  325 #if defined ( NV_RESTORE )
//  326 static void ZDSecMgrWriteNV(void);
//  327 static void ZDSecMgrRestoreFromNV(void);
//  328 static void ZDSecMgrUpdateNV( uint16 index );
//  329 #endif
//  330 
//  331 //-----------------------------------------------------------------------------
//  332 // control data
//  333 //-----------------------------------------------------------------------------
//  334 void ZDSecMgrCtrlInit( void );
//  335 void ZDSecMgrCtrlRelease( ZDSecMgrCtrl_t* ctrl );
//  336 void ZDSecMgrCtrlLookup( ZDSecMgrEntry_t* entry, ZDSecMgrCtrl_t** ctrl );
//  337 void ZDSecMgrCtrlSet( ZDSecMgrDevice_t* device,
//  338                       ZDSecMgrEntry_t*  entry,
//  339                       ZDSecMgrCtrl_t*   ctrl );
//  340 ZStatus_t ZDSecMgrCtrlAdd( ZDSecMgrDevice_t* device, ZDSecMgrEntry_t*  entry );
//  341 void ZDSecMgrCtrlTerm( ZDSecMgrEntry_t* entry );
//  342 ZStatus_t ZDSecMgrCtrlReset( ZDSecMgrDevice_t* device,
//  343                              ZDSecMgrEntry_t*  entry );
//  344 
//  345 //-----------------------------------------------------------------------------
//  346 // key support
//  347 //-----------------------------------------------------------------------------
//  348 ZStatus_t ZDSecMgrMasterKeyLoad( uint8* extAddr, uint8* key );
//  349 ZStatus_t ZDSecMgrAppKeyGet( uint16  initNwkAddr,
//  350                              uint8*  initExtAddr,
//  351                              uint16  partNwkAddr,
//  352                              uint8*  partExtAddr,
//  353                              uint8** key,
//  354                              uint8*  keyType );
//  355 void ZDSecMgrAppKeyReq( ZDO_RequestKeyInd_t* ind );
//  356 ZStatus_t ZDSecMgrEstablishKey( ZDSecMgrDevice_t* device );
//  357 ZStatus_t ZDSecMgrSendMasterKey( ZDSecMgrDevice_t* device );
//  358 ZStatus_t ZDSecMgrSendNwkKey( ZDSecMgrDevice_t* device );
//  359 void ZDSecMgrNwkKeyInit(uint8 setDefault);
//  360 
//  361 //-----------------------------------------------------------------------------
//  362 // device entry
//  363 //-----------------------------------------------------------------------------
//  364 void ZDSecMgrDeviceEntryRemove( ZDSecMgrEntry_t* entry );
//  365 ZStatus_t ZDSecMgrDeviceEntryAdd( ZDSecMgrDevice_t* device, uint16 ami );
//  366 
//  367 //-----------------------------------------------------------------------------
//  368 // device control
//  369 //-----------------------------------------------------------------------------
//  370 void ZDSecMgrDeviceCtrlHandler( ZDSecMgrDevice_t* device );
//  371 void ZDSecMgrDeviceCtrlSetup( ZDSecMgrDevice_t* device );
//  372 void ZDSecMgrDeviceCtrlUpdate( uint8* extAddr, uint8 state );
//  373 
//  374 //-----------------------------------------------------------------------------
//  375 // device management
//  376 //-----------------------------------------------------------------------------
//  377 void ZDSecMgrDeviceRemove( ZDSecMgrDevice_t* device );
//  378 ZStatus_t ZDSecMgrDeviceValidateSKKE( ZDSecMgrDevice_t* device );
//  379 ZStatus_t ZDSecMgrDeviceValidateRM( ZDSecMgrDevice_t* device );
//  380 ZStatus_t ZDSecMgrDeviceValidateCM( ZDSecMgrDevice_t* device );
//  381 ZStatus_t ZDSecMgrDeviceValidate( ZDSecMgrDevice_t* device );
//  382 ZStatus_t ZDSecMgrDeviceJoin( ZDSecMgrDevice_t* device );
//  383 ZStatus_t ZDSecMgrDeviceJoinDirect( ZDSecMgrDevice_t* device );
//  384 ZStatus_t ZDSecMgrDeviceJoinFwd( ZDSecMgrDevice_t* device );
//  385 ZStatus_t ZDSecMgrDeviceNew( ZDSecMgrDevice_t* device );
//  386 
//  387 //-----------------------------------------------------------------------------
//  388 // association management
//  389 //-----------------------------------------------------------------------------
//  390 void ZDSecMgrAssocDeviceAuth( associated_devices_t* assoc );
//  391 
//  392 //-----------------------------------------------------------------------------
//  393 // authentication management
//  394 //-----------------------------------------------------------------------------
//  395 void ZDSecMgrAuthInitiate( uint8* responder );
//  396 void ZDSecMgrAuthNwkKey( void );
//  397 
//  398 //-----------------------------------------------------------------------------
//  399 // APSME function
//  400 //-----------------------------------------------------------------------------
//  401 void APSME_TCLinkKeyInit( uint8 setDefault );
//  402 uint8 APSME_IsDefaultTCLK( uint8 *extAddr );
//  403 
//  404 /******************************************************************************
//  405  * @fn          ZDSecMgrMasterKeyInit                     ]
//  406  *
//  407  * @brief       Initialize master key data in NV
//  408  *
//  409  * @param       none
//  410  *
//  411  * @return      none
//  412  */
//  413 void ZDSecMgrMasterKeyInit( void )
//  414 {
//  415   uint16 index;
//  416   ZDSecMgrMasterKeyData_t   masterKeyData;
//  417 
//  418   masterKeyData.ami = INVALID_NODE_ADDR;
//  419 
//  420   osal_memset( &masterKeyData.key, 0x00, SEC_KEY_LEN );
//  421 
//  422   for ( index = 0; index < ZDSECMGR_MASTERKEY_MAX; index++ )
//  423   {
//  424     if ( osal_nv_item_init( (ZCD_NV_MASTER_KEY_DATA_START + index),
//  425                        sizeof(ZDSecMgrMasterKeyData_t), &masterKeyData) == SUCCESS)
//  426     {
//  427       // the item already exists in NV just needs to be set to default values
//  428       osal_nv_write( (ZCD_NV_MASTER_KEY_DATA_START + index), 0,
//  429                       sizeof(ZDSecMgrMasterKeyData_t), &masterKeyData );
//  430     }
//  431   }
//  432 }
//  433 
//  434 /******************************************************************************
//  435  * @fn          ZDSecMgrAddrStore
//  436  *
//  437  * @brief       Store device addresses.
//  438  *
//  439  * @param       nwkAddr - [in] NWK address
//  440  * @param       extAddr - [in] EXT address
//  441  * @param       ami     - [out] Address Manager index
//  442  *
//  443  * @return      ZStatus_t
//  444  */
//  445 ZStatus_t ZDSecMgrAddrStore( uint16 nwkAddr, uint8* extAddr, uint16* ami )
//  446 {
//  447   ZStatus_t      status;
//  448   AddrMgrEntry_t entry;
//  449 
//  450 
//  451   // add entry
//  452   entry.user    = ADDRMGR_USER_SECURITY;
//  453   entry.nwkAddr = nwkAddr;
//  454   AddrMgrExtAddrSet( entry.extAddr, extAddr );
//  455 
//  456   if ( AddrMgrEntryUpdate( &entry ) == TRUE )
//  457   {
//  458     // return successful results
//  459     *ami   = entry.index;
//  460     status = ZSuccess;
//  461   }
//  462   else
//  463   {
//  464     // return failed results
//  465     *ami   = entry.index;
//  466     status = ZNwkUnknownDevice;
//  467   }
//  468 
//  469   return status;
//  470 }
//  471 
//  472 /******************************************************************************
//  473  * @fn          ZDSecMgrExtAddrStore
//  474  *
//  475  * @brief       Store EXT address.
//  476  *
//  477  * @param       extAddr - [in] EXT address
//  478  * @param       ami     - [out] Address Manager index
//  479  *
//  480  * @return      ZStatus_t
//  481  */
//  482 ZStatus_t ZDSecMgrExtAddrStore( uint16 nwkAddr, uint8* extAddr, uint16* ami )
//  483 {
//  484   ZStatus_t      status;
//  485   AddrMgrEntry_t entry;
//  486 
//  487 
//  488   // add entry
//  489   entry.user    = ADDRMGR_USER_SECURITY;
//  490   entry.nwkAddr = nwkAddr;
//  491   AddrMgrExtAddrSet( entry.extAddr, extAddr );
//  492 
//  493   if ( AddrMgrEntryUpdate( &entry ) == TRUE )
//  494   {
//  495     // return successful results
//  496     *ami   = entry.index;
//  497     status = ZSuccess;
//  498   }
//  499   else
//  500   {
//  501     // return failed results
//  502     *ami   = entry.index;
//  503     status = ZNwkUnknownDevice;
//  504   }
//  505 
//  506   return status;
//  507 }
//  508 
//  509 /******************************************************************************
//  510  * @fn          ZDSecMgrExtAddrLookup
//  511  *
//  512  * @brief       Lookup index for specified EXT address.
//  513  *
//  514  * @param       extAddr - [in] EXT address
//  515  * @param       ami     - [out] Address Manager index
//  516  *
//  517  * @return      ZStatus_t
//  518  */
//  519 ZStatus_t ZDSecMgrExtAddrLookup( uint8* extAddr, uint16* ami )
//  520 {
//  521   ZStatus_t      status;
//  522   AddrMgrEntry_t entry;
//  523 
//  524 
//  525   // lookup entry
//  526   entry.user = ADDRMGR_USER_SECURITY;
//  527   AddrMgrExtAddrSet( entry.extAddr, extAddr );
//  528 
//  529   if ( AddrMgrEntryLookupExt( &entry ) == TRUE )
//  530   {
//  531     // return successful results
//  532     *ami   = entry.index;
//  533     status = ZSuccess;
//  534   }
//  535   else
//  536   {
//  537     // return failed results
//  538     *ami   = entry.index;
//  539     status = ZNwkUnknownDevice;
//  540   }
//  541 
//  542   return status;
//  543 }
//  544 
//  545 /******************************************************************************
//  546  * @fn          ZDSecMgrAddrClear
//  547  *
//  548  * @brief       Clear security bit from Address Manager for specific device.
//  549  *
//  550  * @param       extAddr - [in] EXT address
//  551  *
//  552  * @return      ZStatus_t
//  553  */
//  554 ZStatus_t ZDSecMgrAddrClear( uint8* extAddr )
//  555 {
//  556   ZStatus_t status;
//  557   uint16 entryAmi;
//  558 
//  559   // get Address Manager Index
//  560   status = ZDSecMgrExtAddrLookup( extAddr, &entryAmi );
//  561 
//  562   if ( status == ZSuccess )
//  563   {
//  564     AddrMgrEntry_t addrEntry;
//  565 
//  566     // Clear SECURITY User bit from the address manager
//  567     addrEntry.user = ADDRMGR_USER_SECURITY;
//  568     addrEntry.index = entryAmi;
//  569 
//  570     if ( AddrMgrEntryRelease( &addrEntry ) != TRUE )
//  571     {
//  572       // return failure results
//  573       status = ZFailure;
//  574     }
//  575   }
//  576 
//  577   return status;
//  578 }
//  579 
//  580 /******************************************************************************
//  581  * @fn          ZDSecMgrMasterKeyLookup
//  582  *
//  583  * @brief       Lookup MASTER key for specified address index.
//  584  *
//  585  * @param       ami - [in] Address Manager index
//  586  * @param       pKeyNvId - [out] MASTER key NV ID
//  587  *
//  588  * @return      ZStatus_t
//  589  */
//  590 ZStatus_t ZDSecMgrMasterKeyLookup( uint16 ami, uint16* pKeyNvId )
//  591 {
//  592   uint16 index;
//  593   ZDSecMgrMasterKeyData_t masterKeyData;
//  594 
//  595 
//  596   for ( index = 0; index < ZDSECMGR_MASTERKEY_MAX ; index++ )
//  597   {
//  598     // Read entry index of the Master key table from NV
//  599     osal_nv_read( (ZCD_NV_MASTER_KEY_DATA_START + index), 0,
//  600                   sizeof(ZDSecMgrMasterKeyData_t), &masterKeyData );
//  601 
//  602     if ( masterKeyData.ami == ami )
//  603     {
//  604       // return successful results
//  605       *pKeyNvId   = ZCD_NV_MASTER_KEY_DATA_START + index;
//  606 
//  607       // clear copy of key in RAM
//  608       osal_memset(&masterKeyData, 0x00, sizeof(ZDSecMgrMasterKeyData_t));
//  609 
//  610       return ZSuccess;
//  611     }
//  612   }
//  613 
//  614   *pKeyNvId = SEC_NO_KEY_NV_ID;
//  615 
//  616   // clear copy of key in RAM
//  617   osal_memset(&masterKeyData, 0x00, sizeof(ZDSecMgrMasterKeyData_t));
//  618 
//  619   return ZNwkUnknownDevice;
//  620 }
//  621 
//  622 /******************************************************************************
//  623  * @fn          ZDSecMgrMasterKeyStore
//  624  *
//  625  * @brief       Store MASTER key for specified address index.
//  626  *
//  627  * @param       ami - [in] Address Manager index
//  628  * @param       key - [in] valid key to store
//  629  *
//  630  * @return      ZStatus_t
//  631  */
//  632 ZStatus_t ZDSecMgrMasterKeyStore( uint16 ami, uint8* key )
//  633 {
//  634   uint16    index;
//  635   ZDSecMgrMasterKeyData_t   masterKeyData;
//  636 
//  637 
//  638   for ( index = 0; index < ZDSECMGR_MASTERKEY_MAX ; index++ )
//  639   {
//  640     // Read entry index of the Master key table from NV
//  641     osal_nv_read( (ZCD_NV_MASTER_KEY_DATA_START + index), 0,
//  642                    sizeof(ZDSecMgrMasterKeyData_t), &masterKeyData );
//  643 
//  644     if ( masterKeyData.ami == INVALID_NODE_ADDR )
//  645     {
//  646       // store EXT address index
//  647       masterKeyData.ami = ami;
//  648 
//  649       if ( key != NULL )
//  650       {
//  651         osal_memcpy( masterKeyData.key, key,  SEC_KEY_LEN );
//  652       }
//  653       else
//  654       {
//  655         osal_memset( masterKeyData.key, 0, SEC_KEY_LEN );
//  656       }
//  657 
//  658       // set new values in NV
//  659       osal_nv_write( (ZCD_NV_MASTER_KEY_DATA_START + index), 0,
//  660                       sizeof(ZDSecMgrMasterKeyData_t), &masterKeyData );
//  661 
//  662       // clear copy of key in RAM
//  663       osal_memset( &masterKeyData, 0x00, sizeof(ZDSecMgrMasterKeyData_t) );
//  664 
//  665       // return successful results
//  666       return ZSuccess;
//  667     }
//  668   }
//  669 
//  670   // clear copy of key in RAM
//  671   osal_memset( &masterKeyData, 0x00, sizeof(ZDSecMgrMasterKeyData_t) );
//  672 
//  673   return ZNwkUnknownDevice;
//  674 }
//  675 
//  676 /******************************************************************************
//  677  * @fn          ZDSecMgrEntryInit
//  678  *
//  679  * @brief       Initialize entry sub module
//  680  *
//  681  * @param       state - device initialization state
//  682  *
//  683  * @return      none
//  684  */
//  685 void ZDSecMgrEntryInit(uint8 state)
//  686 {
//  687   if (ZDSecMgrEntries == NULL)
//  688   {
//  689     uint16 index;
//  690 
//  691     if ((ZDSecMgrEntries = osal_mem_alloc(sizeof(ZDSecMgrEntry_t) * ZDSECMGR_ENTRY_MAX)) == NULL)
//  692     {
//  693       return;
//  694     }
//  695 
//  696     for (index = 0; index < ZDSECMGR_ENTRY_MAX; index++)
//  697     {
//  698       ZDSecMgrEntries[index].ami = INVALID_NODE_ADDR;
//  699 
//  700       ZDSecMgrEntries[index].keyNvId = SEC_NO_KEY_NV_ID;
//  701     }
//  702   }
//  703 
//  704 #if defined NV_RESTORE
//  705   if (state == ZDO_INITDEV_RESTORED_NETWORK_STATE)
//  706   {
//  707     ZDSecMgrRestoreFromNV();
//  708   }
//  709 #else
//  710   (void)state;
//  711 #endif
//  712 }
//  713 
//  714 /******************************************************************************
//  715  * @fn          ZDSecMgrEntryLookup
//  716  *
//  717  * @brief       Lookup entry index using specified NWK address.
//  718  *
//  719  * @param       nwkAddr - [in] NWK address
//  720  * @param       entry   - [out] valid entry
//  721  *
//  722  * @return      ZStatus_t
//  723  */
//  724 ZStatus_t ZDSecMgrEntryLookup( uint16 nwkAddr, ZDSecMgrEntry_t** entry )
//  725 {
//  726   uint16         index;
//  727   AddrMgrEntry_t addrMgrEntry;
//  728 
//  729   // initialize results
//  730   *entry = NULL;
//  731 
//  732   // verify data is available
//  733   if ( ZDSecMgrEntries != NULL )
//  734   {
//  735     addrMgrEntry.user    = ADDRMGR_USER_SECURITY;
//  736     addrMgrEntry.nwkAddr = nwkAddr;
//  737 
//  738     if ( AddrMgrEntryLookupNwk( &addrMgrEntry ) == TRUE )
//  739     {
//  740       for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
//  741       {
//  742         if ( addrMgrEntry.index == ZDSecMgrEntries[index].ami )
//  743         {
//  744           // return successful results
//  745           *entry = &ZDSecMgrEntries[index];
//  746 
//  747           // break from loop
//  748           return ZSuccess;
//  749         }
//  750       }
//  751     }
//  752   }
//  753 
//  754   return ZNwkUnknownDevice;
//  755 }
//  756 
//  757 /******************************************************************************
//  758  * @fn          ZDSecMgrEntryLookupAMI
//  759  *
//  760  * @brief       Lookup entry using specified address index
//  761  *
//  762  * @param       ami   - [in] Address Manager index
//  763  * @param       entry - [out] valid entry
//  764  *
//  765  * @return      ZStatus_t
//  766  */
//  767 ZStatus_t ZDSecMgrEntryLookupAMI( uint16 ami, ZDSecMgrEntry_t** entry )
//  768 {
//  769   uint16 index;
//  770 
//  771   // initialize results
//  772   *entry = NULL;
//  773 
//  774   // verify data is available
//  775   if ( ZDSecMgrEntries != NULL )
//  776   {
//  777     for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
//  778     {
//  779       if ( ZDSecMgrEntries[index].ami == ami )
//  780       {
//  781         // return successful results
//  782         *entry = &ZDSecMgrEntries[index];
//  783 
//  784         // break from loop
//  785         return ZSuccess;
//  786       }
//  787     }
//  788   }
//  789 
//  790   return ZNwkUnknownDevice;
//  791 }
//  792 
//  793 /******************************************************************************
//  794  * @fn          ZDSecMgrEntryLookupExt
//  795  *
//  796  * @brief       Lookup entry index using specified EXT address.
//  797  *
//  798  * @param       extAddr - [in] EXT address
//  799  * @param       entry   - [out] valid entry
//  800  *
//  801  * @return      ZStatus_t
//  802  */
//  803 ZStatus_t ZDSecMgrEntryLookupExt( uint8* extAddr, ZDSecMgrEntry_t** entry )
//  804 {
//  805   ZStatus_t status;
//  806   uint16    ami;
//  807 
//  808   // initialize results
//  809   *entry = NULL;
//  810   status = ZNwkUnknownDevice;
//  811 
//  812   // lookup address index
//  813   if ( ZDSecMgrExtAddrLookup( extAddr, &ami ) == ZSuccess )
//  814   {
//  815     status = ZDSecMgrEntryLookupAMI( ami, entry );
//  816   }
//  817 
//  818   return status;
//  819 }
//  820 
//  821 /******************************************************************************
//  822  * @fn          ZDSecMgrEntryLookupExtGetIndex
//  823  *
//  824  * @brief       Lookup entry index using specified EXT address.
//  825  *
//  826  * @param       extAddr - [in] EXT address
//  827  * @param       entryIndex - [out] valid index to the entry table
//  828  *
//  829  * @return      ZStatus_t
//  830  */
//  831 ZStatus_t ZDSecMgrEntryLookupExtGetIndex( uint8* extAddr, ZDSecMgrEntry_t** entry, uint16* entryIndex )
//  832 {
//  833   uint16 ami;
//  834   uint16 index;
//  835 
//  836   // lookup address index
//  837   if ( ZDSecMgrExtAddrLookup( extAddr, &ami ) == ZSuccess )
//  838   {
//  839     // verify data is available
//  840     if ( ZDSecMgrEntries != NULL )
//  841     {
//  842       for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
//  843       {
//  844         if ( ZDSecMgrEntries[index].ami == ami )
//  845         {
//  846           // return successful results
//  847           *entry = &ZDSecMgrEntries[index];
//  848           *entryIndex = index;
//  849 
//  850           // break from loop
//  851           return ZSuccess;
//  852         }
//  853       }
//  854     }
//  855   }
//  856 
//  857   return ZNwkUnknownDevice;
//  858 }
//  859 
//  860 /******************************************************************************
//  861  * @fn          ZDSecMgrEntryLookupAMIGetIndex
//  862  *
//  863  * @brief       Lookup entry using specified address index
//  864  *
//  865  * @param       ami   - [in] Address Manager index
//  866  * @param       entryIndex - [out] valid index to the entry table
//  867  *
//  868  * @return      ZStatus_t
//  869  */
//  870 ZStatus_t ZDSecMgrEntryLookupAMIGetIndex( uint16 ami, uint16* entryIndex )
//  871 {
//  872   uint16 index;
//  873 
//  874   // verify data is available
//  875   if ( ZDSecMgrEntries != NULL )
//  876   {
//  877     for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
//  878     {
//  879       if ( ZDSecMgrEntries[index].ami == ami )
//  880       {
//  881         // return successful results
//  882         *entryIndex = index;
//  883 
//  884         // break from loop
//  885         return ZSuccess;
//  886       }
//  887     }
//  888   }
//  889 
//  890   return ZNwkUnknownDevice;
//  891 }
//  892 
//  893 /******************************************************************************
//  894  * @fn          ZDSecMgrEntryFree
//  895  *
//  896  * @brief       Free entry.
//  897  *
//  898  * @param       entry - [in] valid entry
//  899  *
//  900  * @return      ZStatus_t
//  901  */
//  902 void ZDSecMgrEntryFree( ZDSecMgrEntry_t* entry )
//  903 {
//  904   APSME_LinkKeyData_t   *pApsLinkKey = NULL;
//  905 
//  906 #if defined ( NV_RESTORE )
//  907   ZStatus_t status;
//  908   uint16 entryIndex;
//  909 
//  910   status = ZDSecMgrEntryLookupAMIGetIndex( entry->ami, &entryIndex );
//  911 #endif
//  912 
//  913   pApsLinkKey = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
//  914 
//  915   if (pApsLinkKey != NULL)
//  916   {
//  917     osal_memset( pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t) );
//  918 
//  919     // Clear the APS Link key in NV
//  920     osal_nv_write( entry->keyNvId, 0,
//  921                         sizeof(APSME_LinkKeyData_t), pApsLinkKey);
//  922 
//  923     // set entry to invalid Key
//  924     entry->keyNvId = SEC_NO_KEY_NV_ID;
//  925 
//  926     osal_mem_free(pApsLinkKey);
//  927   }
//  928 
//  929   // marking the entry as INVALID_NODE_ADDR
//  930   entry->ami = INVALID_NODE_ADDR;
//  931 
//  932   // set to default value
//  933   entry->authenticateOption = ZDSecMgr_Not_Authenticated;
//  934 
//  935 #if defined ( NV_RESTORE )
//  936   if ( status == ZSuccess )
//  937   {
//  938     ZDSecMgrUpdateNV(entryIndex);
//  939   }
//  940 #endif
//  941 }
//  942 
//  943 /******************************************************************************
//  944  * @fn          ZDSecMgrEntryNew
//  945  *
//  946  * @brief       Get a new entry.
//  947  *
//  948  * @param       entry - [out] valid entry
//  949  *
//  950  * @return      ZStatus_t
//  951  */
//  952 ZStatus_t ZDSecMgrEntryNew( ZDSecMgrEntry_t** entry )
//  953 {
//  954   uint16 index;
//  955 
//  956   // initialize results
//  957   *entry = NULL;
//  958 
//  959   // verify data is available
//  960   if ( ZDSecMgrEntries != NULL )
//  961   {
//  962     // find available entry
//  963     for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
//  964     {
//  965       if ( ZDSecMgrEntries[index].ami == INVALID_NODE_ADDR )
//  966       {
//  967         // return successful result
//  968         *entry = &ZDSecMgrEntries[index];
//  969 
//  970         // Set the authentication option to default
//  971         ZDSecMgrEntries[index].authenticateOption = ZDSecMgr_Not_Authenticated;
//  972 
//  973         // break from loop
//  974         return ZSuccess;
//  975       }
//  976     }
//  977   }
//  978 
//  979   return ZNwkUnknownDevice;
//  980 }
//  981 
//  982 /******************************************************************************
//  983  * @fn          ZDSecMgrCtrlInit
//  984  *
//  985  * @brief       Initialize control sub module
//  986  *
//  987  * @param       none
//  988  *
//  989  * @return      none
//  990  */
//  991 void ZDSecMgrCtrlInit( void )
//  992 {
//  993   uint16 size;
//  994   uint16 index;
//  995 
//  996   // allocate entry data
//  997   size = (short)( sizeof(ZDSecMgrCtrl_t) * ZDSECMGR_CTRL_MAX );
//  998 
//  999   ZDSecMgrCtrlData = osal_mem_alloc( size );
// 1000 
// 1001   // initialize data
// 1002   if ( ZDSecMgrCtrlData != NULL )
// 1003   {
// 1004     for( index = 0; index < ZDSECMGR_CTRL_MAX; index++ )
// 1005     {
// 1006       ZDSecMgrCtrlData[index].state = ZDSECMGR_CTRL_NONE;
// 1007     }
// 1008   }
// 1009 }
// 1010 
// 1011 /******************************************************************************
// 1012  * @fn          ZDSecMgrCtrlRelease
// 1013  *
// 1014  * @brief       Release control data.
// 1015  *
// 1016  * @param       ctrl - [in] valid control data
// 1017  *
// 1018  * @return      none
// 1019  */
// 1020 void ZDSecMgrCtrlRelease( ZDSecMgrCtrl_t* ctrl )
// 1021 {
// 1022   // should always be enough entry control data
// 1023   ctrl->state = ZDSECMGR_CTRL_NONE;
// 1024 }
// 1025 
// 1026 /******************************************************************************
// 1027  * @fn          ZDSecMgrCtrlLookup
// 1028  *
// 1029  * @brief       Lookup control data.
// 1030  *
// 1031  * @param       entry - [in] valid entry data
// 1032  * @param       ctrl  - [out] control data - NULL if not found
// 1033  *
// 1034  * @return      none
// 1035  */
// 1036 void ZDSecMgrCtrlLookup( ZDSecMgrEntry_t* entry, ZDSecMgrCtrl_t** ctrl )
// 1037 {
// 1038   uint16 index;
// 1039 
// 1040   // initialize search results
// 1041   *ctrl = NULL;
// 1042 
// 1043   // verify data is available
// 1044   if ( ZDSecMgrCtrlData != NULL )
// 1045   {
// 1046     for ( index = 0; index < ZDSECMGR_CTRL_MAX; index++ )
// 1047     {
// 1048       // make sure control data is in use
// 1049       if ( ZDSecMgrCtrlData[index].state != ZDSECMGR_CTRL_NONE )
// 1050       {
// 1051         // check for entry match
// 1052         if ( ZDSecMgrCtrlData[index].entry == entry )
// 1053         {
// 1054           // return this control data
// 1055           *ctrl = &ZDSecMgrCtrlData[index];
// 1056 
// 1057           // break from loop
// 1058           return;
// 1059         }
// 1060       }
// 1061     }
// 1062   }
// 1063 }
// 1064 
// 1065 /******************************************************************************
// 1066  * @fn          ZDSecMgrCtrlSet
// 1067  *
// 1068  * @brief       Set control data.
// 1069  *
// 1070  * @param       device - [in] valid device data
// 1071  * @param       entry  - [in] valid entry data
// 1072  * @param       ctrl   - [in] valid control data
// 1073  *
// 1074  * @return      none
// 1075  */
// 1076 void ZDSecMgrCtrlSet( ZDSecMgrDevice_t* device,
// 1077                       ZDSecMgrEntry_t*  entry,
// 1078                       ZDSecMgrCtrl_t*   ctrl )
// 1079 {
// 1080   // set control date
// 1081   ctrl->parentAddr = device->parentAddr;
// 1082   ctrl->secure     = device->secure;
// 1083   ctrl->entry      = entry;
// 1084   ctrl->state      = ZDSECMGR_CTRL_INIT;
// 1085   ctrl->cntr       = 0;
// 1086 
// 1087   // set device pointer
// 1088   device->ctrl = ctrl;
// 1089 }
// 1090 
// 1091 /******************************************************************************
// 1092  * @fn          ZDSecMgrCtrlAdd
// 1093  *
// 1094  * @brief       Add control data.
// 1095  *
// 1096  * @param       device - [in] valid device data
// 1097  * @param       entry  - [in] valid entry data
// 1098  *
// 1099  * @return      ZStatus_t
// 1100  */
// 1101 ZStatus_t ZDSecMgrCtrlAdd( ZDSecMgrDevice_t* device, ZDSecMgrEntry_t*  entry )
// 1102 {
// 1103   uint16 index;
// 1104 
// 1105   // verify data is available
// 1106   if ( ZDSecMgrCtrlData != NULL )
// 1107   {
// 1108     // look for an empty slot
// 1109     for ( index = 0; index < ZDSECMGR_CTRL_MAX; index++ )
// 1110     {
// 1111       if ( ZDSecMgrCtrlData[index].state == ZDSECMGR_CTRL_NONE )
// 1112       {
// 1113         // return successful results
// 1114         ZDSecMgrCtrlSet( device, entry, &ZDSecMgrCtrlData[index] );
// 1115 
// 1116         // break from loop
// 1117         return ZSuccess;
// 1118       }
// 1119     }
// 1120   }
// 1121 
// 1122   return ZNwkUnknownDevice;
// 1123 }
// 1124 
// 1125 /******************************************************************************
// 1126  * @fn          ZDSecMgrCtrlTerm
// 1127  *
// 1128  * @brief       Terminate device control.
// 1129  *
// 1130  * @param       entry - [in] valid entry data
// 1131  *
// 1132  * @return      none
// 1133  */
// 1134 void ZDSecMgrCtrlTerm( ZDSecMgrEntry_t* entry )
// 1135 {
// 1136   ZDSecMgrCtrl_t* ctrl;
// 1137 
// 1138   // remove device from control data
// 1139   ZDSecMgrCtrlLookup ( entry, &ctrl );
// 1140 
// 1141   if ( ctrl != NULL )
// 1142   {
// 1143     ZDSecMgrCtrlRelease ( ctrl );
// 1144   }
// 1145 }
// 1146 
// 1147 /******************************************************************************
// 1148  * @fn          ZDSecMgrCtrlReset
// 1149  *
// 1150  * @brief       Reset control data.
// 1151  *
// 1152  * @param       device - [in] valid device data
// 1153  * @param       entry  - [in] valid entry data
// 1154  *
// 1155  * @return      ZStatus_t
// 1156  */
// 1157 ZStatus_t ZDSecMgrCtrlReset( ZDSecMgrDevice_t* device, ZDSecMgrEntry_t* entry )
// 1158 {
// 1159   ZStatus_t       status;
// 1160   ZDSecMgrCtrl_t* ctrl;
// 1161 
// 1162   // initialize results
// 1163   status = ZNwkUnknownDevice;
// 1164 
// 1165   // look for a match for the entry
// 1166   ZDSecMgrCtrlLookup( entry, &ctrl );
// 1167 
// 1168   if ( ctrl != NULL )
// 1169   {
// 1170     ZDSecMgrCtrlSet( device, entry, ctrl );
// 1171 
// 1172     status = ZSuccess;
// 1173   }
// 1174   else
// 1175   {
// 1176     status = ZDSecMgrCtrlAdd( device, entry );
// 1177   }
// 1178 
// 1179   return status;
// 1180 }
// 1181 
// 1182 /******************************************************************************
// 1183  * @fn          ZDSecMgrMasterKeyLoad
// 1184  *
// 1185  * @brief       Load the MASTER key for device with specified EXT
// 1186  *              address.
// 1187  *
// 1188  * @param       extAddr - [in] EXT address of device
// 1189  * @param       key     - [in] MASTER key shared with device
// 1190  *
// 1191  * @return      ZStatus_t
// 1192  */
// 1193 ZStatus_t ZDSecMgrMasterKeyLoad( uint8* extAddr, uint8* key )
// 1194 {
// 1195   ZStatus_t status;
// 1196   uint16 ami;
// 1197   uint16 keyNvId;
// 1198 
// 1199   // set status based on policy
// 1200   status = ZDSecMgrExtAddrLookup( extAddr, &ami );
// 1201 
// 1202   if ( status == ZSuccess )
// 1203   {
// 1204     // get the address NV ID
// 1205     if ( ZDSecMgrMasterKeyLookup( ami, &keyNvId ) == ZSuccess )
// 1206     {
// 1207       // overwrite old key in NV
// 1208       osal_nv_write( keyNvId, osal_offsetof(ZDSecMgrMasterKeyData_t, key),
// 1209                      SEC_KEY_LEN, key );
// 1210     }
// 1211     else
// 1212     {
// 1213       // store new key -- NULL will zero key
// 1214       status = ZDSecMgrMasterKeyStore( ami, key );
// 1215     }
// 1216   }
// 1217 
// 1218   return status;
// 1219 }
// 1220 
// 1221 /******************************************************************************
// 1222  * @fn          ZDSecMgrAppKeyGet
// 1223  *
// 1224  * @brief       get an APP key - option APP(MASTER or LINK) key
// 1225  *
// 1226  * @param       initNwkAddr - [in] NWK address of initiator device
// 1227  * @param       initExtAddr - [in] EXT address of initiator device
// 1228  * @param       partNwkAddr - [in] NWK address of partner device
// 1229  * @param       partExtAddr - [in] EXT address of partner device
// 1230  * @param       key         - [out] APP(MASTER or LINK) key
// 1231  * @param       keyType     - [out] APP(MASTER or LINK) key type
// 1232  *
// 1233  * @return      ZStatus_t
// 1234  */

        RSEG DATA16_I:DATA:SORT:NOROOT(0)
        REQUIRE ?cstart_init_copy
// 1235 uint8 ZDSecMgrAppKeyType = KEY_TYPE_APP_LINK;    // Set the default key type
ZDSecMgrAppKeyType:
        DS8 1
        REQUIRE `?<Initializer for ZDSecMgrAppKeyType>`

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrApsLinkKeyInit:
          CFI Block cfiBlock0 Using cfiCommon0
          CFI Function ZDSecMgrApsLinkKeyInit
        FUNCALL ZDSecMgrApsLinkKeyInit, osal_memset
        LOCFRAME CSTACK, 36, STACK
        FUNCALL ZDSecMgrApsLinkKeyInit, osal_nv_item_init
        LOCFRAME CSTACK, 36, STACK
        FUNCALL ZDSecMgrApsLinkKeyInit, osal_nv_write
        LOCFRAME CSTACK, 36, STACK
        PUSHM.W #0x4, R11
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+12
        SUB.W   #0x18, SP
          CFI CFA SP+36
        MOV.W   SP, R11
        ADD.W   #0x0, R11
        MOV.W   #0x18, R14
        CALLA   #??Subroutine21_0
??CrossCallReturnLabel_73:
        MOV.B   #0x0, R10
??ZDSecMgrApsLinkKeyInit_0:
        MOV.B   R10, R8
        ADD.W   #0x201, R8
        MOV.W   R11, R14
        MOV.W   #0x18, R13
        CALLA   #?Subroutine29
??CrossCallReturnLabel_49:
        JNE     ??ZDSecMgrApsLinkKeyInit_1
        CALLA   #?Subroutine28
??CrossCallReturnLabel_60:
        MOV.W   R8, R12
        CALLA   #osal_nv_write
??ZDSecMgrApsLinkKeyInit_1:
        ADD.B   #0x1, R10
        CMP.B   #0x3, R10
        JNC     ??ZDSecMgrApsLinkKeyInit_0
          CFI EndBlock cfiBlock0
        REQUIRE ?Subroutine3
        // Fall through to label ?Subroutine3
// 1236                                                  // to KEY_TYPE_APP_LINK since
// 1237                                                  // only specific requirement
// 1238                                                  // right now comes from SE profile
// 1239 
// 1240 ZStatus_t ZDSecMgrAppKeyGet( uint16  initNwkAddr,
// 1241                              uint8*  initExtAddr,
// 1242                              uint16  partNwkAddr,
// 1243                              uint8*  partExtAddr,
// 1244                              uint8** key,
// 1245                              uint8*  keyType )
// 1246 {
// 1247   // Intentionally unreferenced parameters
// 1248   (void)initNwkAddr;
// 1249   (void)initExtAddr;
// 1250   (void)partNwkAddr;
// 1251   (void)partExtAddr;
// 1252 
// 1253   //---------------------------------------------------------------------------
// 1254   // note:
// 1255   // should use a robust mechanism to generate keys, for example
// 1256   // combine EXT addresses and call a hash function
// 1257   //---------------------------------------------------------------------------
// 1258   SSP_GetTrueRand( SEC_KEY_LEN, *key );
// 1259 
// 1260   *keyType = ZDSecMgrAppKeyType;
// 1261 
// 1262   return ZSuccess;
// 1263 }
// 1264 
// 1265 /******************************************************************************
// 1266  * @fn          ZDSecMgrAppKeyReq
// 1267  *
// 1268  * @brief       Process request for APP key between two devices.
// 1269  *
// 1270  * @param       device - [in] ZDO_RequestKeyInd_t, request info
// 1271  *
// 1272  * @return      none
// 1273  */
// 1274 void ZDSecMgrAppKeyReq( ZDO_RequestKeyInd_t* ind )
// 1275 {
// 1276   APSME_TransportKeyReq_t req;
// 1277   uint8                   initExtAddr[Z_EXTADDR_LEN];
// 1278   uint16                  partNwkAddr;
// 1279   uint8                   key[SEC_KEY_LEN];
// 1280 
// 1281 
// 1282   // validate initiator and partner
// 1283   if ( ( APSME_LookupNwkAddr( ind->partExtAddr, &partNwkAddr ) == TRUE ) &&
// 1284        ( APSME_LookupExtAddr( ind->srcAddr, initExtAddr ) == TRUE      )   )
// 1285   {
// 1286     // point the key to some memory
// 1287     req.key = key;
// 1288 
// 1289     // get an APP key - option APP (MASTER or LINK) key
// 1290     if ( ZDSecMgrAppKeyGet( ind->srcAddr,
// 1291                             initExtAddr,
// 1292                             partNwkAddr,
// 1293                             ind->partExtAddr,
// 1294                             &req.key,
// 1295                             &req.keyType ) == ZSuccess )
// 1296     {
// 1297       // always secure
// 1298       req.nwkSecure = TRUE;
// 1299       req.apsSecure = TRUE;
// 1300       req.tunnel    = NULL;
// 1301 
// 1302       // send key to initiator device
// 1303       req.dstAddr   = ind->srcAddr;
// 1304       req.extAddr   = ind->partExtAddr;
// 1305       req.initiator = TRUE;
// 1306       APSME_TransportKeyReq( &req );
// 1307 
// 1308       // send key to partner device
// 1309       req.dstAddr   = partNwkAddr;
// 1310       req.extAddr   = initExtAddr;
// 1311       req.initiator = FALSE;
// 1312 
// 1313       APSME_TransportKeyReq( &req );
// 1314 
// 1315       // clear copy of key in RAM
// 1316       osal_memset( key, 0x00, SEC_KEY_LEN);
// 1317 
// 1318     }
// 1319   }
// 1320 }
// 1321 
// 1322 /******************************************************************************
// 1323  * @fn          ZDSecMgrEstablishKey
// 1324  *
// 1325  * @brief       Start SKKE with device joining network.
// 1326  *
// 1327  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1328  *
// 1329  * @return      ZStatus_t
// 1330  */
// 1331 ZStatus_t ZDSecMgrEstablishKey( ZDSecMgrDevice_t* device )
// 1332 {
// 1333   ZStatus_t               status;
// 1334   APSME_EstablishKeyReq_t req;
// 1335 
// 1336 
// 1337   req.respExtAddr = device->extAddr;
// 1338   req.method      = APSME_SKKE_METHOD;
// 1339 
// 1340   if ( device->parentAddr == NLME_GetShortAddr() )
// 1341   {
// 1342     req.dstAddr   = device->nwkAddr;
// 1343     //devtag.0604.todo - remove obsolete
// 1344     req.apsSecure = FALSE;
// 1345     req.nwkSecure = FALSE;
// 1346   }
// 1347   else
// 1348   {
// 1349     req.dstAddr   = device->parentAddr;
// 1350     //devtag.0604.todo - remove obsolete
// 1351     req.apsSecure = TRUE;
// 1352     req.nwkSecure = TRUE;
// 1353   }
// 1354 
// 1355   status = APSME_EstablishKeyReq( &req );
// 1356 
// 1357   return status;
// 1358 }
// 1359 
// 1360 /******************************************************************************
// 1361  * @fn          ZDSecMgrSendMasterKey
// 1362  *
// 1363  * @brief       Send MASTER key to device joining network.
// 1364  *
// 1365  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1366  *
// 1367  * @return      ZStatus_t
// 1368  */
// 1369 ZStatus_t ZDSecMgrSendMasterKey( ZDSecMgrDevice_t* device )
// 1370 {
// 1371   ZStatus_t status;
// 1372   APSME_TransportKeyReq_t req;
// 1373   uint16 keyNvId;
// 1374   uint8 masterKey[SEC_KEY_LEN];
// 1375 
// 1376 
// 1377   req.keyType = KEY_TYPE_TC_MASTER;
// 1378   req.extAddr = device->extAddr;
// 1379   req.tunnel  = NULL;
// 1380 
// 1381   if ( ZDSecMgrMasterKeyLookup( device->ctrl->entry->ami, &keyNvId ) == ZSuccess )
// 1382   {
// 1383     osal_nv_read( keyNvId, osal_offsetof(ZDSecMgrMasterKeyData_t, key),
// 1384                   SEC_KEY_LEN, masterKey );
// 1385   }
// 1386   else
// 1387   {
// 1388     // in case read from NV fails
// 1389     osal_memset( masterKey, 0x00, SEC_KEY_LEN);
// 1390   }
// 1391 
// 1392   req.key = masterKey;
// 1393 
// 1394   //check if using secure hop to to parent
// 1395   if ( device->parentAddr != NLME_GetShortAddr() )
// 1396   {
// 1397     //send to parent with security
// 1398     req.dstAddr   = device->parentAddr;
// 1399     req.nwkSecure = TRUE;
// 1400     req.apsSecure = TRUE;
// 1401   }
// 1402   else
// 1403   {
// 1404     //direct with no security
// 1405     req.dstAddr   = device->nwkAddr;
// 1406     req.nwkSecure = FALSE;
// 1407     req.apsSecure = FALSE;
// 1408   }
// 1409 
// 1410   status = APSME_TransportKeyReq( &req );
// 1411 
// 1412   // clear copy of key in RAM
// 1413   osal_memset( masterKey, 0x00, SEC_KEY_LEN);
// 1414 
// 1415   return status;
// 1416 }
// 1417 
// 1418 /******************************************************************************
// 1419  * @fn          ZDSecMgrSendNwkKey
// 1420  *
// 1421  * @brief       Send NWK key to device joining network.
// 1422  *
// 1423  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1424  *
// 1425  * @return      ZStatus_t
// 1426  */
// 1427 ZStatus_t ZDSecMgrSendNwkKey( ZDSecMgrDevice_t* device )
// 1428 {
// 1429   ZStatus_t status;
// 1430   APSME_TransportKeyReq_t req;
// 1431   APSDE_FrameTunnel_t tunnel;
// 1432   nwkKeyDesc tmpKey;
// 1433 
// 1434   req.dstAddr   = device->nwkAddr;
// 1435   req.extAddr   = device->extAddr;
// 1436 
// 1437   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
// 1438   {
// 1439     req.keyType   = KEY_TYPE_NWK_HIGH;
// 1440   }
// 1441   else
// 1442   {
// 1443     req.keyType   = KEY_TYPE_NWK;
// 1444   }
// 1445 
// 1446   // get the Active Key into a local variable
// 1447   if( NLME_ReadNwkKeyInfo( 0, sizeof(tmpKey), &tmpKey,
// 1448                            ZCD_NV_NWK_ACTIVE_KEY_INFO ) != SUCCESS )
// 1449   {
// 1450     // set key data to all 0s if NV read fails
// 1451     osal_memset(&tmpKey, 0x00, sizeof(tmpKey));
// 1452   }
// 1453 
// 1454   if ( (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH)
// 1455       || (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD) )
// 1456   {
// 1457     // set values
// 1458     req.keySeqNum = tmpKey.keySeqNum;
// 1459     req.key       = tmpKey.key;
// 1460 
// 1461     //devtag.pro.security.todo - make sure that if there is no link key the NWK
// 1462     //key isn't used to secure the frame at the APS layer -- since the receiving
// 1463     //device may not have a NWK key yet
// 1464     req.apsSecure = TRUE;
// 1465 
// 1466     // check if using secure hop to to parent
// 1467     if ( device->parentAddr == NLME_GetShortAddr() )
// 1468     {
// 1469       req.nwkSecure = FALSE;
// 1470       req.tunnel    = NULL;
// 1471     }
// 1472     else
// 1473     {
// 1474       req.nwkSecure   = TRUE;
// 1475       req.tunnel      = &tunnel;
// 1476       req.tunnel->tna = device->parentAddr;
// 1477       req.tunnel->dea = device->extAddr;
// 1478     }
// 1479   }
// 1480   else
// 1481   {
// 1482     // default values
// 1483     //devtag.0604.verify
// 1484     req.nwkSecure = TRUE;
// 1485     req.apsSecure = FALSE;
// 1486     req.tunnel    = NULL;
// 1487 
// 1488     if ( device->parentAddr != NLME_GetShortAddr() )
// 1489     {
// 1490       req.dstAddr = device->parentAddr;
// 1491     }
// 1492 
// 1493     // special cases
// 1494     //devtag.0604.todo - modify to preconfig flag
// 1495     if ( device->secure == FALSE )
// 1496     {
// 1497       req.keySeqNum = tmpKey.keySeqNum;
// 1498       req.key       = tmpKey.key;
// 1499 
// 1500       // check if using secure hop to to parent
// 1501       if ( device->parentAddr == NLME_GetShortAddr() )
// 1502       {
// 1503         req.nwkSecure = FALSE;
// 1504       }
// 1505     }
// 1506     else
// 1507     {
// 1508       req.key       = NULL;
// 1509       req.keySeqNum = 0;
// 1510     }
// 1511   }
// 1512 
// 1513   status = APSME_TransportKeyReq( &req );
// 1514 
// 1515   // clear copy of key in RAM before return
// 1516   osal_memset( &tmpKey, 0x00, sizeof(nwkKeyDesc) );
// 1517 
// 1518   return status;
// 1519 }
// 1520 
// 1521 /******************************************************************************
// 1522  * @fn          ZDSecMgrDeviceEntryRemove
// 1523  *
// 1524  * @brief       Remove device entry.
// 1525  *
// 1526  * @param       entry - [in] valid entry
// 1527  *
// 1528  * @return      none
// 1529  */
// 1530 void ZDSecMgrDeviceEntryRemove( ZDSecMgrEntry_t* entry )
// 1531 {
// 1532   // terminate device control
// 1533   if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1534   {
// 1535     ZDSecMgrCtrlTerm( entry );
// 1536   }
// 1537 
// 1538   // remove device from entry data
// 1539   ZDSecMgrEntryFree( entry );
// 1540 
// 1541 }
// 1542 
// 1543 /******************************************************************************
// 1544  * @fn          ZDSecMgrDeviceRemoveByExtAddr
// 1545  *
// 1546  * @brief       Remove device entry by its ext address.
// 1547  *
// 1548  * @param       pAddr - pointer to the extended address
// 1549  *
// 1550  * @return      ZStatus_t
// 1551  */
// 1552 ZStatus_t ZDSecMgrDeviceRemoveByExtAddr( uint8 *pAddr )
// 1553 {
// 1554   ZDSecMgrEntry_t *pEntry;
// 1555   uint8           retValue;
// 1556 
// 1557   retValue = (uint8)ZDSecMgrEntryLookupExt( pAddr, &pEntry );
// 1558 
// 1559   if( retValue == ZSuccess )
// 1560   {
// 1561     ZDSecMgrDeviceEntryRemove( pEntry );
// 1562   }
// 1563 
// 1564   return retValue;
// 1565 }
// 1566 
// 1567 /******************************************************************************
// 1568  * @fn          ZDSecMgrDeviceEntryAdd
// 1569  *
// 1570  * @brief       Add entry.
// 1571  *
// 1572  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1573  * @param       ami    - [in] Address Manager index
// 1574  *
// 1575  * @return      ZStatus_t
// 1576  */
// 1577 void ZDSecMgrAddrMgrUpdate( uint16 ami, uint16 nwkAddr )
// 1578 {
// 1579   AddrMgrEntry_t entry;
// 1580 
// 1581   // get the ami data
// 1582   entry.user  = ADDRMGR_USER_SECURITY;
// 1583   entry.index = ami;
// 1584 
// 1585   AddrMgrEntryGet( &entry );
// 1586 
// 1587   // check if NWK address is same
// 1588   if ( entry.nwkAddr != nwkAddr )
// 1589   {
// 1590     // update NWK address
// 1591     entry.nwkAddr = nwkAddr;
// 1592 
// 1593     AddrMgrEntryUpdate( &entry );
// 1594   }
// 1595 }
// 1596 
// 1597 ZStatus_t ZDSecMgrDeviceEntryAdd( ZDSecMgrDevice_t* device, uint16 ami )
// 1598 {
// 1599   ZStatus_t        status;
// 1600   ZDSecMgrEntry_t* entry;
// 1601 
// 1602   // initialize as unknown until completion
// 1603   status = ZNwkUnknownDevice;
// 1604 
// 1605   device->ctrl = NULL;
// 1606 
// 1607   // make sure not already registered
// 1608   if ( ZDSecMgrEntryLookup( device->nwkAddr, &entry ) == ZSuccess )
// 1609   {
// 1610     // verify that address index is same
// 1611     if ( entry->ami != ami )
// 1612     {
// 1613       // remove conflicting entry
// 1614       ZDSecMgrDeviceEntryRemove( entry );
// 1615 
// 1616       if ( ZDSecMgrEntryLookupAMI( ami, &entry ) == ZSuccess )
// 1617       {
// 1618         // update NWK address
// 1619         ZDSecMgrAddrMgrUpdate( ami, device->nwkAddr );
// 1620       }
// 1621     }
// 1622   }
// 1623   else if ( ZDSecMgrEntryLookupAMI( ami, &entry ) == ZSuccess )
// 1624   {
// 1625     // update NWK address
// 1626     ZDSecMgrAddrMgrUpdate( ami, device->nwkAddr );
// 1627   }
// 1628 
// 1629   // check if a new entry needs to be created
// 1630   if ( entry == NULL )
// 1631   {
// 1632     // get new entry
// 1633     if ( ZDSecMgrEntryNew( &entry ) == ZSuccess )
// 1634     {
// 1635       // reset entry lkd
// 1636 
// 1637       // finish setting up entry
// 1638       entry->ami = ami;
// 1639 
// 1640       // update NWK address
// 1641       ZDSecMgrAddrMgrUpdate( ami, device->nwkAddr );
// 1642 
// 1643       // enter new device into device control
// 1644       if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1645       {
// 1646         status = ZDSecMgrCtrlAdd( device, entry );
// 1647       }
// 1648       else
// 1649       {
// 1650         status = ZSuccess;
// 1651       }
// 1652     }
// 1653   }
// 1654   else
// 1655   {
// 1656     // reset entry lkd
// 1657 
// 1658     // reset entry in entry control
// 1659     if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1660     {
// 1661       status = ZDSecMgrCtrlReset( device, entry );
// 1662     }
// 1663     else
// 1664     {
// 1665       status = ZSuccess;
// 1666     }
// 1667   }
// 1668 
// 1669   return status;
// 1670 }
// 1671 
// 1672 /******************************************************************************
// 1673  * @fn          ZDSecMgrDeviceCtrlHandler
// 1674  *
// 1675  * @brief       Device control handler.
// 1676  *
// 1677  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1678  *
// 1679  * @return      none
// 1680  */
// 1681 void ZDSecMgrDeviceCtrlHandler( ZDSecMgrDevice_t* device )
// 1682 {
// 1683   uint8 state;
// 1684   uint8 cntr;
// 1685 
// 1686   state = device->ctrl->state;
// 1687   cntr  = ZDSECMGR_CTRL_BASE_CNTR;
// 1688 
// 1689   switch ( state )
// 1690   {
// 1691     case ZDSECMGR_CTRL_TK_MASTER:
// 1692       if ( ZDSecMgrSendMasterKey( device ) == ZSuccess )
// 1693       {
// 1694         state = ZDSECMGR_CTRL_SKKE_INIT;
// 1695         cntr  = ZDSECMGR_CTRL_SKKE_INIT_CNTR;
// 1696       }
// 1697       break;
// 1698 
// 1699     case ZDSECMGR_CTRL_SKKE_INIT:
// 1700       if ( ZDSecMgrEstablishKey( device ) == ZSuccess )
// 1701       {
// 1702         state = ZDSECMGR_CTRL_SKKE_WAIT;
// 1703       }
// 1704       break;
// 1705 
// 1706     case ZDSECMGR_CTRL_SKKE_WAIT:
// 1707       // continue to wait for SKA control timeout
// 1708       break;
// 1709 
// 1710     case ZDSECMGR_CTRL_TK_NWK:
// 1711       if ( ZDSecMgrSendNwkKey( device ) == ZSuccess )
// 1712       {
// 1713         state = ZDSECMGR_CTRL_NONE;
// 1714       }
// 1715       break;
// 1716 
// 1717     default:
// 1718       state = ZDSECMGR_CTRL_NONE;
// 1719       break;
// 1720   }
// 1721 
// 1722   if ( state != ZDSECMGR_CTRL_NONE )
// 1723   {
// 1724     device->ctrl->state = state;
// 1725     device->ctrl->cntr  = cntr;
// 1726 
// 1727     osal_start_timerEx(ZDAppTaskID, ZDO_SECMGR_EVENT, 100 );
// 1728   }
// 1729   else
// 1730   {
// 1731     ZDSecMgrCtrlRelease( device->ctrl );
// 1732   }
// 1733 }
// 1734 
// 1735 /******************************************************************************
// 1736  * @fn          ZDSecMgrDeviceCtrlSetup
// 1737  *
// 1738  * @brief       Setup device control.
// 1739  *
// 1740  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1741  *
// 1742  * @return      ZStatus_t
// 1743  */
// 1744 void ZDSecMgrDeviceCtrlSetup( ZDSecMgrDevice_t* device )
// 1745 {
// 1746   if ( device->ctrl != NULL )
// 1747   {
// 1748     if ( device->secure == FALSE )
// 1749     {
// 1750       // send the master key data to the joining device
// 1751       device->ctrl->state = ZDSECMGR_CTRL_TK_MASTER;
// 1752     }
// 1753     else
// 1754     {
// 1755       // start SKKE
// 1756       device->ctrl->state = ZDSECMGR_CTRL_SKKE_INIT;
// 1757     }
// 1758 
// 1759     ZDSecMgrDeviceCtrlHandler( device );
// 1760   }
// 1761 }
// 1762 
// 1763 /******************************************************************************
// 1764  * @fn          ZDSecMgrDeviceCtrlUpdate
// 1765  *
// 1766  * @brief       Update control data.
// 1767  *
// 1768  * @param       extAddr - [in] EXT address
// 1769  * @param       state   - [in] new control state
// 1770  *
// 1771  * @return      none
// 1772  */
// 1773 void ZDSecMgrDeviceCtrlUpdate( uint8* extAddr, uint8 state )
// 1774 {
// 1775   ZDSecMgrEntry_t* entry;
// 1776   ZDSecMgrCtrl_t*  ctrl;
// 1777 
// 1778   // lookup device entry data
// 1779   (void)ZDSecMgrEntryLookupExt( extAddr, &entry );
// 1780 
// 1781   if ( entry != NULL )
// 1782   {
// 1783     // lookup device control data
// 1784     ZDSecMgrCtrlLookup( entry, &ctrl );
// 1785 
// 1786     // make sure control data is valid
// 1787     if ( ctrl != NULL )
// 1788     {
// 1789       // possible state transitions
// 1790       if ( ctrl->state == ZDSECMGR_CTRL_SKKE_WAIT )
// 1791       {
// 1792         if ( state == ZDSECMGR_CTRL_SKKE_DONE )
// 1793         {
// 1794           // send the network key
// 1795           ctrl->state = ZDSECMGR_CTRL_TK_NWK;
// 1796           ctrl->cntr  = ZDSECMGR_CTRL_TK_NWK_CNTR;
// 1797         }
// 1798         else if ( state == ZDSECMGR_CTRL_SKKE_FAIL )
// 1799         {
// 1800           // force default timeout in order to cleanup control logic
// 1801           ctrl->state = ZDSECMGR_CTRL_SKKE_FAIL;
// 1802           ctrl->cntr  = ZDSECMGR_CTRL_BASE_CNTR;
// 1803         }
// 1804       }
// 1805       // timer should be active
// 1806     }
// 1807   }
// 1808 }
// 1809 
// 1810 void APSME_SKA_TimerExpired( uint8 initiator, uint8* partExtAddr );
// 1811 void APSME_SKA_TimerExpired( uint8 initiator, uint8* partExtAddr )
// 1812 {
// 1813   if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 1814   {
// 1815     if ( initiator == TRUE )
// 1816     {
// 1817       ZDSecMgrDeviceCtrlUpdate( partExtAddr, ZDSECMGR_CTRL_SKKE_FAIL );
// 1818     }
// 1819   }
// 1820 }
// 1821 
// 1822 /******************************************************************************
// 1823  * @fn          ZDSecMgrDeviceRemove
// 1824  *
// 1825  * @brief       Remove device from network.
// 1826  *
// 1827  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1828  *
// 1829  * @return      none
// 1830  */
// 1831 void ZDSecMgrDeviceRemove( ZDSecMgrDevice_t* device )
// 1832 {
// 1833   APSME_RemoveDeviceReq_t remDevReq;
// 1834   NLME_LeaveReq_t         leaveReq;
// 1835   associated_devices_t*   assoc;
// 1836 
// 1837   // check if parent, remove the device
// 1838   if ( device->parentAddr == NLME_GetShortAddr() )
// 1839   {
// 1840     // this is the parent of the device
// 1841     leaveReq.extAddr        = device->extAddr;
// 1842     leaveReq.removeChildren = FALSE;
// 1843     leaveReq.rejoin         = FALSE;
// 1844 
// 1845     // find child association
// 1846     assoc = AssocGetWithExt( device->extAddr );
// 1847 
// 1848     if ( ( assoc != NULL                            ) &&
// 1849          ( assoc->nodeRelation >= CHILD_RFD         ) &&
// 1850          ( assoc->nodeRelation <= CHILD_FFD_RX_IDLE )    )
// 1851     {
// 1852       // check if associated device is authenticated
// 1853       if ( assoc->devStatus & DEV_SEC_AUTH_STATUS )
// 1854       {
// 1855         leaveReq.silent = FALSE;
// 1856       }
// 1857       else
// 1858       {
// 1859         leaveReq.silent = TRUE;
// 1860       }
// 1861 
// 1862       NLME_LeaveReq( &leaveReq );
// 1863     }
// 1864   }
// 1865   else
// 1866   {
// 1867     // this is not the parent of the device
// 1868     remDevReq.parentAddr   = device->parentAddr;
// 1869     remDevReq.childExtAddr = device->extAddr;
// 1870 
// 1871     APSME_RemoveDeviceReq( &remDevReq );
// 1872   }
// 1873 }
// 1874 
// 1875 /******************************************************************************
// 1876  * @fn          ZDSecMgrDeviceValidateSKKE
// 1877  *
// 1878  * @brief       Decide whether device is allowed for SKKE.
// 1879  *
// 1880  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1881  *
// 1882  * @return      ZStatus_t
// 1883  */
// 1884 ZStatus_t ZDSecMgrDeviceValidateSKKE( ZDSecMgrDevice_t* device )
// 1885 {
// 1886   ZStatus_t status;
// 1887   uint16 ami;
// 1888   uint16 keyNvId;
// 1889 
// 1890   // get EXT address
// 1891   status = ZDSecMgrExtAddrLookup( device->extAddr, &ami );
// 1892 
// 1893   if ( status == ZSuccess )
// 1894   {
// 1895     // get MASTER key
// 1896     status = ZDSecMgrMasterKeyLookup( ami, &keyNvId );
// 1897 
// 1898     if ( status == ZSuccess )
// 1899     {
// 1900       status = ZDSecMgrDeviceEntryAdd( device, ami );
// 1901     }
// 1902   }
// 1903 
// 1904   return status;
// 1905 }
// 1906 
// 1907 /******************************************************************************
// 1908  * @fn          ZDSecMgrDeviceValidateRM (RESIDENTIAL MODE)
// 1909  *
// 1910  * @brief       Decide whether device is allowed.
// 1911  *
// 1912  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1913  *
// 1914  * @return      ZStatus_t
// 1915  */
// 1916 ZStatus_t ZDSecMgrDeviceValidateRM( ZDSecMgrDevice_t* device )
// 1917 {
// 1918   ZStatus_t status;
// 1919 
// 1920   status = ZSuccess;
// 1921 
// 1922   (void)device;  // Intentionally unreferenced parameter
// 1923 
// 1924   // For test purpose, turning off the zgSecurePermitJoin flag will force
// 1925   // the trust center to reject any newly joining devices by sending
// 1926   // Remove-device to the parents.
// 1927   if ( zgSecurePermitJoin == FALSE )
// 1928   {
// 1929     status = ZNwkUnknownDevice;
// 1930   }
// 1931 
// 1932 
// 1933 
// 1934 #if 0  // Taken out because the following functionality is only used for test
// 1935        // purpose. A more efficient (above) way is used. It can be put
// 1936        // back in if customers request for a white/black list feature.
// 1937        // ZDSecMgrStoredDeviceList[] is defined in ZDSecMgr.c
// 1938 
// 1939   // The following code processes the device black list (stored device list)
// 1940   // If the joining device is not part of the forbidden device list
// 1941   // Return ZSuccess. Otherwise, return ZNwkUnknownDevice. The trust center
// 1942   // will send Remove-device and ban the device from joining.
// 1943 
// 1944   uint8     index;
// 1945   uint8*    restricted;
// 1946 
// 1947   // Look through the stored device list - used for restricted devices
// 1948   for ( index = 0; index < ZDSECMGR_STORED_DEVICES; index++ )
// 1949   {
// 1950     restricted = ZDSecMgrStoredDeviceList[index];
// 1951 
// 1952     if ( AddrMgrExtAddrEqual( restricted, device->extAddr )  == TRUE )
// 1953     {
// 1954       // return as unknown device in regards to validation
// 1955       status = ZNwkUnknownDevice;
// 1956 
// 1957       // break from loop
// 1958       index = ZDSECMGR_STORED_DEVICES;
// 1959     }
// 1960   }
// 1961 
// 1962 #endif
// 1963 
// 1964   return status;
// 1965 }
// 1966 
// 1967 /******************************************************************************
// 1968  * @fn          ZDSecMgrDeviceValidateCM (COMMERCIAL MODE)
// 1969  *
// 1970  * @brief       Decide whether device is allowed.
// 1971  *
// 1972  * @param       device - [in] ZDSecMgrDevice_t, device info
// 1973  *
// 1974  * @return      ZStatus_t
// 1975  */
// 1976 //devtag.pro.security
// 1977 ZStatus_t ZDSecMgrDeviceValidateCM( ZDSecMgrDevice_t* device )
// 1978 {
// 1979   ZStatus_t status;
// 1980   uint16    ami;
// 1981   uint8     key[SEC_KEY_LEN];
// 1982 
// 1983   // implement EXT address and MASTER key policy here -- the total number of
// 1984   // Security Manager entries should never exceed the number of EXT addresses
// 1985   // and MASTER keys available
// 1986 
// 1987   // set status based on policy
// 1988   //status = ZNwkUnknownDevice;
// 1989 
// 1990   // set status based on policy
// 1991   status = ZSuccess; // ZNwkUnknownDevice;
// 1992 
// 1993   // get key based on policy
// 1994   osal_memcpy( key, ZDSecMgrTCMasterKey, SEC_KEY_LEN);
// 1995 
// 1996   // if policy, store new EXT address
// 1997   status = ZDSecMgrAddrStore( device->nwkAddr, device->extAddr, &ami );
// 1998 
// 1999   // set the key
// 2000   ZDSecMgrMasterKeyLoad( device->extAddr, key );
// 2001 
// 2002   // if EXT address and MASTER key available -- add device
// 2003   if ( status == ZSuccess )
// 2004   {
// 2005     // add device to internal data - with control
// 2006     status = ZDSecMgrDeviceEntryAdd( device, ami );
// 2007   }
// 2008 
// 2009   // remove copy of key in RAM
// 2010   osal_memset( key, 0x00, SEC_KEY_LEN );
// 2011 
// 2012   return status;
// 2013 }
// 2014 
// 2015 /******************************************************************************
// 2016  * @fn          ZDSecMgrDeviceValidate
// 2017  *
// 2018  * @brief       Decide whether device is allowed.
// 2019  *
// 2020  * @param       device - [in] ZDSecMgrDevice_t, device info
// 2021  *
// 2022  * @return      ZStatus_t
// 2023  */
// 2024 ZStatus_t ZDSecMgrDeviceValidate( ZDSecMgrDevice_t* device )
// 2025 {
// 2026   ZStatus_t status;
// 2027 
// 2028 
// 2029   if ( ZDSecMgrPermitJoiningEnabled == TRUE )
// 2030   {
// 2031     // device may be joining with a secure flag but it is ultimately the Trust
// 2032     // Center that decides -- check if expected pre configured device --
// 2033     // override settings
// 2034     if ( zgPreConfigKeys == TRUE )
// 2035     {
// 2036       device->secure = TRUE;
// 2037     }
// 2038     else
// 2039     {
// 2040       device->secure = FALSE;
// 2041     }
// 2042 
// 2043     if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
// 2044     {
// 2045       status = ZDSecMgrDeviceValidateCM( device );
// 2046     }
// 2047     else // ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_RESIDENTIAL )
// 2048     {
// 2049       status = ZDSecMgrDeviceValidateRM( device );
// 2050     }
// 2051   }
// 2052   else
// 2053   {
// 2054     status = ZNwkUnknownDevice;
// 2055   }
// 2056 
// 2057   return status;
// 2058 }
// 2059 
// 2060 /******************************************************************************
// 2061  * @fn          ZDSecMgrDeviceJoin
// 2062  *
// 2063  * @brief       Try to join this device.
// 2064  *
// 2065  * @param       device - [in] ZDSecMgrDevice_t, device info
// 2066  *
// 2067  * @return      ZStatus_t
// 2068  */
// 2069 ZStatus_t ZDSecMgrDeviceJoin( ZDSecMgrDevice_t* device )
// 2070 {
// 2071   ZStatus_t status;
// 2072   uint16    ami;
// 2073 
// 2074   // attempt to validate device
// 2075   status = ZDSecMgrDeviceValidate( device );
// 2076 
// 2077   if ( status == ZSuccess )
// 2078   {
// 2079     if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
// 2080     {
// 2081       ZDSecMgrDeviceCtrlSetup( device );
// 2082     }
// 2083     else // ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_RESIDENTIAL )
// 2084     {
// 2085       // Add the device to the address manager
// 2086       ZDSecMgrAddrStore( device->nwkAddr, device->extAddr, &ami );
// 2087       //send the nwk key data to the joining device
// 2088       status = ZDSecMgrSendNwkKey( device );
// 2089     }
// 2090   }
// 2091   else
// 2092   {
// 2093     // not allowed, remove the device
// 2094     ZDSecMgrDeviceRemove( device );
// 2095   }
// 2096 
// 2097   return status;
// 2098 }
// 2099 
// 2100 /******************************************************************************
// 2101  * @fn          ZDSecMgrDeviceJoinDirect
// 2102  *
// 2103  * @brief       Try to join this device as a direct child.
// 2104  *
// 2105  * @param       device - [in] ZDSecMgrDevice_t, device info
// 2106  *
// 2107  * @return      ZStatus_t
// 2108  */
// 2109 ZStatus_t ZDSecMgrDeviceJoinDirect( ZDSecMgrDevice_t* device )
// 2110 {
// 2111   ZStatus_t status;
// 2112 
// 2113   status = ZDSecMgrDeviceJoin( device );
// 2114 
// 2115   if ( status == ZSuccess )
// 2116   {
// 2117     // set association status to authenticated
// 2118     ZDSecMgrAssocDeviceAuth( AssocGetWithShort( device->nwkAddr ) );
// 2119   }
// 2120 
// 2121   return status;
// 2122 }
// 2123 
// 2124 /******************************************************************************
// 2125  * @fn          ZDSecMgrDeviceJoinFwd
// 2126  *
// 2127  * @brief       Forward join to Trust Center.
// 2128  *
// 2129  * @param       device - [in] ZDSecMgrDevice_t, device info
// 2130  *
// 2131  * @return      ZStatus_t
// 2132  */
// 2133 ZStatus_t ZDSecMgrDeviceJoinFwd( ZDSecMgrDevice_t* device )
// 2134 {
// 2135   ZStatus_t               status;
// 2136   APSME_UpdateDeviceReq_t req;
// 2137 
// 2138   // forward any joining device to the Trust Center -- the Trust Center will
// 2139   // decide if the device is allowed to join
// 2140   status = ZSuccess;
// 2141 
// 2142   // forward authorization to the Trust Center
// 2143   req.dstAddr    = APSME_TRUSTCENTER_NWKADDR;
// 2144   req.devAddr    = device->nwkAddr;
// 2145   req.devExtAddr = device->extAddr;
// 2146 
// 2147   // set security status, option for router to reject if policy set
// 2148   if ( (device->devStatus & DEV_HIGH_SEC_STATUS) )
// 2149   {
// 2150     if ( device->devStatus & DEV_REJOIN_STATUS )
// 2151     {
// 2152       if ( device->secure == TRUE )
// 2153       {
// 2154         req.status = APSME_UD_HIGH_SECURED_REJOIN;
// 2155       }
// 2156       else
// 2157       {
// 2158         req.status = APSME_UD_HIGH_UNSECURED_REJOIN;
// 2159       }
// 2160     }
// 2161     else
// 2162     {
// 2163       req.status = APSME_UD_HIGH_UNSECURED_JOIN;
// 2164     }
// 2165   }
// 2166   else
// 2167   {
// 2168     if ( device->devStatus & DEV_REJOIN_STATUS )
// 2169     {
// 2170       if ( device->secure == TRUE )
// 2171       {
// 2172         req.status = APSME_UD_STANDARD_SECURED_REJOIN;
// 2173       }
// 2174       else
// 2175       {
// 2176         req.status = APSME_UD_STANDARD_UNSECURED_REJOIN;
// 2177       }
// 2178     }
// 2179     else
// 2180     {
// 2181       req.status = APSME_UD_STANDARD_UNSECURED_JOIN;
// 2182     }
// 2183   }
// 2184 
// 2185   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
// 2186   {
// 2187     req.apsSecure = TRUE;
// 2188   }
// 2189   else
// 2190   {
// 2191     req.apsSecure = FALSE;
// 2192   }
// 2193 
// 2194   // send and APSME_UPDATE_DEVICE request to the trust center
// 2195   status = APSME_UpdateDeviceReq( &req );
// 2196 
// 2197   return status;
// 2198 }
// 2199 
// 2200 /******************************************************************************
// 2201  * @fn          ZDSecMgrDeviceNew
// 2202  *
// 2203  * @brief       Process a new device.
// 2204  *
// 2205  * @param       device - [in] ZDSecMgrDevice_t, device info
// 2206  *
// 2207  * @return      ZStatus_t
// 2208  */
// 2209 ZStatus_t ZDSecMgrDeviceNew( ZDSecMgrDevice_t* joiner )
// 2210 {
// 2211   ZStatus_t status;
// 2212 
// 2213   if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 2214   {
// 2215     // try to join this device
// 2216     status = ZDSecMgrDeviceJoinDirect( joiner );
// 2217   }
// 2218   else
// 2219   {
// 2220     status = ZDSecMgrDeviceJoinFwd( joiner );
// 2221   }
// 2222 
// 2223   return status;
// 2224 }
// 2225 
// 2226 /******************************************************************************
// 2227  * @fn          ZDSecMgrAssocDeviceAuth
// 2228  *
// 2229  * @brief       Set associated device status to authenticated
// 2230  *
// 2231  * @param       assoc - [in, out] associated_devices_t
// 2232  *
// 2233  * @return      none
// 2234  */
// 2235 void ZDSecMgrAssocDeviceAuth( associated_devices_t* assoc )
// 2236 {
// 2237   if ( assoc != NULL )
// 2238   {
// 2239     assoc->devStatus |= DEV_SEC_AUTH_STATUS;
// 2240   }
// 2241 }
// 2242 
// 2243 /******************************************************************************
// 2244  * @fn          ZDSecMgrAuthInitiate
// 2245  *
// 2246  * @brief       Initiate entity authentication
// 2247  *
// 2248  * @param       responder - [in] responder EXT address
// 2249  *
// 2250  * @return      none
// 2251  */
// 2252 void ZDSecMgrAuthInitiate( uint8* responder )
// 2253 {
// 2254   APSME_AuthenticateReq_t req;
// 2255 
// 2256 
// 2257   // make sure NWK address is available
// 2258   if ( APSME_LookupNwkAddr( responder, &req.nwkAddr ) )
// 2259   {
// 2260     // set request fields
// 2261     req.extAddr   = responder;
// 2262     req.action    = APSME_EA_INITIATE;
// 2263     req.challenge = NULL;
// 2264 
// 2265     // start EA processing
// 2266     APSME_AuthenticateReq( &req );
// 2267   }
// 2268 }
// 2269 
// 2270 /******************************************************************************
// 2271  * @fn          ZDSecMgrAuthNwkKey
// 2272  *
// 2273  * @brief       Handle next step in authentication process
// 2274  *
// 2275  * @param       none
// 2276  *
// 2277  * @return      none
// 2278  */
// 2279 void ZDSecMgrAuthNwkKey()
// 2280 {
// 2281   if ( devState == DEV_END_DEVICE_UNAUTH )
// 2282   {
// 2283     if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
// 2284     {
// 2285       uint8 parent[Z_EXTADDR_LEN];
// 2286 
// 2287       // get parent's EXT address
// 2288       NLME_GetCoordExtAddr( parent );
// 2289 
// 2290       // begin entity authentication with parent
// 2291       ZDSecMgrAuthInitiate( parent );
// 2292     }
// 2293     else
// 2294     {
// 2295       // inform ZDO that device has been authenticated
// 2296       osal_set_event ( ZDAppTaskID, ZDO_DEVICE_AUTH );
// 2297     }
// 2298   }
// 2299 }
// 2300 
// 2301 /******************************************************************************
// 2302  * PUBLIC FUNCTIONS
// 2303  */
// 2304 /******************************************************************************
// 2305  * @fn          ZDSecMgrInit
// 2306  *
// 2307  * @brief       Initialize ZigBee Device Security Manager.
// 2308  *
// 2309  * @param       state - device initialization state
// 2310  *
// 2311  * @return      none
// 2312  */
// 2313 #if ( ADDRMGR_CALLBACK_ENABLED == 1 )
// 2314 void ZDSecMgrAddrMgrCB( uint8 update, AddrMgrEntry_t* newEntry, AddrMgrEntry_t* oldEntry );
// 2315 void ZDSecMgrAddrMgrCB( uint8           update,
// 2316                         AddrMgrEntry_t* newEntry,
// 2317                         AddrMgrEntry_t* oldEntry )
// 2318 {
// 2319   (void)update;
// 2320   (void)newEntry;
// 2321   (void)oldEntry;
// 2322 }
// 2323 #endif // ( ADDRMGR_CALLBACK_ENABLED == 1 )
// 2324 
// 2325 void ZDSecMgrInit(uint8 state)
// 2326 {
// 2327   if ( (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH)
// 2328       || (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD) )
// 2329   {
// 2330     // initialize sub modules
// 2331     ZDSecMgrEntryInit(state);
// 2332 
// 2333     if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 2334     {
// 2335       ZDSecMgrCtrlInit();
// 2336     }
// 2337 
// 2338     // register with Address Manager
// 2339 #if ( ADDRMGR_CALLBACK_ENABLED == 1 )
// 2340     AddrMgrRegister( ADDRMGR_REG_SECURITY, ZDSecMgrAddrMgrCB );
// 2341 #endif
// 2342   }
// 2343 
// 2344   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
// 2345   {
// 2346     // configure SKA slot data
// 2347     APSME_SKA_SlotInit( ZDSECMGR_SKA_SLOT_MAX );
// 2348   }
// 2349 
// 2350   if ( ZG_SECURE_ENABLED )
// 2351   {
// 2352     if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 2353     {
// 2354       // setup joining permissions
// 2355       ZDSecMgrPermitJoiningEnabled = TRUE;
// 2356       ZDSecMgrPermitJoiningTimed   = FALSE;
// 2357     }
// 2358   }
// 2359 
// 2360   // configure security based on security mode and type of device
// 2361   ZDSecMgrConfig();
// 2362 }
// 2363 
// 2364 /******************************************************************************
// 2365  * @fn          ZDSecMgrConfig
// 2366  *
// 2367  * @brief       Configure ZigBee Device Security Manager.
// 2368  *
// 2369  * @param       none
// 2370  *
// 2371  * @return      none
// 2372  */
// 2373 void ZDSecMgrConfig( void )
// 2374 {
// 2375   if ( ZG_SECURE_ENABLED )
// 2376   {
// 2377     SSP_Init();
// 2378 
// 2379     if ( (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH)
// 2380         || (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD) )
// 2381     {
// 2382       if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 2383       {
// 2384         // COMMERCIAL MODE - COORDINATOR DEVICE
// 2385         APSME_SecurityCM_CD();
// 2386       }
// 2387       else if ( ZSTACK_ROUTER_BUILD )
// 2388       {
// 2389         // COMMERCIAL MODE - ROUTER DEVICE
// 2390         APSME_SecurityCM_RD();
// 2391       }
// 2392       else
// 2393       {
// 2394         // COMMERCIAL MODE - END DEVICE
// 2395         APSME_SecurityCM_ED();
// 2396       }
// 2397     }
// 2398     else // ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_RESIDENTIAL )
// 2399     {
// 2400       if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 2401       {
// 2402         // RESIDENTIAL MODE - COORDINATOR DEVICE
// 2403         APSME_SecurityRM_CD();
// 2404       }
// 2405       else if ( ZSTACK_ROUTER_BUILD )
// 2406       {
// 2407         // RESIDENTIAL MODE - ROUTER DEVICE
// 2408         APSME_SecurityRM_RD();
// 2409       }
// 2410       else
// 2411       {
// 2412         // RESIDENTIAL MODE - END DEVICE
// 2413         APSME_SecurityRM_ED();
// 2414       }
// 2415     }
// 2416   }
// 2417   else
// 2418   {
// 2419     // NO SECURITY
// 2420     APSME_SecurityNM();
// 2421   }
// 2422 }
// 2423 
// 2424 /******************************************************************************
// 2425  * @fn          ZDSecMgrPermitJoining
// 2426  *
// 2427  * @brief       Process request to change joining permissions.
// 2428  *
// 2429  * @param       duration - [in] timed duration for join in seconds
// 2430  *                         - 0x00 not allowed
// 2431  *                         - 0xFF allowed without timeout
// 2432  *
// 2433  * @return      uint8 - success(TRUE:FALSE)
// 2434  */
// 2435 uint8 ZDSecMgrPermitJoining( uint8 duration )
// 2436 {
// 2437   uint8 accept;
// 2438 
// 2439   ZDSecMgrPermitJoiningTimed = FALSE;
// 2440 
// 2441   if ( duration > 0 )
// 2442   {
// 2443     ZDSecMgrPermitJoiningEnabled = TRUE;
// 2444 
// 2445     if ( duration != 0xFF )
// 2446     {
// 2447       ZDSecMgrPermitJoiningTimed = TRUE;
// 2448     }
// 2449   }
// 2450   else
// 2451   {
// 2452     ZDSecMgrPermitJoiningEnabled = FALSE;
// 2453   }
// 2454 
// 2455   accept = TRUE;
// 2456 
// 2457   return accept;
// 2458 }
// 2459 
// 2460 /******************************************************************************
// 2461  * @fn          ZDSecMgrPermitJoiningTimeout
// 2462  *
// 2463  * @brief       Process permit joining timeout
// 2464  *
// 2465  * @param       none
// 2466  *
// 2467  * @return      none
// 2468  */
// 2469 void ZDSecMgrPermitJoiningTimeout( void )
// 2470 {
// 2471   if ( ZDSecMgrPermitJoiningTimed == TRUE )
// 2472   {
// 2473     ZDSecMgrPermitJoiningEnabled = FALSE;
// 2474     ZDSecMgrPermitJoiningTimed   = FALSE;
// 2475   }
// 2476 }
// 2477 
// 2478 /******************************************************************************
// 2479  * @fn          ZDSecMgrNewDeviceEvent
// 2480  *
// 2481  * @brief       Process a the new device event, if found reset new device
// 2482  *              event/timer.
// 2483  *
// 2484  * @param       none
// 2485  *
// 2486  * @return      uint8 - found(TRUE:FALSE)
// 2487  */

        RSEG CODE:CODE:NOROOT(1)
?Subroutine3:
          CFI Block cfiBlock1 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+36
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
// 2488 uint8 ZDSecMgrNewDeviceEvent( void )
// 2489 {
// 2490   uint8                 found;
// 2491   ZDSecMgrDevice_t      device;
// 2492   AddrMgrEntry_t        addrEntry;
// 2493   associated_devices_t* assoc;
// 2494   ZStatus_t             status;
// 2495 
// 2496   // initialize return results
// 2497   found = FALSE;
// 2498 
// 2499   // look for device in the security init state
// 2500   assoc = AssocMatchDeviceStatus( DEV_SEC_INIT_STATUS );
// 2501 
// 2502   if ( assoc != NULL )
// 2503   {
// 2504     // device found
// 2505     found = TRUE;
// 2506 
// 2507     // check for preconfigured security
// 2508     if ( zgPreConfigKeys == TRUE )
// 2509     {
// 2510       // set association status to authenticated
// 2511       ZDSecMgrAssocDeviceAuth( assoc );
// 2512     }
// 2513 
// 2514     // set up device info
// 2515     addrEntry.user  = ADDRMGR_USER_DEFAULT;
// 2516     addrEntry.index = assoc->addrIdx;
// 2517     AddrMgrEntryGet( &addrEntry );
// 2518 
// 2519     device.nwkAddr    = assoc->shortAddr;
// 2520     device.extAddr    = addrEntry.extAddr;
// 2521     device.parentAddr = NLME_GetShortAddr();
// 2522     device.secure     = FALSE;
// 2523     device.devStatus  = assoc->devStatus;
// 2524 
// 2525     // process new device
// 2526     status = ZDSecMgrDeviceNew( &device );
// 2527 
// 2528     if ( status == ZSuccess )
// 2529     {
// 2530       assoc->devStatus &= ~DEV_SEC_INIT_STATUS;
// 2531     }
// 2532     else if ( status == ZNwkUnknownDevice )
// 2533     {
// 2534       AssocRemove( addrEntry.extAddr );
// 2535     }
// 2536   }
// 2537 
// 2538   return found;
// 2539 }
// 2540 
// 2541 /******************************************************************************
// 2542  * @fn          ZDSecMgrEvent
// 2543  *
// 2544  * @brief       Handle ZDO Security Manager event/timer(ZDO_SECMGR_EVENT).
// 2545  *
// 2546  * @param       none
// 2547  *
// 2548  * @return      none
// 2549  */
// 2550 void ZDSecMgrEvent( void )
// 2551 {
// 2552   uint8            action;
// 2553   uint8            restart;
// 2554   uint16           index;
// 2555   AddrMgrEntry_t   entry;
// 2556   ZDSecMgrDevice_t device;
// 2557 
// 2558   // verify data is available
// 2559   if ( ZDSecMgrCtrlData != NULL )
// 2560   {
// 2561     action  = FALSE;
// 2562     restart = FALSE;
// 2563 
// 2564     // update all the counters
// 2565     for ( index = 0; index < ZDSECMGR_ENTRY_MAX; index++ )
// 2566     {
// 2567       if ( ZDSecMgrCtrlData[index].state !=  ZDSECMGR_CTRL_NONE )
// 2568       {
// 2569         if ( ZDSecMgrCtrlData[index].cntr != 0 )
// 2570         {
// 2571           ZDSecMgrCtrlData[index].cntr--;
// 2572         }
// 2573 
// 2574         if ( ( action == FALSE ) && ( ZDSecMgrCtrlData[index].cntr == 0 ) )
// 2575         {
// 2576           action = TRUE;
// 2577 
// 2578           // update from control data
// 2579           device.parentAddr = ZDSecMgrCtrlData[index].parentAddr;
// 2580           device.secure     = ZDSecMgrCtrlData[index].secure;
// 2581           device.ctrl       = &ZDSecMgrCtrlData[index];
// 2582 
// 2583           // set the user and address index
// 2584           entry.user  = ADDRMGR_USER_SECURITY;
// 2585           entry.index = ZDSecMgrCtrlData[index].entry->ami;
// 2586 
// 2587           // get the address data
// 2588           AddrMgrEntryGet( &entry );
// 2589 
// 2590           // set device address data
// 2591           device.nwkAddr = entry.nwkAddr;
// 2592           device.extAddr = entry.extAddr;
// 2593 
// 2594           // update from entry data
// 2595           ZDSecMgrDeviceCtrlHandler( &device );
// 2596         }
// 2597         else
// 2598         {
// 2599           restart = TRUE;
// 2600         }
// 2601       }
// 2602     }
// 2603 
// 2604     // check for timer restart
// 2605     if ( restart == TRUE )
// 2606     {
// 2607       osal_start_timerEx(ZDAppTaskID, ZDO_SECMGR_EVENT, 100 );
// 2608     }
// 2609   }
// 2610 }
        ADD.W   #0x18, SP
          CFI CFA SP+12
        POPM.W  #0x4, R11
          CFI CFA SP+4
          CFI R8L SameValue
          CFI R9L SameValue
          CFI R10L SameValue
          CFI R11L SameValue
        RETA
          CFI EndBlock cfiBlock1

        RSEG CODE:CODE:NOROOT(1)
?Subroutine29:
          CFI Block cfiCond2 Using cfiCommon0
          CFI Function ZDSecMgrApsLinkKeyInit
          CFI Conditional ??CrossCallReturnLabel_49
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+40
          CFI Block cfiCond3 Using cfiCommon0
          CFI (cfiCond3) Function ZDSecMgrMasterKeyInit
          CFI (cfiCond3) Conditional ??CrossCallReturnLabel_50
          CFI (cfiCond3) R8L Frame(CFA, -12)
          CFI (cfiCond3) R9L Frame(CFA, -10)
          CFI (cfiCond3) R10L Frame(CFA, -8)
          CFI (cfiCond3) R11L Frame(CFA, -6)
          CFI (cfiCond3) CFA SP+34
          CFI Block cfiPicker4 Using cfiCommon1
          CFI (cfiPicker4) NoFunction
          CFI (cfiPicker4) Picker
        MOV.W   R8, R12
          CFI EndBlock cfiCond2
          CFI EndBlock cfiCond3
          CFI EndBlock cfiPicker4
        REQUIRE ??Subroutine29_0
        // Fall through to label ??Subroutine29_0

        RSEG CODE:CODE:NOROOT(1)
??Subroutine29_0:
          CFI Block cfiCond5 Using cfiCommon0
          CFI Function ZDSecMgrNwkKeyInit
          CFI Conditional ??CrossCallReturnLabel_51
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+52
          CFI Block cfiCond6 Using cfiCommon0
          CFI (cfiCond6) Function ZDSecMgrNwkKeyInit
          CFI (cfiCond6) Conditional ??CrossCallReturnLabel_52
          CFI (cfiCond6) R10L Frame(CFA, -8)
          CFI (cfiCond6) R11L Frame(CFA, -6)
          CFI (cfiCond6) CFA SP+52
          CFI Block cfiCond7 Using cfiCommon0
          CFI (cfiCond7) Function ZDSecMgrNwkKeyInit
          CFI (cfiCond7) Conditional ??CrossCallReturnLabel_53
          CFI (cfiCond7) R10L Frame(CFA, -8)
          CFI (cfiCond7) R11L Frame(CFA, -6)
          CFI (cfiCond7) CFA SP+52
          CFI Block cfiCond8 Using cfiCommon0
          CFI (cfiCond8) Function APSME_TCLinkKeyInit
          CFI (cfiCond8) Conditional ??CrossCallReturnLabel_54
          CFI (cfiCond8) R10L Frame(CFA, -6)
          CFI (cfiCond8) CFA SP+42
          CFI Block cfiCond9 Using cfiCommon0
          CFI (cfiCond9) Function ZDSecMgrApsLinkKeyInit
          CFI (cfiCond9) Conditional ??CrossCallReturnLabel_49
          CFI (cfiCond9) R8L Frame(CFA, -12)
          CFI (cfiCond9) R9L Frame(CFA, -10)
          CFI (cfiCond9) R10L Frame(CFA, -8)
          CFI (cfiCond9) R11L Frame(CFA, -6)
          CFI (cfiCond9) CFA SP+40
          CFI Block cfiCond10 Using cfiCommon0
          CFI (cfiCond10) Function ZDSecMgrMasterKeyInit
          CFI (cfiCond10) Conditional ??CrossCallReturnLabel_50
          CFI (cfiCond10) R8L Frame(CFA, -12)
          CFI (cfiCond10) R9L Frame(CFA, -10)
          CFI (cfiCond10) R10L Frame(CFA, -8)
          CFI (cfiCond10) R11L Frame(CFA, -6)
          CFI (cfiCond10) CFA SP+34
          CFI Block cfiPicker11 Using cfiCommon1
          CFI (cfiPicker11) NoFunction
          CFI (cfiPicker11) Picker
// 2611 
// 2612 /******************************************************************************
// 2613  * @fn          ZDSecMgrEstablishKeyCfm
// 2614  *
// 2615  * @brief       Process the ZDO_EstablishKeyCfm_t message.
// 2616  *
// 2617  * @param       cfm - [in] ZDO_EstablishKeyCfm_t confirmation
// 2618  *
// 2619  * @return      none
// 2620  */
// 2621 void ZDSecMgrEstablishKeyCfm( ZDO_EstablishKeyCfm_t* cfm )
// 2622 {
// 2623   // send the NWK key
// 2624   if ( ( ZG_BUILD_COORDINATOR_TYPE ) && ( ZG_DEVICE_COORDINATOR_TYPE ) )
// 2625   {
// 2626     // update control for specified EXT address
// 2627     ZDSecMgrDeviceCtrlUpdate( cfm->partExtAddr, ZDSECMGR_CTRL_SKKE_DONE );
// 2628   }
// 2629   else
// 2630   {
// 2631     // this should be done when receiving the NWK key
// 2632     // if devState ==
// 2633     //if ( devState == DEV_END_DEVICE_UNAUTH )
// 2634         //osal_set_event( ZDAppTaskID, ZDO_DEVICE_AUTH );
// 2635 
// 2636     // if not in joining state -- this should trigger an event for an
// 2637     // end point that requested SKKE
// 2638     // if ( devState == DEV_END_DEVICE )
// 2639    //       devState == DEV_ROUTER;
// 2640 
// 2641   }
// 2642 }
// 2643 
// 2644 /******************************************************************************
// 2645  * @fn          ZDSecMgrTCExtAddrCheck
// 2646  *
// 2647  * @brief       Verifies if received ext. address matches TC ext. address.
// 2648  *
// 2649  * @param       extAddr - Extended address to be verified.
// 2650  *
// 2651  * @return      TRUE - extended address matches
// 2652  *              FALSE - otherwise
// 2653  */
// 2654 uint8 ZDSecMgrTCExtAddrCheck( uint8* extAddr )
// 2655 {
// 2656   uint8  match;
// 2657   uint8  lookup[Z_EXTADDR_LEN];
// 2658 
// 2659   match = FALSE;
// 2660 
// 2661   if ( AddrMgrExtAddrLookup( APSME_TRUSTCENTER_NWKADDR, lookup ) )
// 2662   {
// 2663     match = AddrMgrExtAddrEqual( lookup, extAddr );
// 2664   }
// 2665 
// 2666   return match;
// 2667 }
// 2668 
// 2669 /******************************************************************************
// 2670  * @fn          ZDSecMgrTCDataLoad
// 2671  *
// 2672  * @brief       Stores the address of TC into address manager and stores the
// 2673  *              preconfigured ZDSecMgrTCMasterKey to NV if zgPreConfigKeys
// 2674  *              is set to TRUE.
// 2675  *
// 2676  * @param       extAddr - Extended address to be verified.
// 2677  *
// 2678  * @return      none
// 2679  */
// 2680 void ZDSecMgrTCDataLoad( uint8* extAddr )
// 2681 {
// 2682   uint16 ami;
// 2683   uint16 keyNvId;
// 2684   uint8 masterKey[SEC_KEY_LEN];
// 2685   AddrMgrEntry_t entry;
// 2686 
// 2687   // lookup using TC short address
// 2688   entry.user    = ADDRMGR_USER_DEFAULT;
// 2689   entry.nwkAddr = zgTrustCenterAddr;
// 2690 
// 2691   // Verify if TC address has been added to Address Manager
// 2692   if ( AddrMgrEntryLookupNwk( &entry ) != TRUE )
// 2693   {
// 2694     if ( ZDSecMgrAddrStore( zgTrustCenterAddr, extAddr, &ami ) == ZSuccess )
// 2695     {
// 2696       // if preconfigured load key
// 2697       if ( zgPreConfigKeys == TRUE )
// 2698       {
// 2699         if ( ZDSecMgrMasterKeyLookup( ami, &keyNvId ) != ZSuccess )
// 2700         {
// 2701           // temporary copy
// 2702           osal_memcpy( masterKey, ZDSecMgrTCMasterKey, SEC_KEY_LEN);
// 2703 
// 2704           ZDSecMgrMasterKeyStore( ami, masterKey );
// 2705 
// 2706           // remove copy of key in RAM
// 2707           osal_memset( masterKey, 0x00, SEC_KEY_LEN );
// 2708         }
// 2709       }
// 2710     }
// 2711   }
// 2712 }
// 2713 
// 2714 /******************************************************************************
// 2715  * @fn          ZDSecMgrEstablishKeyInd
// 2716  *
// 2717  * @brief       Process the ZDO_EstablishKeyInd_t message.
// 2718  *
// 2719  * @param       ind - [in] ZDO_EstablishKeyInd_t indication
// 2720  *
// 2721  * @return      none
// 2722  */
// 2723 void ZDSecMgrEstablishKeyInd( ZDO_EstablishKeyInd_t* ind )
// 2724 {
// 2725   ZDSecMgrDevice_t        device;
// 2726   APSME_EstablishKeyRsp_t rsp;
// 2727 
// 2728 
// 2729   // load Trust Center data if needed
// 2730   ZDSecMgrTCDataLoad( ind->initExtAddr );
// 2731 
// 2732   if ( ZDSecMgrTCExtAddrCheck( ind->initExtAddr ) )
// 2733   {
// 2734     //IF (ind->srcAddr == APSME_TRUSTCENTER_NWKADDR)
// 2735     //OR
// 2736     //!ZDSecMgrTCAuthenticated
// 2737     //devtag.0604.critical
// 2738         //how is the parentAddr used here
// 2739 
// 2740     // initial SKKE from Trust Center via parent
// 2741     device.nwkAddr    = APSME_TRUSTCENTER_NWKADDR;
// 2742     device.parentAddr = ind->srcAddr;
// 2743   }
// 2744   else
// 2745   {
// 2746     // Trust Center direct or E2E SKKE
// 2747     device.nwkAddr    = ind->srcAddr;
// 2748     device.parentAddr = INVALID_NODE_ADDR;
// 2749   }
// 2750 
// 2751   device.extAddr = ind->initExtAddr;
// 2752   //devtag.pro.security.0724.todo - verify usage
// 2753   device.secure  = ind->nwkSecure;
// 2754 
// 2755   // validate device for SKKE
// 2756   if ( ZDSecMgrDeviceValidateSKKE( &device ) == ZSuccess )
// 2757   {
// 2758     rsp.accept = TRUE;
// 2759   }
// 2760   else
// 2761   {
// 2762     rsp.accept = FALSE;
// 2763   }
// 2764 
// 2765   rsp.dstAddr     = ind->srcAddr;
// 2766   rsp.initExtAddr = &ind->initExtAddr[0];
// 2767   //devtag.0604.todo - remove obsolete
// 2768   rsp.apsSecure   = ind->apsSecure;
// 2769   rsp.nwkSecure   = ind->nwkSecure;
// 2770 
// 2771   APSME_EstablishKeyRsp( &rsp );
// 2772 }
// 2773 
// 2774 //devtag.pro.security
// 2775 #if 0
// 2776 void ZDSecMgrEstablishKeyInd( ZDO_EstablishKeyInd_t* ind )
// 2777 {
// 2778   ZDSecMgrDevice_t        device;
// 2779   APSME_EstablishKeyRsp_t rsp;
// 2780 
// 2781 
// 2782   device.extAddr = ind->initExtAddr;
// 2783   device.secure  = ind->secure;
// 2784 
// 2785   if ( ind->secure == FALSE )
// 2786   {
// 2787     // SKKE from Trust Center is not secured between child and parent
// 2788     device.nwkAddr    = APSME_TRUSTCENTER_NWKADDR;
// 2789     device.parentAddr = ind->srcAddr;
// 2790   }
// 2791   else
// 2792   {
// 2793     // SKKE from initiator should be secured
// 2794     device.nwkAddr    = ind->srcAddr;
// 2795     device.parentAddr = INVALID_NODE_ADDR;
// 2796   }
// 2797 
// 2798   rsp.dstAddr     = ind->srcAddr;
// 2799   rsp.initExtAddr = &ind->initExtAddr[0];
// 2800   rsp.secure      = ind->secure;
// 2801 
// 2802   // validate device for SKKE
// 2803   if ( ZDSecMgrDeviceValidateSKKE( &device ) == ZSuccess )
// 2804   {
// 2805     rsp.accept = TRUE;
// 2806   }
// 2807   else
// 2808   {
// 2809     rsp.accept = FALSE;
// 2810   }
// 2811 
// 2812   APSME_EstablishKeyRsp( &rsp );
// 2813 }
// 2814 #endif
// 2815 
// 2816 /******************************************************************************
// 2817  * @fn          ZDSecMgrTransportKeyInd
// 2818  *
// 2819  * @brief       Process the ZDO_TransportKeyInd_t message.
// 2820  *
// 2821  * @param       ind - [in] ZDO_TransportKeyInd_t indication
// 2822  *
// 2823  * @return      none
// 2824  */
// 2825 void ZDSecMgrTransportKeyInd( ZDO_TransportKeyInd_t* ind )
// 2826 {
// 2827   uint8 index;
// 2828   uint8 zgPreConfigKey[SEC_KEY_LEN];
// 2829 
// 2830   // load Trust Center data if needed
// 2831   ZDSecMgrTCDataLoad( ind->srcExtAddr );
// 2832 
// 2833   if ( ind->keyType == KEY_TYPE_TC_MASTER )
// 2834   {
// 2835     if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
// 2836     //ZDSecMgrTCMasterKey( ind );
// 2837     {
// 2838       if ( zgPreConfigKeys != TRUE )
// 2839       {
// 2840         // devtag.pro.security.todo - check if Trust Center address is configured and correct
// 2841         ZDSecMgrMasterKeyLoad( ind->srcExtAddr, ind->key );
// 2842       }
// 2843       else
// 2844       {
// 2845         // error condition - reject key
// 2846       }
// 2847     }
// 2848   }
// 2849   else if ( ( ind->keyType == KEY_TYPE_NWK      ) ||
// 2850             ( ind->keyType == 6                 ) ||
// 2851             ( ind->keyType == KEY_TYPE_NWK_HIGH )    )
// 2852   {
// 2853     // check for dummy NWK key (all zeros)
// 2854     for ( index = 0;
// 2855           ( (index < SEC_KEY_LEN) && (ind->key[index] == 0) );
// 2856           index++ );
// 2857 
// 2858     if ( index == SEC_KEY_LEN )
// 2859     {
// 2860       // load preconfigured key - once!!
// 2861       if ( !_NIB.nwkKeyLoaded )
// 2862       {
// 2863         ZDSecMgrReadKeyFromNv(ZCD_NV_PRECFGKEY, zgPreConfigKey);
// 2864         SSP_UpdateNwkKey( zgPreConfigKey, 0 );
// 2865         SSP_SwitchNwkKey( 0 );
// 2866 
// 2867         // clear local copy of key
// 2868         osal_memset(zgPreConfigKey, 0x00, SEC_KEY_LEN);
// 2869       }
// 2870     }
// 2871     else
// 2872     {
// 2873       SSP_UpdateNwkKey( ind->key, ind->keySeqNum );
// 2874       if ( !_NIB.nwkKeyLoaded )
// 2875       {
// 2876         SSP_SwitchNwkKey( ind->keySeqNum );
// 2877       }
// 2878     }
// 2879 
// 2880     // handle next step in authentication process
// 2881     ZDSecMgrAuthNwkKey();
// 2882   }
// 2883   else if ( ind->keyType == KEY_TYPE_TC_LINK )
// 2884   {
// 2885     if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
// 2886     {
// 2887       // This should not happen because TCLK should not be Tx
// 2888     }
// 2889   }
// 2890   else if ( ind->keyType == KEY_TYPE_APP_MASTER )
// 2891   {
// 2892     if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
// 2893     {
// 2894       uint16           ami;
// 2895       AddrMgrEntry_t   entry;
// 2896       ZDSecMgrEntry_t* entryZD;
// 2897 
// 2898       ZDSecMgrExtAddrLookup( ind->srcExtAddr, &ami );
// 2899 
// 2900       if ( ind->initiator == TRUE )
// 2901       {
// 2902         // get the ami data
// 2903         entry.user  = ADDRMGR_USER_SECURITY;
// 2904         entry.index = ami;
// 2905         AddrMgrEntryGet( &entry );
// 2906 
// 2907         if ( entry.nwkAddr != INVALID_NODE_ADDR )
// 2908         {
// 2909           APSME_EstablishKeyReq_t req;
// 2910           ZDSecMgrMasterKeyLoad( ind->srcExtAddr, ind->key );
// 2911 
// 2912           ZDSecMgrEntryLookupAMI( ami, &entryZD );
// 2913 
// 2914           if ( entryZD == NULL )
// 2915           {
// 2916             // get new entry
// 2917             if ( ZDSecMgrEntryNew( &entryZD ) == ZSuccess )
// 2918             {
// 2919               // finish setting up entry
// 2920               entryZD->ami = ami;
// 2921             }
// 2922           }
// 2923 
// 2924           req.respExtAddr = ind->srcExtAddr;
// 2925           req.method      = APSME_SKKE_METHOD;
// 2926           req.dstAddr     = entry.nwkAddr;
// 2927           req.apsSecure   = FALSE;
// 2928           req.nwkSecure   = TRUE;
// 2929           APSME_EstablishKeyReq( &req );
// 2930         }
// 2931       }
// 2932       else
// 2933       {
// 2934         if ( ami == INVALID_NODE_ADDR )
// 2935         {
// 2936           // store new EXT address
// 2937           ZDSecMgrAddrStore( INVALID_NODE_ADDR, ind->srcExtAddr, &ami );
// 2938         }
// 2939 
// 2940         ZDSecMgrMasterKeyLoad( ind->srcExtAddr, ind->key );
// 2941       }
// 2942     }
// 2943   }
// 2944   else if ( ind->keyType == KEY_TYPE_APP_LINK )
// 2945   {
// 2946     if ( ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH ) ||
// 2947          ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD ) )
// 2948     {
// 2949       uint16           ami;
// 2950       ZDSecMgrEntry_t* entry;
// 2951 
// 2952       // get the address index
// 2953       if ( ZDSecMgrExtAddrLookup( ind->srcExtAddr, &ami ) != ZSuccess )
// 2954       {
// 2955         // store new EXT address
// 2956         ZDSecMgrAddrStore( INVALID_NODE_ADDR, ind->srcExtAddr, &ami );
// 2957         ZDP_NwkAddrReq( ind->srcExtAddr, ZDP_ADDR_REQTYPE_SINGLE, 0, 0 );
// 2958       }
// 2959 
// 2960       ZDSecMgrEntryLookupAMI( ami, &entry );
// 2961 
// 2962       if ( entry == NULL )
// 2963       {
// 2964         // get new entry
// 2965         if ( ZDSecMgrEntryNew( &entry ) == ZSuccess )
// 2966         {
// 2967           // finish setting up entry
// 2968           entry->ami = ami;
// 2969         }
// 2970       }
// 2971 
// 2972       ZDSecMgrLinkKeySet( ind->srcExtAddr, ind->key );
// 2973 
// 2974 #if defined NV_RESTORE
// 2975       ZDSecMgrWriteNV();  // Write the control record for the new established link key to NV.
// 2976 #endif
// 2977     }
// 2978   }
// 2979 }
// 2980 
// 2981 /******************************************************************************
// 2982  * @fn          ZDSecMgrUpdateDeviceInd
// 2983  *
// 2984  * @brief       Process the ZDO_UpdateDeviceInd_t message.
// 2985  *
// 2986  * @param       ind - [in] ZDO_UpdateDeviceInd_t indication
// 2987  *
// 2988  * @return      none
// 2989  */
// 2990 void ZDSecMgrUpdateDeviceInd( ZDO_UpdateDeviceInd_t* ind )
// 2991 {
// 2992   ZDSecMgrDevice_t device;
// 2993 
// 2994   device.nwkAddr    = ind->devAddr;
// 2995   device.extAddr    = ind->devExtAddr;
// 2996   device.parentAddr = ind->srcAddr;
// 2997 
// 2998   //if ( ( ind->status == APSME_UD_SECURED_JOIN   ) ||
// 2999   //     ( ind->status == APSME_UD_UNSECURED_JOIN )   )
// 3000   //{
// 3001   //  if ( ind->status == APSME_UD_SECURED_JOIN )
// 3002   //  {
// 3003   //    device.secure = TRUE;
// 3004   //  }
// 3005   //  else
// 3006   //  {
// 3007   //    device.secure = FALSE;
// 3008   //  }
// 3009 
// 3010     // try to join this device
// 3011     ZDSecMgrDeviceJoin( &device );
// 3012   //}
// 3013 }
// 3014 
// 3015 /******************************************************************************
// 3016  * @fn          ZDSecMgrRemoveDeviceInd
// 3017  *
// 3018  * @brief       Process the ZDO_RemoveDeviceInd_t message.
// 3019  *
// 3020  * @param       ind - [in] ZDO_RemoveDeviceInd_t indication
// 3021  *
// 3022  * @return      none
// 3023  */
// 3024 void ZDSecMgrRemoveDeviceInd( ZDO_RemoveDeviceInd_t* ind )
// 3025 {
// 3026   ZDSecMgrDevice_t device;
// 3027 
// 3028   // only accept from Trust Center
// 3029   if ( ind->srcAddr == APSME_TRUSTCENTER_NWKADDR )
// 3030   {
// 3031     // look up NWK address
// 3032     if ( APSME_LookupNwkAddr( ind->childExtAddr, &device.nwkAddr ) == TRUE )
// 3033     {
// 3034       device.parentAddr = NLME_GetShortAddr();
// 3035       device.extAddr    = ind->childExtAddr;
// 3036 
// 3037       // remove device
// 3038       ZDSecMgrDeviceRemove( &device );
// 3039     }
// 3040   }
// 3041 }
// 3042 
// 3043 /******************************************************************************
// 3044  * @fn          ZDSecMgrRequestKeyInd
// 3045  *
// 3046  * @brief       Process the ZDO_RequestKeyInd_t message.
// 3047  *
// 3048  * @param       ind - [in] ZDO_RequestKeyInd_t indication
// 3049  *
// 3050  * @return      none
// 3051  */
// 3052 void ZDSecMgrRequestKeyInd( ZDO_RequestKeyInd_t* ind )
// 3053 {
// 3054   if ( ind->keyType == KEY_TYPE_NWK )
// 3055   {
// 3056   }
// 3057   else if ( ind->keyType == KEY_TYPE_APP_MASTER )
// 3058   {
// 3059     ZDSecMgrAppKeyReq( ind );
// 3060   }
// 3061   else if ( ind->keyType == KEY_TYPE_TC_LINK )
// 3062   {
// 3063   }
// 3064   //else ignore
// 3065 }
// 3066 
// 3067 /******************************************************************************
// 3068  * @fn          ZDSecMgrSwitchKeyInd
// 3069  *
// 3070  * @brief       Process the ZDO_SwitchKeyInd_t message.
// 3071  *
// 3072  * @param       ind - [in] ZDO_SwitchKeyInd_t indication
// 3073  *
// 3074  * @return      none
// 3075  */
// 3076 void ZDSecMgrSwitchKeyInd( ZDO_SwitchKeyInd_t* ind )
// 3077 {
// 3078   SSP_SwitchNwkKey( ind->keySeqNum );
// 3079 
// 3080   // Save if nv
// 3081   ZDApp_NVUpdate();
// 3082 }
// 3083 
// 3084 /******************************************************************************
// 3085  * @fn          ZDSecMgrAuthenticateInd
// 3086  *
// 3087  * @brief       Process the ZDO_AuthenticateInd_t message.
// 3088  *
// 3089  * @param       ind - [in] ZDO_AuthenticateInd_t indication
// 3090  *
// 3091  * @return      none
// 3092  */
// 3093 void ZDSecMgrAuthenticateInd( ZDO_AuthenticateInd_t* ind )
// 3094 {
// 3095   APSME_AuthenticateReq_t req;
// 3096   AddrMgrEntry_t          entry;
// 3097 
// 3098   // update the address manager
// 3099   //---------------------------------------------------------------------------
// 3100   // note:
// 3101   // required for EA processing, but ultimately EA logic could also use the
// 3102   // neighbor table to look up addresses -- also(IF using EA) the neighbor
// 3103   // table is supposed to have authentication states for neighbors
// 3104   //---------------------------------------------------------------------------
// 3105   entry.user    = ADDRMGR_USER_SECURITY;
// 3106   entry.nwkAddr = ind->aps.initNwkAddr;
// 3107   AddrMgrExtAddrSet( entry.extAddr, ind->aps.initExtAddr );
// 3108 
// 3109   if ( AddrMgrEntryUpdate( &entry ) == TRUE )
// 3110   {
// 3111     // set request fields
// 3112     req.nwkAddr   = ind->aps.initNwkAddr;
// 3113     req.extAddr   = ind->aps.initExtAddr;
// 3114     req.action    = APSME_EA_ACCEPT;
// 3115     req.challenge = ind->aps.challenge;
// 3116 
// 3117     // start EA processing
// 3118     APSME_AuthenticateReq( &req );
// 3119   }
// 3120 }
// 3121 
// 3122 /******************************************************************************
// 3123  * @fn          ZDSecMgrAuthenticateCfm
// 3124  *
// 3125  * @brief       Process the ZDO_AuthenticateCfm_t message.
// 3126  *
// 3127  * @param       cfm - [in] ZDO_AuthenticateCfm_t confirmation
// 3128  *
// 3129  * @return      none
// 3130  */
// 3131 void ZDSecMgrAuthenticateCfm( ZDO_AuthenticateCfm_t* cfm )
// 3132 {
// 3133   if ( cfm->aps.status == ZSuccess )
// 3134   {
// 3135     if ( ( cfm->aps.initiator == TRUE ) && ( devState == DEV_END_DEVICE_UNAUTH ) )
// 3136     {
// 3137       // inform ZDO that device has been authenticated
// 3138       osal_set_event ( ZDAppTaskID, ZDO_DEVICE_AUTH );
// 3139     }
// 3140   }
// 3141 }
// 3142 
// 3143 #if ( ZG_BUILD_COORDINATOR_TYPE )
// 3144 /******************************************************************************
// 3145  * @fn          ZDSecMgrUpdateNwkKey
// 3146  *
// 3147  * @brief       Load a new NWK key and trigger a network wide update.
// 3148  *
// 3149  * @param       key       - [in] new NWK key
// 3150  * @param       keySeqNum - [in] new NWK key sequence number
// 3151  *
// 3152  * @return      ZStatus_t
// 3153  */
// 3154 ZStatus_t ZDSecMgrUpdateNwkKey( uint8* key, uint8 keySeqNum, uint16 dstAddr )
// 3155 {
// 3156   ZStatus_t               status;
// 3157   APSME_TransportKeyReq_t req;
// 3158 
// 3159   // initialize common elements of local variables
// 3160   if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
// 3161   {
// 3162     req.keyType   = KEY_TYPE_NWK_HIGH;
// 3163   }
// 3164   else
// 3165   {
// 3166     req.keyType   = KEY_TYPE_NWK;
// 3167   }
// 3168 
// 3169   req.dstAddr   = dstAddr;
// 3170   req.keySeqNum = keySeqNum;
// 3171   req.key       = key;
// 3172   req.extAddr   = NULL;
// 3173   req.nwkSecure = TRUE;
// 3174   req.apsSecure = TRUE;
// 3175   req.tunnel    = NULL;
// 3176 
// 3177   if (( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH ) ||
// 3178       ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD ))
// 3179   {
// 3180     ZDSecMgrEntry_t*        entry;
// 3181     uint16                  index;
// 3182     AddrMgrEntry_t          addrEntry;
// 3183 
// 3184     addrEntry.user = ADDRMGR_USER_SECURITY;
// 3185 
// 3186     status = ZFailure;
// 3187 
// 3188     // verify data is available
// 3189     if ( ZDSecMgrEntries != NULL )
// 3190     {
// 3191       // find available entry
// 3192       for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
// 3193       {
// 3194         if ( ZDSecMgrEntries[index].ami != INVALID_NODE_ADDR )
// 3195         {
// 3196           // return successful result
// 3197           entry = &ZDSecMgrEntries[index];
// 3198 
// 3199           // get NWK address
// 3200           addrEntry.index = entry->ami;
// 3201           if ( AddrMgrEntryGet( &addrEntry ) == TRUE )
// 3202           {
// 3203             req.dstAddr = addrEntry.nwkAddr;
// 3204             req.extAddr = addrEntry.extAddr;
// 3205             status = APSME_TransportKeyReq( &req );
// 3206           }
// 3207         }
// 3208       }
// 3209     }
// 3210   }
// 3211   else // ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_RESIDENTIAL )
// 3212   {
// 3213     status = APSME_TransportKeyReq( &req );
// 3214   }
// 3215 
// 3216   SSP_UpdateNwkKey( key, keySeqNum );
// 3217 
// 3218   // Save if nv
// 3219   ZDApp_NVUpdate();
// 3220 
// 3221   return status;
// 3222 }
// 3223 #endif // ( ZG_BUILD_COORDINATOR_TYPE )
// 3224 
// 3225 #if ( ZG_BUILD_COORDINATOR_TYPE )
// 3226 /******************************************************************************
// 3227  * @fn          ZDSecMgrSwitchNwkKey
// 3228  *
// 3229  * @brief       Causes the NWK key to switch via a network wide command.
// 3230  *
// 3231  * @param       keySeqNum - [in] new NWK key sequence number
// 3232  *
// 3233  * @return      ZStatus_t
// 3234  */
// 3235 ZStatus_t ZDSecMgrSwitchNwkKey( uint8 keySeqNum, uint16 dstAddr )
// 3236 {
// 3237   ZStatus_t            status;
// 3238   APSME_SwitchKeyReq_t req;
// 3239 
// 3240   // initialize common elements of local variables
// 3241   req.dstAddr = dstAddr;
// 3242   req.keySeqNum = keySeqNum;
// 3243 
// 3244   if (( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH ) ||
// 3245       ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD ))
// 3246   {
// 3247     ZDSecMgrEntry_t*     entry;
// 3248     uint16               index;
// 3249     AddrMgrEntry_t       addrEntry;
// 3250 
// 3251     addrEntry.user = ADDRMGR_USER_SECURITY;
// 3252 
// 3253     status = ZFailure;
// 3254 
// 3255     // verify data is available
// 3256     if ( ZDSecMgrEntries != NULL )
// 3257     {
// 3258       // find available entry
// 3259       for ( index = 0; index < ZDSECMGR_ENTRY_MAX ; index++ )
// 3260       {
// 3261         if ( ZDSecMgrEntries[index].ami != INVALID_NODE_ADDR )
// 3262         {
// 3263           // return successful result
// 3264           entry = &ZDSecMgrEntries[index];
// 3265 
// 3266           // get NWK address
// 3267           addrEntry.index = entry->ami;
// 3268 
// 3269           if ( AddrMgrEntryGet( &addrEntry ) == TRUE )
// 3270           {
// 3271             req.dstAddr = addrEntry.nwkAddr;
// 3272             status = APSME_SwitchKeyReq( &req );
// 3273           }
// 3274         }
// 3275       }
// 3276     }
// 3277   }
// 3278   else // ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_RESIDENTIAL )
// 3279   {
// 3280     status = APSME_SwitchKeyReq( &req );
// 3281   }
// 3282 
// 3283   SSP_SwitchNwkKey( keySeqNum );
// 3284 
// 3285   // Save if nv
// 3286   ZDApp_NVUpdate();
// 3287 
// 3288   return status;
// 3289 }
// 3290 #endif // ( ZG_BUILD_COORDINATOR_TYPE )
// 3291 
// 3292 /******************************************************************************
// 3293  * @fn          ZDSecMgrRequestAppKey
// 3294  *
// 3295  * @brief       Request an application key with partner.
// 3296  *
// 3297  * @param       partExtAddr - [in] partner extended address
// 3298  *
// 3299  * @return      ZStatus_t
// 3300  */
// 3301 ZStatus_t ZDSecMgrRequestAppKey( uint8 *partExtAddr )
// 3302 {
// 3303   ZStatus_t status;
// 3304   APSME_RequestKeyReq_t req;
// 3305 
// 3306   req.dstAddr = 0;
// 3307   req.keyType = KEY_TYPE_APP_MASTER;
// 3308 
// 3309   req.partExtAddr = partExtAddr;
// 3310   status = APSME_RequestKeyReq( &req );
// 3311 
// 3312   return status;
// 3313 }
// 3314 
// 3315 #if ( ZG_BUILD_JOINING_TYPE )
// 3316 /******************************************************************************
// 3317  * @fn          ZDSecMgrSetupPartner
// 3318  *
// 3319  * @brief       Setup for application key partner.
// 3320  *
// 3321  * @param       partNwkAddr - [in] partner network address
// 3322  *
// 3323  * @return      ZStatus_t
// 3324  */
// 3325 ZStatus_t ZDSecMgrSetupPartner( uint16 partNwkAddr, uint8* partExtAddr )
// 3326 {
// 3327   AddrMgrEntry_t entry;
// 3328   ZStatus_t      status;
// 3329 
// 3330   status = ZFailure;
// 3331 
// 3332   // update the address manager
// 3333   entry.user    = ADDRMGR_USER_SECURITY;
// 3334   entry.nwkAddr = partNwkAddr;
// 3335   AddrMgrExtAddrSet( entry.extAddr, partExtAddr );
// 3336 
// 3337   if ( AddrMgrEntryUpdate( &entry ) == TRUE )
// 3338   {
// 3339     status = ZSuccess;
// 3340 
// 3341     // check for address discovery
// 3342     if ( partNwkAddr == INVALID_NODE_ADDR )
// 3343     {
// 3344       status = ZDP_NwkAddrReq( partExtAddr, ZDP_ADDR_REQTYPE_SINGLE, 0, 0 );
// 3345     }
// 3346     else if ( !AddrMgrExtAddrValid( partExtAddr ) )
// 3347     {
// 3348       status = ZDP_IEEEAddrReq( partNwkAddr, ZDP_ADDR_REQTYPE_SINGLE, 0, 0 );
// 3349     }
// 3350   }
// 3351 
// 3352   return status;
// 3353 }
// 3354 #endif // ( ZG_BUILD_JOINING_TYPE )
// 3355 
// 3356 #if ( ZG_BUILD_COORDINATOR_TYPE )
// 3357 /******************************************************************************
// 3358  * @fn          ZDSecMgrAppKeyTypeSet
// 3359  *
// 3360  * @brief       Set application key type.
// 3361  *
// 3362  * @param       keyType - [in] application key type (KEY_TYPE_APP_MASTER@2 or
// 3363  *                                                   KEY_TYPE_APP_LINK@3
// 3364  *
// 3365  * @return      ZStatus_t
// 3366  */
// 3367 ZStatus_t ZDSecMgrAppKeyTypeSet( uint8 keyType )
// 3368 {
// 3369   if ( keyType == KEY_TYPE_APP_LINK )
// 3370   {
// 3371     ZDSecMgrAppKeyType = KEY_TYPE_APP_LINK;
// 3372   }
// 3373   else
// 3374   {
// 3375     ZDSecMgrAppKeyType = KEY_TYPE_APP_MASTER;
// 3376   }
// 3377 
// 3378   return ZSuccess;
// 3379 }
// 3380 #endif
// 3381 
// 3382 /******************************************************************************
// 3383  * ZigBee Device Security Manager - Stub Implementations
// 3384  */
// 3385 /******************************************************************************
// 3386  * @fn          ZDSecMgrMasterKeyGet (stubs APSME_MasterKeyGet)
// 3387  *
// 3388  * @brief       Get MASTER key for specified EXT address.
// 3389  *
// 3390  * @param       extAddr - [in] EXT address
// 3391  * @param       pKeyNvId - [out] MASTER key NV ID
// 3392  *
// 3393  * @return      ZStatus_t
// 3394  */
// 3395 ZStatus_t ZDSecMgrMasterKeyGet( uint8* extAddr, uint16* pKeyNvId )
// 3396 {
// 3397   ZStatus_t status;
// 3398   uint16 ami;
// 3399 
// 3400   // lookup entry for specified EXT address
// 3401   status = ZDSecMgrExtAddrLookup( extAddr, &ami );
// 3402 
// 3403   if ( status == ZSuccess )
// 3404   {
// 3405     ZDSecMgrMasterKeyLookup( ami, pKeyNvId );
// 3406   }
// 3407   else
// 3408   {
// 3409     *pKeyNvId = SEC_NO_KEY_NV_ID;
// 3410   }
// 3411 
// 3412   return status;
// 3413 }
// 3414 
// 3415 /******************************************************************************
// 3416  * @fn          ZDSecMgrLinkKeySet (stubs APSME_LinkKeySet)
// 3417  *
// 3418  * @brief       Set <APSME_LinkKeyData_t> for specified NWK address.
// 3419  *
// 3420  * @param       extAddr - [in] EXT address
// 3421  * @param       data    - [in] APSME_LinkKeyData_t
// 3422  *
// 3423  * @return      ZStatus_t
// 3424  */
// 3425 ZStatus_t ZDSecMgrLinkKeySet( uint8* extAddr, uint8* key )
// 3426 {
// 3427   ZStatus_t status;
// 3428   ZDSecMgrEntry_t* entry;
// 3429   APSME_LinkKeyData_t *pApsLinkKey = NULL;
// 3430   uint16 Index;
// 3431 
// 3432   // lookup entry index for specified EXT address
// 3433   status = ZDSecMgrEntryLookupExtGetIndex( extAddr, &entry, &Index );
// 3434 
// 3435   if ( status == ZSuccess )
// 3436   {
// 3437     // point to NV item
// 3438     entry->keyNvId = ZCD_NV_APS_LINK_KEY_DATA_START + Index;
// 3439 
// 3440     pApsLinkKey = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
// 3441 
// 3442     if (pApsLinkKey != NULL)
// 3443     {
// 3444       // read the key form NV, keyNvId must be ZCD_NV_APS_LINK_KEY_DATA_START based
// 3445       osal_nv_read( entry->keyNvId, 0,
// 3446                    sizeof(APSME_LinkKeyData_t), pApsLinkKey );
// 3447 
// 3448       // set new values of the key
// 3449       osal_memcpy( pApsLinkKey->key, key, SEC_KEY_LEN );
// 3450       pApsLinkKey->rxFrmCntr = 0;
// 3451       pApsLinkKey->txFrmCntr = 0;
// 3452 
// 3453       osal_nv_write( entry->keyNvId, 0,
// 3454                     sizeof(APSME_LinkKeyData_t), pApsLinkKey );
// 3455 
// 3456       // clear copy of key in RAM
// 3457       osal_memset(pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t));
// 3458 
// 3459       osal_mem_free(pApsLinkKey);
// 3460 
// 3461       // set initial values for counters in RAM
// 3462       ApsLinkKeyFrmCntr[entry->keyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].txFrmCntr = 0;
// 3463       ApsLinkKeyFrmCntr[entry->keyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].rxFrmCntr = 0;
// 3464     }
// 3465   }
// 3466 
// 3467   return status;
// 3468 }
// 3469 
// 3470 /******************************************************************************
// 3471  * @fn          ZDSecMgrAuthenticationSet
// 3472  *
// 3473  * @brief       Mark the specific device as authenticated or not
// 3474  *
// 3475  * @param       extAddr - [in] EXT address
// 3476  * @param       option  - [in] authenticated or not
// 3477  *
// 3478  * @return      ZStatus_t
// 3479  */
// 3480 ZStatus_t ZDSecMgrAuthenticationSet( uint8* extAddr, ZDSecMgr_Authentication_Option option )
// 3481 {
// 3482   ZStatus_t        status;
// 3483   ZDSecMgrEntry_t* entry;
// 3484 
// 3485 
// 3486   // lookup entry index for specified EXT address
// 3487   status = ZDSecMgrEntryLookupExt( extAddr, &entry );
// 3488 
// 3489   if ( status == ZSuccess )
// 3490   {
// 3491     entry->authenticateOption = option;
// 3492   }
// 3493 
// 3494   return status;
// 3495 }
// 3496 
// 3497 /******************************************************************************
// 3498  * @fn          ZDSecMgrAuthenticationCheck
// 3499  *
// 3500  * @brief       Check if the specific device has been authenticated or not
// 3501  *              For non-trust center device, always return TRUE
// 3502  *
// 3503  * @param       shortAddr - [in] short address
// 3504  *
// 3505  * @return      TRUE @ authenticated with CBKE
// 3506  *              FALSE @ not authenticated
// 3507  */
// 3508 
// 3509 uint8 ZDSecMgrAuthenticationCheck( uint16 shortAddr )
// 3510 {
// 3511 #if defined (TC_LINKKEY_JOIN)
// 3512 
// 3513   ZDSecMgrEntry_t* entry;
// 3514   uint8 extAddr[Z_EXTADDR_LEN];
// 3515 
// 3516   // If the local device is not the trust center, always return TRUE
// 3517   if ( NLME_GetShortAddr() != zgTrustCenterAddr )
// 3518   {
// 3519     return TRUE;
// 3520   }
// 3521   // Otherwise, check the authentication option
// 3522   else if ( AddrMgrExtAddrLookup( shortAddr, extAddr ) )
// 3523   {
// 3524     // lookup entry index for specified EXT address
// 3525     if ( ZDSecMgrEntryLookupExt( extAddr, &entry ) == ZSuccess )
// 3526     {
// 3527       if ( entry->authenticateOption != ZDSecMgr_Not_Authenticated )
// 3528       {
// 3529         return TRUE;
// 3530       }
// 3531       else
// 3532       {
// 3533         return FALSE;
// 3534       }
// 3535     }
// 3536   }
// 3537   return FALSE;
// 3538 
// 3539 #else
// 3540   (void)shortAddr;  // Intentionally unreferenced parameter
// 3541 
// 3542   // For non AMI/SE Profile, perform no check and always return TRUE.
// 3543   return TRUE;
// 3544 
// 3545 #endif // TC_LINKKEY_JOIN
// 3546 }
// 3547 
// 3548 /******************************************************************************
// 3549  * @fn          ZDSecMgrLinkKeyNVIdGet (stubs APSME_LinkKeyNVIdGet)
// 3550  *
// 3551  * @brief       Get Key NV ID for specified NWK address.
// 3552  *
// 3553  * @param       extAddr - [in] EXT address
// 3554  * @param       keyNvId - [out] NV ID
// 3555  *
// 3556  * @return      ZStatus_t
// 3557  */
// 3558 ZStatus_t ZDSecMgrLinkKeyNVIdGet(uint8* extAddr, uint16 *pKeyNvId)
// 3559 {
// 3560   ZStatus_t status;
// 3561   ZDSecMgrEntry_t* entry;
// 3562 
// 3563   // lookup entry index for specified NWK address
// 3564   status = ZDSecMgrEntryLookupExt( extAddr, &entry );
// 3565 
// 3566   if ( status == ZSuccess )
// 3567   {
// 3568     // return the index to the NV table
// 3569     *pKeyNvId = entry->keyNvId;
// 3570   }
// 3571   else
// 3572   {
// 3573     *pKeyNvId = SEC_NO_KEY_NV_ID;
// 3574   }
// 3575 
// 3576   return status;
// 3577 }
// 3578 
// 3579 /******************************************************************************
// 3580  * @fn          ZDSecMgrIsLinkKeyValid (stubs APSME_IsLinkKeyValid)
// 3581  *
// 3582  * @brief       Verifies if Link Key in NV has been set.
// 3583  *
// 3584  * @param       extAddr - [in] EXT address
// 3585  *
// 3586  * @return      TRUE - Link Key has been established
// 3587  *              FALSE - Link Key in NV has default value.
// 3588  */
// 3589 uint8 ZDSecMgrIsLinkKeyValid(uint8* extAddr)
// 3590 {
// 3591   APSME_LinkKeyData_t *pKeyData;
// 3592   uint16 apsLinkKeyNvId;
// 3593   uint8 nullKey[SEC_KEY_LEN];
// 3594   uint8 status = FALSE;
// 3595 
// 3596   // initialize default vealue to compare to
// 3597   osal_memset(nullKey, 0x00, SEC_KEY_LEN);
// 3598 
// 3599   // check for APS link NV ID
// 3600   APSME_LinkKeyNVIdGet( extAddr, &apsLinkKeyNvId );
// 3601 
// 3602   if (apsLinkKeyNvId != SEC_NO_KEY_NV_ID )
// 3603   {
// 3604     pKeyData = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
// 3605 
// 3606     if (pKeyData != NULL)
// 3607     {
// 3608       // retrieve key from NV
// 3609       if ( osal_nv_read( apsLinkKeyNvId, 0,
// 3610                         sizeof(APSME_LinkKeyData_t), pKeyData) == ZSUCCESS)
// 3611       {
// 3612         // if stored key is different than default value, then a key has been established
// 3613         if (!osal_memcmp(pKeyData, nullKey, SEC_KEY_LEN))
// 3614         {
// 3615           status = TRUE;
// 3616         }
// 3617       }
// 3618 
// 3619       // clear copy of key in RAM
// 3620       osal_memset(pKeyData, 0x00, sizeof(APSME_LinkKeyData_t));
// 3621 
// 3622       osal_mem_free(pKeyData);
// 3623     }
// 3624   }
// 3625 
// 3626   return status;
// 3627 }
// 3628 
// 3629 /******************************************************************************
// 3630  * @fn          ZDSecMgrKeyFwdToChild (stubs APSME_KeyFwdToChild)
// 3631  *
// 3632  * @brief       Verify and process key transportation to child.
// 3633  *
// 3634  * @param       ind - [in] APSME_TransportKeyInd_t
// 3635  *
// 3636  * @return      uint8 - success(TRUE:FALSE)
// 3637  */
// 3638 uint8 ZDSecMgrKeyFwdToChild( APSME_TransportKeyInd_t* ind )
// 3639 {
// 3640   // verify from Trust Center
// 3641   if ( ind->srcAddr == APSME_TRUSTCENTER_NWKADDR )
// 3642   {
// 3643     // check for initial NWK key
// 3644     if ( ( ind->keyType == KEY_TYPE_NWK      ) ||
// 3645          ( ind->keyType == 6                 ) ||
// 3646          ( ind->keyType == KEY_TYPE_NWK_HIGH )    )
// 3647     {
// 3648       // set association status to authenticated
// 3649       ZDSecMgrAssocDeviceAuth( AssocGetWithExt( ind->dstExtAddr ) );
// 3650     }
// 3651 
// 3652     return TRUE;
// 3653   }
// 3654 
// 3655   return FALSE;
// 3656 }
// 3657 
// 3658 /******************************************************************************
// 3659  * @fn          ZDSecMgrAddLinkKey
// 3660  *
// 3661  * @brief       Add the application link key to ZDSecMgr. Also mark the device
// 3662  *              as authenticated in the authenticateOption. Note that this function
// 3663  *              is hardwared to CBKE right now.
// 3664  *
// 3665  * @param       shortAddr - short address of the partner device
// 3666  * @param       extAddr - extended address of the partner device
// 3667  * @param       key - link key
// 3668  *
// 3669  * @return      ZStatus_t
// 3670  */
// 3671 ZStatus_t ZDSecMgrAddLinkKey( uint16 shortAddr, uint8 *extAddr, uint8 *key)
// 3672 {
// 3673   uint16           ami;
// 3674   ZDSecMgrEntry_t* entry;
// 3675 
// 3676   /* Store the device address in the addr manager */
// 3677   if( ZDSecMgrAddrStore( shortAddr, extAddr, &ami ) != ZSuccess )
// 3678   {
// 3679     /* Adding to Addr Manager fails */
// 3680     return ZFailure;
// 3681   }
// 3682 
// 3683   /* Lookup entry using specified address index */
// 3684   ZDSecMgrEntryLookupAMI( ami, &entry );
// 3685 
// 3686   // If no existing entry, create one
// 3687   if ( entry == NULL )
// 3688   {
// 3689     if ( ZDSecMgrEntryNew( &entry ) == ZSuccess )
// 3690     {
// 3691       entry->ami = ami;
// 3692     }
// 3693     else
// 3694     {
// 3695       /* Security Manager full */
// 3696       return ZBufferFull;
// 3697     }
// 3698   }
// 3699   // Write the link key
// 3700   APSME_LinkKeySet( extAddr, key );
// 3701 
// 3702 #if defined (TC_LINKKEY_JOIN)
// 3703   // Mark the device as authenticated.
// 3704   ZDSecMgrAuthenticationSet( extAddr, ZDSecMgr_Authenticated_CBCK );
// 3705 #endif
// 3706 
// 3707 #if defined NV_RESTORE
// 3708   ZDSecMgrWriteNV();  // Write the new established link key to NV.
// 3709 #endif
// 3710 
// 3711   return ZSuccess;
// 3712 }
// 3713 
// 3714 #if defined ( NV_RESTORE )
// 3715 /******************************************************************************
// 3716  * @fn          ZDSecMgrInitNV
// 3717  *
// 3718  * @brief       Initialize the SecMgr entry data in NV with all values set to 0
// 3719  *
// 3720  * @param       none
// 3721  *
// 3722  * @return      uint8 - <osal_nv_item_init> return codes
// 3723  */
// 3724 uint8 ZDSecMgrInitNV(void)
// 3725 {
// 3726 
// 3727   uint8 rtrn = osal_nv_item_init(ZCD_NV_APS_LINK_KEY_TABLE,
// 3728                 (sizeof(nvDeviceListHdr_t) + (sizeof(ZDSecMgrEntry_t) * ZDSECMGR_ENTRY_MAX)), NULL);
// 3729 
// 3730   // If the item does not already exist, set all values to 0
// 3731   if (rtrn != SUCCESS)
// 3732   {
// 3733     nvDeviceListHdr_t hdr;
// 3734     hdr.numRecs = 0;
// 3735     osal_nv_write(ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof(nvDeviceListHdr_t), &hdr);
// 3736   }
// 3737 
// 3738   return rtrn;
// 3739 }
// 3740 #endif // NV_RESTORE
// 3741 
// 3742 #if defined ( NV_RESTORE )
// 3743 /*********************************************************************
// 3744  * @fn      ZDSecMgrWriteNV()
// 3745  *
// 3746  * @brief   Save off the APS link key list to NV
// 3747  *
// 3748  * @param   none
// 3749  *
// 3750  * @return  none
// 3751  */
// 3752 static void ZDSecMgrWriteNV( void )
// 3753 {
// 3754   uint16 i;
// 3755   nvDeviceListHdr_t hdr;
// 3756 
// 3757   hdr.numRecs = 0;
// 3758 
// 3759   if (ZDSecMgrEntries != NULL)
// 3760   {
// 3761     for ( i = 0; i < ZDSECMGR_ENTRY_MAX; i++ )
// 3762     {
// 3763       // Save off the record
// 3764       osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE,
// 3765                     (uint16)((sizeof(nvDeviceListHdr_t)) + (i * sizeof(ZDSecMgrEntry_t))),
// 3766                     sizeof(ZDSecMgrEntry_t), &ZDSecMgrEntries[i] );
// 3767 
// 3768       if ( ZDSecMgrEntries[i].ami != INVALID_NODE_ADDR )
// 3769       {
// 3770         hdr.numRecs++;
// 3771       }
// 3772     }
// 3773   }
// 3774 
// 3775   // Save off the header
// 3776   osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof( nvDeviceListHdr_t ), &hdr );
// 3777 }
// 3778 #endif // NV_RESTORE
// 3779 
// 3780 #if defined ( NV_RESTORE )
// 3781 /******************************************************************************
// 3782  * @fn          ZDSecMgrRestoreFromNV
// 3783  *
// 3784  * @brief       Restore the APS Link Key entry data from NV. It does not restore
// 3785  *              the key data itself as they remain in NV until they are used.
// 3786  *              Only list data is restored.
// 3787  *
// 3788  * @param       none
// 3789  *
// 3790  * @return      None.
// 3791  */
// 3792 static void ZDSecMgrRestoreFromNV( void )
// 3793 {
// 3794   nvDeviceListHdr_t hdr;
// 3795   APSME_LinkKeyData_t *pApsLinkKey = NULL;
// 3796 
// 3797   if ((osal_nv_read(ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof(nvDeviceListHdr_t), &hdr) == ZSUCCESS) &&
// 3798       ((hdr.numRecs > 0) && (hdr.numRecs <= ZDSECMGR_ENTRY_MAX)))
// 3799   {
// 3800     uint8 x;
// 3801 
// 3802     pApsLinkKey = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
// 3803 
// 3804     for (x = 0; x < ZDSECMGR_ENTRY_MAX; x++)
// 3805     {
// 3806       if ( osal_nv_read( ZCD_NV_APS_LINK_KEY_TABLE,
// 3807                         (uint16)(sizeof(nvDeviceListHdr_t) + (x * sizeof(ZDSecMgrEntry_t))),
// 3808                         sizeof(ZDSecMgrEntry_t), &ZDSecMgrEntries[x] ) == SUCCESS )
// 3809       {
// 3810         // update data only for valid entries
// 3811         if ( ZDSecMgrEntries[x].ami != INVALID_NODE_ADDR )
// 3812         {
// 3813           if (pApsLinkKey != NULL)
// 3814           {
// 3815             // read the key form NV, keyNvId must be ZCD_NV_APS_LINK_KEY_DATA_START based
// 3816             osal_nv_read( ZDSecMgrEntries[x].keyNvId, 0,
// 3817                          sizeof(APSME_LinkKeyData_t), pApsLinkKey );
// 3818 
// 3819             // set new values for the counter
// 3820             pApsLinkKey->txFrmCntr += ( MAX_APS_FRAMECOUNTER_CHANGES + 1 );
// 3821 
// 3822             // restore values for counters in RAM
// 3823             ApsLinkKeyFrmCntr[ZDSecMgrEntries[x].keyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].txFrmCntr =
// 3824                                             pApsLinkKey->txFrmCntr;
// 3825 
// 3826             ApsLinkKeyFrmCntr[ZDSecMgrEntries[x].keyNvId - ZCD_NV_APS_LINK_KEY_DATA_START].rxFrmCntr =
// 3827                                             pApsLinkKey->rxFrmCntr;
// 3828 
// 3829             osal_nv_write( ZDSecMgrEntries[x].keyNvId, 0,
// 3830                           sizeof(APSME_LinkKeyData_t), pApsLinkKey );
// 3831 
// 3832             // clear copy of key in RAM
// 3833             osal_memset(pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t));
// 3834           }
// 3835         }
// 3836       }
// 3837     }
// 3838 
// 3839     if (pApsLinkKey != NULL)
// 3840     {
// 3841       osal_mem_free(pApsLinkKey);
// 3842     }
// 3843   }
// 3844 }
// 3845 #endif // NV_RESTORE
// 3846 
// 3847 /*********************************************************************
// 3848  * @fn          ZDSecMgrSetDefaultNV
// 3849  *
// 3850  * @brief       Write the defaults to NV for Entry table and for APS key data table
// 3851  *
// 3852  * @param       none
// 3853  *
// 3854  * @return      none
// 3855  */
// 3856 void ZDSecMgrSetDefaultNV( void )
// 3857 {
// 3858   uint16 i;
// 3859   nvDeviceListHdr_t hdr;
// 3860   ZDSecMgrEntry_t secMgrEntry;
// 3861   APSME_LinkKeyData_t *pApsLinkKey = NULL;
// 3862 
// 3863   // Initialize the header
// 3864   hdr.numRecs = 0;
// 3865 
// 3866   // clear the header
// 3867   osal_nv_write(ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof(nvDeviceListHdr_t), &hdr);
// 3868 
// 3869   osal_memset( &secMgrEntry, 0x00, sizeof(ZDSecMgrEntry_t) );
// 3870 
// 3871   for ( i = 0; i < ZDSECMGR_ENTRY_MAX; i++ )
// 3872   {
// 3873     // Clear the record
// 3874     osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE,
// 3875                 (uint16)((sizeof(nvDeviceListHdr_t)) + (i * sizeof(ZDSecMgrEntry_t))),
// 3876                         sizeof(ZDSecMgrEntry_t), &secMgrEntry );
// 3877   }
// 3878 
// 3879   pApsLinkKey = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
// 3880 
// 3881   if (pApsLinkKey != NULL)
// 3882   {
// 3883     osal_memset( pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t) );
// 3884 
// 3885     for ( i = 0; i < ZDSECMGR_ENTRY_MAX; i++ )
// 3886     {
// 3887       // Clear the record
// 3888       osal_nv_write( (ZCD_NV_APS_LINK_KEY_DATA_START + i), 0,
// 3889                     sizeof(APSME_LinkKeyData_t), pApsLinkKey);
// 3890     }
// 3891 
// 3892     osal_mem_free(pApsLinkKey);
// 3893   }
// 3894 }
// 3895 
// 3896 #if defined ( NV_RESTORE )
// 3897 /*********************************************************************
// 3898  * @fn      ZDSecMgrUpdateNV()
// 3899  *
// 3900  * @brief   Updates one entry of the APS link key table to NV
// 3901  *
// 3902  * @param   index - to the entry in security manager table
// 3903  *
// 3904  * @return  none
// 3905  */
// 3906 static void ZDSecMgrUpdateNV( uint16 index )
// 3907 {
// 3908   nvDeviceListHdr_t hdr;
// 3909 
// 3910   if (ZDSecMgrEntries != NULL)
// 3911   {
// 3912     // Save off the record
// 3913     osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE,
// 3914                    (uint16)((sizeof(nvDeviceListHdr_t)) + (index * sizeof(ZDSecMgrEntry_t))),
// 3915                    sizeof(ZDSecMgrEntry_t), &ZDSecMgrEntries[index] );
// 3916   }
// 3917 
// 3918   if (osal_nv_read(ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof(nvDeviceListHdr_t), &hdr) == ZSUCCESS)
// 3919   {
// 3920     if ( ZDSecMgrEntries[index].ami == INVALID_NODE_ADDR )
// 3921     {
// 3922       if (hdr.numRecs > 0)
// 3923       {
// 3924         hdr.numRecs--;
// 3925       }
// 3926     }
// 3927     else
// 3928     {
// 3929       hdr.numRecs++;
// 3930     }
// 3931 
// 3932     // Save off the header
// 3933     osal_nv_write( ZCD_NV_APS_LINK_KEY_TABLE, 0, sizeof( nvDeviceListHdr_t ), &hdr );
// 3934   }
// 3935 }
// 3936 #endif // NV_RESTORE
// 3937 
// 3938 /******************************************************************************
// 3939  * @fn          ZDSecMgrAPSRemove
// 3940  *
// 3941  * @brief       Remove device from network.
// 3942  *
// 3943  * @param       nwkAddr - device's NWK address
// 3944  * @param       extAddr - device's Extended address
// 3945  * @param       parentAddr - parent's NWK address
// 3946  *
// 3947  * @return      ZStatus_t
// 3948  */
// 3949 ZStatus_t ZDSecMgrAPSRemove( uint16 nwkAddr, uint8 *extAddr, uint16 parentAddr )
// 3950 {
// 3951   ZDSecMgrDevice_t device;
// 3952 
// 3953   if ( ( nwkAddr == INVALID_NODE_ADDR ) ||
// 3954        ( extAddr == NULL )              ||
// 3955        ( parentAddr == INVALID_NODE_ADDR ) )
// 3956   {
// 3957     return ( ZFailure );
// 3958   }
// 3959 
// 3960   device.nwkAddr = nwkAddr;
// 3961   device.extAddr = extAddr;
// 3962   device.parentAddr = parentAddr;
// 3963 
// 3964   // remove device
// 3965   ZDSecMgrDeviceRemove( &device );
// 3966 
// 3967   return ( ZSuccess );
// 3968 }
// 3969 
// 3970 /******************************************************************************
// 3971  * @fn          APSME_TCLinkKeyInit
// 3972  *
// 3973  * @brief       Initialize the NV table for preconfigured TC link key
// 3974  *
// 3975  *              When zgUseDefaultTCL is set to TRUE, the default preconfig
// 3976  *              Trust Center Link Key is written to NV. A single tclk is used
// 3977  *              by all devices joining the network.
// 3978  *
// 3979  * @param       setDefault - TRUE to set default values
// 3980  *
// 3981  * @return      none
// 3982  */
// 3983 void APSME_TCLinkKeyInit(uint8 setDefault)
// 3984 {
// 3985   uint8             i;
// 3986   APSME_TCLinkKey_t tcLinkKey;
// 3987   uint8             rtrn;
// 3988 
// 3989   // Initialize all NV items for preconfigured TCLK
// 3990   for( i = 0; i < ZDSECMGR_TC_DEVICE_MAX; i++ )
// 3991   {
// 3992     // Making sure data is cleared for every key all the time
// 3993     osal_memset( &tcLinkKey, 0x00, sizeof(APSME_TCLinkKey_t) );
// 3994 
// 3995     // Initialize first element of the table with the default TCLK
// 3996     if((i == 0) && ( zgUseDefaultTCLK == TRUE ))
// 3997     {
// 3998       osal_memset( tcLinkKey.extAddr, 0xFF, Z_EXTADDR_LEN );
// 3999       osal_memcpy( tcLinkKey.key, defaultTCLinkKey, SEC_KEY_LEN);
// 4000     }
// 4001 
// 4002     // If the item doesn't exist in NV memory, create and initialize
// 4003     // it with the default value passed in, either defaultTCLK or 0
// 4004     rtrn = osal_nv_item_init( (ZCD_NV_TCLK_TABLE_START + i),
// 4005                                sizeof(APSME_TCLinkKey_t), &tcLinkKey);
// 4006 
// 4007     if (rtrn == SUCCESS)
// 4008     {
// 4009       // set the Frame counters to 0 to existing keys in NV
// 4010       osal_nv_read( ( ZCD_NV_TCLK_TABLE_START + i), 0,
// 4011                      sizeof(APSME_TCLinkKey_t), &tcLinkKey );
// 4012 
// 4013 #if defined ( NV_RESTORE )
// 4014       if (setDefault == TRUE)
// 4015       {
// 4016         // clear the value stored in NV
// 4017         tcLinkKey.txFrmCntr = 0;
// 4018       }
// 4019       else
// 4020       {
// 4021         // increase the value stored in NV
// 4022         tcLinkKey.txFrmCntr += ( MAX_TCLK_FRAMECOUNTER_CHANGES + 1 );
// 4023       }
// 4024 #else
// 4025       // Clear the counters if NV_RESTORE is not enabled and this NV item
// 4026       // already existed in the NV memory
// 4027       tcLinkKey.txFrmCntr = 0;
// 4028       tcLinkKey.rxFrmCntr = 0;
// 4029 #endif  // NV_RESTORE
// 4030 
// 4031       osal_nv_write( ( ZCD_NV_TCLK_TABLE_START + i), 0,
// 4032                       sizeof(APSME_TCLinkKey_t), &tcLinkKey );
// 4033 
// 4034       // set initial values for counters in RAM
// 4035       TCLinkKeyFrmCntr[i].txFrmCntr = tcLinkKey.txFrmCntr;
// 4036       TCLinkKeyFrmCntr[i].rxFrmCntr = tcLinkKey.rxFrmCntr;
// 4037     }
// 4038   }
// 4039 
// 4040   // clear copy of key in RAM
// 4041   osal_memset( &tcLinkKey, 0x00, sizeof(APSME_TCLinkKey_t) );
// 4042 
// 4043 }
// 4044 
// 4045 /******************************************************************************
// 4046  * @fn          APSME_TCLinkKeySync
// 4047  *
// 4048  * @brief       Sync Trust Center LINK key data.
// 4049  *
// 4050  * @param       srcAddr - [in] srcAddr
// 4051  * @param       si      - [in, out] SSP_Info_t
// 4052  *
// 4053  * @return      ZStatus_t
// 4054  */
// 4055 ZStatus_t APSME_TCLinkKeySync( uint16 srcAddr, SSP_Info_t* si )
// 4056 {
// 4057   uint8 i;
// 4058   ZStatus_t status = ZSecNoKey;
// 4059   APSME_TCLinkKey_t tcLinkKey;
// 4060   uint32 *tclkRxFrmCntr;
// 4061 
// 4062   // Look up the IEEE address of the trust center if it's available
// 4063   if ( AddrMgrExtAddrValid( si->extAddr ) == FALSE )
// 4064   {
// 4065     APSME_LookupExtAddr( srcAddr, si->extAddr );
// 4066   }
// 4067 
// 4068   // Look up the TC link key associated with the device
// 4069   // or the default TC link key (extAddr is all FFs), whichever is found
// 4070   for( i = 0; i < ZDSECMGR_TC_DEVICE_MAX; i++ )
// 4071   {
// 4072     // Read entry i of the TC link key table from NV
// 4073     osal_nv_read( (ZCD_NV_TCLK_TABLE_START + i), 0,
// 4074                  sizeof(APSME_TCLinkKey_t), &tcLinkKey );
// 4075 
// 4076     if( AddrMgrExtAddrEqual(si->extAddr, tcLinkKey.extAddr) ||
// 4077         APSME_IsDefaultTCLK(tcLinkKey.extAddr))
// 4078     {
// 4079       tclkRxFrmCntr = &TCLinkKeyFrmCntr[i].rxFrmCntr;
// 4080 
// 4081       // verify that the incoming frame counter is valid
// 4082       if ( si->frmCntr >= *tclkRxFrmCntr )
// 4083       {
// 4084         // set the keyNvId to use
// 4085         si->keyNvId = (ZCD_NV_TCLK_TABLE_START + i);
// 4086 
// 4087         // update the rx frame counter
// 4088         *tclkRxFrmCntr = si->frmCntr + 1;
// 4089 
// 4090         status = ZSuccess;
// 4091       }
// 4092       else
// 4093       {
// 4094         status = ZSecOldFrmCount;
// 4095       }
// 4096       // break from the loop
// 4097       break;
// 4098     }
// 4099   }
// 4100 
// 4101   // clear copy of key in RAM
// 4102   osal_memset( &tcLinkKey, 0x00, sizeof(APSME_TCLinkKey_t) );
// 4103 
// 4104   return status;
// 4105 }
// 4106 
// 4107 /******************************************************************************
// 4108  * @fn          APSME_TCLinkKeyLoad
// 4109  *
// 4110  * @brief       Load Trust Center LINK key data.
// 4111  *
// 4112  * @param       dstAddr - [in] dstAddr
// 4113  * @param       si      - [in, out] SSP_Info_t
// 4114  *
// 4115  * @return      ZStatus_t
// 4116  */
// 4117 ZStatus_t APSME_TCLinkKeyLoad( uint16 dstAddr, SSP_Info_t* si )
// 4118 {
// 4119   uint8 i;
// 4120   ZStatus_t status = ZSecNoKey;
// 4121   APSME_TCLinkKey_t tcLinkKey;
// 4122   AddrMgrEntry_t addrEntry;
// 4123   uint32 *tclkTxFrmCntr;
// 4124   uint8 extAddrFound;
// 4125   uint8 defaultTCLKIdx = ZDSECMGR_TC_DEVICE_MAX;
// 4126 
// 4127   // Look up the ami of the srcAddr if available
// 4128   addrEntry.user    = ADDRMGR_USER_DEFAULT;
// 4129   addrEntry.nwkAddr = dstAddr;
// 4130 
// 4131   APSME_LookupExtAddr( dstAddr, si->extAddr );
// 4132 
// 4133   extAddrFound = AddrMgrExtAddrValid( si->extAddr );
// 4134 
// 4135   // Look up the TC link key associated with the device
// 4136   // or the master TC link key (ami = 0xFFFF), whichever is found
// 4137   for( i = 0; i < ZDSECMGR_TC_DEVICE_MAX; i++ )
// 4138   {
// 4139     // Read entry i of the TC link key table from NV
// 4140     osal_nv_read( (ZCD_NV_TCLK_TABLE_START + i), 0,
// 4141                  sizeof(APSME_TCLinkKey_t), &tcLinkKey );
// 4142 
// 4143     if( extAddrFound && AddrMgrExtAddrEqual(si->extAddr, tcLinkKey.extAddr) )
// 4144     {
// 4145       status = ZSuccess;
// 4146 
// 4147       break; // break from the loop
// 4148     }
// 4149 
// 4150     if ( APSME_IsDefaultTCLK(tcLinkKey.extAddr) )
// 4151     {
// 4152       if ( !extAddrFound )
// 4153       {
// 4154         status = ZSuccess;
// 4155 
// 4156         break; // break from the loop
// 4157       }
// 4158 
// 4159       // Remember the default TCLK index
// 4160       defaultTCLKIdx = i;
// 4161     }
// 4162   }
// 4163 
// 4164   if ( (status != ZSuccess) && (defaultTCLKIdx < ZDSECMGR_TC_DEVICE_MAX) )
// 4165   {
// 4166     // Exact match was not found; use the default TC Link Key
// 4167     i = defaultTCLKIdx;
// 4168     status = ZSuccess;
// 4169   }
// 4170 
// 4171   if ( status == ZSuccess )
// 4172   {
// 4173     tclkTxFrmCntr = &TCLinkKeyFrmCntr[i].txFrmCntr;
// 4174 
// 4175     // set the keyNvId to use
// 4176     si->keyNvId = (ZCD_NV_TCLK_TABLE_START + i);
// 4177 
// 4178     // update link key related fields
// 4179     si->keyID   = SEC_KEYID_LINK;
// 4180     si->frmCntr = *tclkTxFrmCntr;
// 4181 
// 4182     // update outgoing frame counter
// 4183     (*tclkTxFrmCntr)++;
// 4184 
// 4185 #if defined ( NV_RESTORE )
// 4186     // write periodically to NV
// 4187     if ( !(*tclkTxFrmCntr % MAX_TCLK_FRAMECOUNTER_CHANGES) )
// 4188     {
// 4189       // set the flag to write key to NV
// 4190       TCLinkKeyFrmCntr[i].pendingFlag = TRUE;
// 4191 
// 4192       // Notify the ZDApp that the frame counter has changed.
// 4193       osal_set_event( ZDAppTaskID, ZDO_TCLK_FRAMECOUNTER_CHANGE );
// 4194     }
// 4195 #endif
// 4196   }
// 4197 
// 4198   // If no TC link key found, remove the device from the address manager
// 4199   if ( (status != ZSuccess) && (AddrMgrEntryLookupNwk(&addrEntry) == TRUE) )
// 4200   {
// 4201     AddrMgrEntryRelease( &addrEntry );
// 4202   }
// 4203 
// 4204     // clear copy of key in RAM
// 4205   osal_memset( &tcLinkKey, 0x00, sizeof(APSME_TCLinkKey_t) );
// 4206 
// 4207   return status;
// 4208 }
// 4209 
// 4210 /******************************************************************************
// 4211  * @fn          APSME_IsDefaultTCLK
// 4212  *
// 4213  * @brief       Return TRUE or FALSE based on the extended address.  If the
// 4214  *              input ext address is all FFs, it means the trust center link
// 4215  *              assoiciated with the address is the default trust center link key
// 4216  *
// 4217  * @param       extAddr - [in] extended address
// 4218  *
// 4219  * @return      uint8 TRUE/FALSE
// 4220  */
// 4221 uint8 APSME_IsDefaultTCLK( uint8 *extAddr )
// 4222 {
// 4223   uint8 i = 0;
// 4224 
// 4225   if( extAddr == NULL )
// 4226   {
// 4227     return FALSE;
// 4228   }
// 4229 
// 4230   while( i++ < Z_EXTADDR_LEN )
// 4231   {
// 4232     if( *extAddr++ != 0xFF )
// 4233     {
// 4234       return FALSE;
// 4235     }
// 4236   }
// 4237 
// 4238   return TRUE;
// 4239 }
// 4240 
// 4241 /******************************************************************************
// 4242  * @fn          ZDSecMgrNwkKeyInit
// 4243  *
// 4244  * @brief       Initialize the NV items for
// 4245  *                  ZCD_NV_NWKKEY,
// 4246  *                  ZCD_NV_NWK_ACTIVE_KEY_INFO and
// 4247  *                  ZCD_NV_NWK_ALTERN_KEY_INFO
// 4248  *
// 4249  * @param       setDefault
// 4250  *
// 4251  * @return      none
// 4252  */
// 4253 void ZDSecMgrNwkKeyInit(uint8 setDefault)
// 4254 {
// 4255   uint8 status;
// 4256   nwkKeyDesc nwkKey;
// 4257 
// 4258   // Initialize NV items for NWK key, this structure contains the frame counter
// 4259   // and is only used when NV_RESTORE is enabled
// 4260   nwkActiveKeyItems keyItems;
// 4261 
// 4262   osal_memset( &keyItems, 0, sizeof( nwkActiveKeyItems ) );
// 4263 
// 4264   status = osal_nv_item_init( ZCD_NV_NWKKEY, sizeof(nwkActiveKeyItems), (void *)&keyItems );
// 4265 
// 4266 #if defined ( NV_RESTORE )
// 4267   // reset the values of NV items if NV_RESTORE is not enabled
// 4268   if ((status == SUCCESS) && (setDefault == TRUE))
// 4269   {
// 4270     // clear NV data to default values
// 4271     osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), &keyItems );
// 4272   }
// 4273 #else
// 4274   (void)setDefault;   // to eliminate compiler warning
// 4275 
// 4276   // reset the values of NV items if NV_RESTORE is not enabled
// 4277   if (status == SUCCESS)
// 4278   {
// 4279     osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), &keyItems );
// 4280   }
// 4281 #endif // defined (NV_RESTORE)
// 4282 
// 4283   // Initialize NV items for NWK Active and Alternate keys. These items are used
// 4284   // all the time, independently of NV_RESTORE being set or not
// 4285   osal_memset( &nwkKey, 0x00, sizeof(nwkKey) );
// 4286 
// 4287   status = osal_nv_item_init( ZCD_NV_NWK_ACTIVE_KEY_INFO, sizeof(nwkKey), &nwkKey);
// 4288 
// 4289 #if defined ( NV_RESTORE )
// 4290   // reset the values of NV items if NV_RESTORE is not enabled
// 4291   if ((status == SUCCESS) && (setDefault == TRUE))
// 4292   {
// 4293     // clear NV data to default values
// 4294     osal_nv_write( ZCD_NV_NWK_ACTIVE_KEY_INFO, 0, sizeof(nwkKey), &nwkKey );
// 4295   }
// 4296 #else
// 4297   // reset the values of NV items if NV_RESTORE is not enabled
// 4298   if (status == SUCCESS)
// 4299   {
// 4300     osal_nv_write( ZCD_NV_NWK_ACTIVE_KEY_INFO, 0, sizeof(nwkKey), &nwkKey );
// 4301   }
// 4302 #endif // defined (NV_RESTORE)
// 4303 
// 4304   status = osal_nv_item_init( ZCD_NV_NWK_ALTERN_KEY_INFO, sizeof(nwkKey), &nwkKey );
// 4305 
// 4306 #if defined ( NV_RESTORE )
// 4307   // reset the values of NV items if NV_RESTORE is not enabled
// 4308   if ((status == SUCCESS) && (setDefault == TRUE))
// 4309   {
// 4310     // clear NV data to default values
// 4311     osal_nv_write( ZCD_NV_NWK_ALTERN_KEY_INFO, 0, sizeof(nwkKey), &nwkKey );
// 4312   }
// 4313 #else
// 4314   // reset the values of NV items if NV_RESTORE is not enabled
// 4315   if (status == SUCCESS)
        CALLA   #osal_nv_item_init
        CMP.B   #0x0, R12
        RETA
          CFI EndBlock cfiCond5
          CFI EndBlock cfiCond6
          CFI EndBlock cfiCond7
          CFI EndBlock cfiCond8
          CFI EndBlock cfiCond9
          CFI EndBlock cfiCond10
          CFI EndBlock cfiPicker11

        RSEG CODE:CODE:NOROOT(1)
?Subroutine28:
          CFI Block cfiCond12 Using cfiCommon0
          CFI Function ZDSecMgrApsLinkKeyInit
          CFI Conditional ??CrossCallReturnLabel_60
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+40
          CFI Block cfiCond13 Using cfiCommon0
          CFI (cfiCond13) Function ZDSecMgrSetDefaultNV
          CFI (cfiCond13) Conditional ??CrossCallReturnLabel_61
          CFI (cfiCond13) R10L Frame(CFA, -8)
          CFI (cfiCond13) R11L Frame(CFA, -6)
          CFI (cfiCond13) CFA SP+20
          CFI Block cfiCond14 Using cfiCommon0
          CFI (cfiCond14) Function ZDSecMgrEntryFree
          CFI (cfiCond14) Conditional ??CrossCallReturnLabel_62
          CFI (cfiCond14) R10L Frame(CFA, -8)
          CFI (cfiCond14) R11L Frame(CFA, -6)
          CFI (cfiCond14) CFA SP+12
          CFI Block cfiPicker15 Using cfiCommon1
          CFI (cfiPicker15) NoFunction
          CFI (cfiPicker15) Picker
        MOV.W   R11, R15
          CFI EndBlock cfiCond12
          CFI EndBlock cfiCond13
          CFI EndBlock cfiCond14
          CFI EndBlock cfiPicker15
        REQUIRE ??Subroutine28_0
        // Fall through to label ??Subroutine28_0

        RSEG CODE:CODE:NOROOT(1)
??Subroutine28_0:
          CFI Block cfiCond16 Using cfiCommon0
          CFI Function ZDSecMgrSaveApsLinkKey
          CFI Conditional ??CrossCallReturnLabel_55
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+16
          CFI Block cfiCond17 Using cfiCommon0
          CFI (cfiCond17) Function ZDSecMgrSaveApsLinkKey
          CFI (cfiCond17) Conditional ??CrossCallReturnLabel_56
          CFI (cfiCond17) R8L Frame(CFA, -12)
          CFI (cfiCond17) R9L Frame(CFA, -10)
          CFI (cfiCond17) R10L Frame(CFA, -8)
          CFI (cfiCond17) R11L Frame(CFA, -6)
          CFI (cfiCond17) CFA SP+16
          CFI Block cfiCond18 Using cfiCommon0
          CFI (cfiCond18) Function APSME_IsLinkKeyValid
          CFI (cfiCond18) Conditional ??CrossCallReturnLabel_57
          CFI (cfiCond18) R10L Frame(CFA, -8)
          CFI (cfiCond18) R11L Frame(CFA, -6)
          CFI (cfiCond18) CFA SP+30
          CFI Block cfiCond19 Using cfiCommon0
          CFI (cfiCond19) Function APSME_LinkKeySet
          CFI (cfiCond19) Conditional ??CrossCallReturnLabel_58
          CFI (cfiCond19) R8L Frame(CFA, -12)
          CFI (cfiCond19) R9L Frame(CFA, -10)
          CFI (cfiCond19) R10L Frame(CFA, -8)
          CFI (cfiCond19) R11L Frame(CFA, -6)
          CFI (cfiCond19) CFA SP+20
          CFI Block cfiCond20 Using cfiCommon0
          CFI (cfiCond20) Function APSME_LinkKeySet
          CFI (cfiCond20) Conditional ??CrossCallReturnLabel_59
          CFI (cfiCond20) R8L Frame(CFA, -12)
          CFI (cfiCond20) R9L Frame(CFA, -10)
          CFI (cfiCond20) R10L Frame(CFA, -8)
          CFI (cfiCond20) R11L Frame(CFA, -6)
          CFI (cfiCond20) CFA SP+20
          CFI Block cfiCond21 Using cfiCommon0
          CFI (cfiCond21) Function ZDSecMgrApsLinkKeyInit
          CFI (cfiCond21) Conditional ??CrossCallReturnLabel_60
          CFI (cfiCond21) R8L Frame(CFA, -12)
          CFI (cfiCond21) R9L Frame(CFA, -10)
          CFI (cfiCond21) R10L Frame(CFA, -8)
          CFI (cfiCond21) R11L Frame(CFA, -6)
          CFI (cfiCond21) CFA SP+40
          CFI Block cfiCond22 Using cfiCommon0
          CFI (cfiCond22) Function ZDSecMgrSetDefaultNV
          CFI (cfiCond22) Conditional ??CrossCallReturnLabel_61
          CFI (cfiCond22) R10L Frame(CFA, -8)
          CFI (cfiCond22) R11L Frame(CFA, -6)
          CFI (cfiCond22) CFA SP+20
          CFI Block cfiCond23 Using cfiCommon0
          CFI (cfiCond23) Function ZDSecMgrEntryFree
          CFI (cfiCond23) Conditional ??CrossCallReturnLabel_62
          CFI (cfiCond23) R10L Frame(CFA, -8)
          CFI (cfiCond23) R11L Frame(CFA, -6)
          CFI (cfiCond23) CFA SP+12
          CFI Block cfiPicker24 Using cfiCommon1
          CFI (cfiPicker24) NoFunction
          CFI (cfiPicker24) Picker
        MOV.W   #0x18, R14
        MOV.W   #0x0, R13
        RETA
          CFI EndBlock cfiCond16
          CFI EndBlock cfiCond17
          CFI EndBlock cfiCond18
          CFI EndBlock cfiCond19
          CFI EndBlock cfiCond20
          CFI EndBlock cfiCond21
          CFI EndBlock cfiCond22
          CFI EndBlock cfiCond23
          CFI EndBlock cfiPicker24

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrReadKeyFromNv:
          CFI Block cfiBlock25 Using cfiCommon0
          CFI Function ZDSecMgrReadKeyFromNv
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME CSTACK, 4, STACK
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME CSTACK, 4, STACK
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME CSTACK, 4, STACK
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME CSTACK, 4, STACK
        FUNCALL ZDSecMgrReadKeyFromNv, osal_nv_read
        LOCFRAME CSTACK, 4, STACK
        MOV.W   #0x10, R14
        CMP.W   #0x3a, R12
        JEQ     ??ZDSecMgrReadKeyFromNv_0
        CMP.W   #0x3b, R12
        JNE     ??ZDSecMgrReadKeyFromNv_1
??ZDSecMgrReadKeyFromNv_0:
        MOV.W   R13, R15
        MOV.W   #0x1, R13
        BRA     #osal_nv_read
??ZDSecMgrReadKeyFromNv_1:
        MOV.W   R12, R15
        ADD.W   #0xfeff, R15
        JNE     ??ZDSecMgrReadKeyFromNv_2
        MOV.W   R13, R15
        MOV.W   #0x8, R13
        BRA     #osal_nv_read
??ZDSecMgrReadKeyFromNv_2:
        MOV.W   R12, R15
        ADD.W   #0xfdff, R15
        CMP.W   #0x3, R15
        JC      ??ZDSecMgrReadKeyFromNv_3
        MOV.W   R13, R15
        MOV.W   #0x0, R13
        BRA     #osal_nv_read
??ZDSecMgrReadKeyFromNv_3:
        MOV.W   R12, R15
        ADD.W   #0xfcff, R15
        CMP.W   #0x3, R15
        JC      ??ZDSecMgrReadKeyFromNv_4
        MOV.W   R13, R15
        MOV.W   #0x2, R13
        BRA     #osal_nv_read
??ZDSecMgrReadKeyFromNv_4:
        CMP.W   #0x62, R12
        JNE     ??ZDSecMgrReadKeyFromNv_5
        MOV.W   R13, R15
        MOV.W   #0x0, R13
        MOV.W   #0x62, R12
        BRA     #osal_nv_read
??ZDSecMgrReadKeyFromNv_5:
        MOV.B   #0xa, R12
        RETA
          CFI EndBlock cfiBlock25

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrNwkKeyInit:
          CFI Block cfiBlock26 Using cfiCommon0
          CFI Function ZDSecMgrNwkKeyInit
        FUNCALL ZDSecMgrNwkKeyInit, osal_memset
        LOCFRAME CSTACK, 48, STACK
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_item_init
        LOCFRAME CSTACK, 48, STACK
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_write
        LOCFRAME CSTACK, 48, STACK
        FUNCALL ZDSecMgrNwkKeyInit, osal_memset
        LOCFRAME CSTACK, 48, STACK
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_item_init
        LOCFRAME CSTACK, 48, STACK
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_write
        LOCFRAME CSTACK, 48, STACK
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_item_init
        LOCFRAME CSTACK, 48, STACK
        FUNCALL ZDSecMgrNwkKeyInit, osal_nv_write
        LOCFRAME CSTACK, 48, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        SUB.W   #0x28, SP
          CFI CFA SP+48
        MOV.W   SP, R10
        ADD.W   #0x0, R10
        MOV.W   #0x16, R14
        CALLA   #?Subroutine41
??CrossCallReturnLabel_69:
        MOV.W   R10, R14
        MOV.W   #0x16, R13
        MOV.W   #0x82, R12
        CALLA   #??Subroutine29_0
??CrossCallReturnLabel_51:
        JNE     ??ZDSecMgrNwkKeyInit_0
        MOV.W   R10, R15
        MOV.W   #0x16, R14
        MOV.W   #0x0, R13
        MOV.W   #0x82, R12
        CALLA   #osal_nv_write
??ZDSecMgrNwkKeyInit_0:
        ADD.W   #0x16, R10
        MOV.W   #0x11, R14
        CALLA   #?Subroutine41
??CrossCallReturnLabel_70:
        MOV.W   #0x11, R11
        MOV.W   R10, R14
        MOV.W   R11, R13
        MOV.W   #0x3a, R12
        CALLA   #??Subroutine29_0
??CrossCallReturnLabel_52:
        JNE     ??ZDSecMgrNwkKeyInit_1
        MOV.W   R10, R15
        MOV.W   R11, R14
        MOV.W   #0x0, R13
        MOV.W   #0x3a, R12
        CALLA   #osal_nv_write
??ZDSecMgrNwkKeyInit_1:
        MOV.W   R10, R14
        MOV.W   R11, R13
        MOV.W   #0x3b, R12
        CALLA   #??Subroutine29_0
??CrossCallReturnLabel_53:
        JNE     ??ZDSecMgrNwkKeyInit_2
        MOV.W   R10, R15
        MOV.W   R11, R14
        MOV.W   #0x0, R13
        MOV.W   #0x3b, R12
        CALLA   #osal_nv_write
??ZDSecMgrNwkKeyInit_2:
        ADD.W   #0x28, SP
          CFI CFA SP+8
        POPM.W  #0x2, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock26

        RSEG CODE:CODE:NOROOT(1)
APSME_IsDefaultTCLK:
          CFI Block cfiBlock27 Using cfiCommon0
          CFI Function APSME_IsDefaultTCLK
        MOV.B   #0x0, R15
        CMP.W   #0x0, R12
        JEQ     ??APSME_IsDefaultTCLK_1
??APSME_IsDefaultTCLK_0:
        MOV.B   R15, R14
        ADD.B   #0x1, R15
        CMP.B   #0x8, R14
        JC      ??APSME_IsDefaultTCLK_2
        MOV.B   @R12+, R14
        CMP.B   #0xff, R14
        JEQ     ??APSME_IsDefaultTCLK_0
??APSME_IsDefaultTCLK_1:
        MOV.B   #0x0, R12
        RETA
??APSME_IsDefaultTCLK_2:
        MOV.B   #0x1, R12
        RETA
          CFI EndBlock cfiBlock27

        RSEG CODE:CODE:NOROOT(1)
APSME_TCLinkKeyLoad:
          CFI Block cfiBlock28 Using cfiCommon0
          CFI Function APSME_TCLinkKeyLoad
        FUNCALL APSME_TCLinkKeyLoad, APSME_LookupExtAddr
        LOCFRAME CSTACK, 58, STACK
        FUNCALL APSME_TCLinkKeyLoad, AddrMgrExtAddrValid
        LOCFRAME CSTACK, 58, STACK
        FUNCALL APSME_TCLinkKeyLoad, osal_nv_read
        LOCFRAME CSTACK, 58, STACK
        FUNCALL APSME_TCLinkKeyLoad, AddrMgrExtAddrEqual
        LOCFRAME CSTACK, 58, STACK
        FUNCALL APSME_TCLinkKeyLoad, APSME_IsDefaultTCLK
        LOCFRAME CSTACK, 58, STACK
        FUNCALL APSME_TCLinkKeyLoad, AddrMgrEntryLookupNwk
        LOCFRAME CSTACK, 58, STACK
        FUNCALL APSME_TCLinkKeyLoad, AddrMgrEntryRelease
        LOCFRAME CSTACK, 58, STACK
        FUNCALL APSME_TCLinkKeyLoad, osal_memset
        LOCFRAME CSTACK, 58, STACK
        PUSHM.W #0x4, R11
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+12
        SUB.W   #0x2e, SP
          CFI CFA SP+58
        MOV.W   R13, R10
        MOV.B   #0xa1, R11
        MOV.B   #0x0, 0(SP)
        MOV.W   R12, 0x2(SP)
        ADD.W   #0x6, R13
        CALLA   #APSME_LookupExtAddr
        MOV.W   R10, R12
        ADD.W   #0x6, R12
        CALLA   #AddrMgrExtAddrValid
        MOV.B   R12, R8
        MOV.W   SP, R9
        ADD.W   #0xe, R9
        MOV.W   R9, R15
        CALLA   #??Subroutine17_0
??CrossCallReturnLabel_63:
        CMP.B   #0x0, R8
        JEQ     ??APSME_TCLinkKeyLoad_1
        MOV.W   R9, R13
        MOV.W   R10, R12
        ADD.W   #0x6, R12
        CALLA   #AddrMgrExtAddrEqual
        CMP.B   #0x0, R12
        JNE     ??APSME_TCLinkKeyLoad_0
??APSME_TCLinkKeyLoad_1:
        MOV.W   R9, R12
        CALLA   #APSME_IsDefaultTCLK
        CMP.B   #0x0, R12
        JEQ     ??APSME_TCLinkKeyLoad_2
??APSME_TCLinkKeyLoad_0:
        MOV.B   #0x0, R11
        MOV.W   #0x101, 0x10(R10)
        MOV.B   #0x0, 0xe(R10)
        MOV.W   &TCLinkKeyFrmCntr, 0x14(R10)
        MOV.W   &TCLinkKeyFrmCntr + 2, 0x16(R10)
        ADD.W   #0x1, &TCLinkKeyFrmCntr
        ADDC.W  #0x0, &TCLinkKeyFrmCntr + 2
        JMP     ??APSME_TCLinkKeyLoad_3
??APSME_TCLinkKeyLoad_2:
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #AddrMgrEntryLookupNwk
        CMP.B   #0x1, R12
        JNE     ??APSME_TCLinkKeyLoad_3
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #AddrMgrEntryRelease
??APSME_TCLinkKeyLoad_3:
        MOV.W   #0x20, R14
        CALLA   #??Subroutine49_0
??CrossCallReturnLabel_75:
        MOV.B   R11, R12
        ADD.W   #0x2e, SP
          CFI CFA SP+12
        POPM.W  #0x4, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI R8L SameValue
          CFI R9L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock28

        RSEG CODE:CODE:NOROOT(1)
APSME_TCLinkKeySync:
          CFI Block cfiBlock29 Using cfiCommon0
          CFI Function APSME_TCLinkKeySync
        FUNCALL APSME_TCLinkKeySync, AddrMgrExtAddrValid
        LOCFRAME CSTACK, 44, STACK
        FUNCALL APSME_TCLinkKeySync, APSME_LookupExtAddr
        LOCFRAME CSTACK, 44, STACK
        FUNCALL APSME_TCLinkKeySync, osal_nv_read
        LOCFRAME CSTACK, 44, STACK
        FUNCALL APSME_TCLinkKeySync, AddrMgrExtAddrEqual
        LOCFRAME CSTACK, 44, STACK
        FUNCALL APSME_TCLinkKeySync, APSME_IsDefaultTCLK
        LOCFRAME CSTACK, 44, STACK
        FUNCALL APSME_TCLinkKeySync, osal_memset
        LOCFRAME CSTACK, 44, STACK
        PUSHM.W #0x4, R11
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+12
        SUB.W   #0x20, SP
          CFI CFA SP+44
        MOV.W   R12, R10
        MOV.W   R13, R11
        MOV.B   #0xa1, R8
        MOV.W   R13, R12
        ADD.W   #0x6, R12
        CALLA   #AddrMgrExtAddrValid
        CMP.B   #0x0, R12
        JNE     ??APSME_TCLinkKeySync_0
        MOV.W   R11, R13
        ADD.W   #0x6, R13
        MOV.W   R10, R12
        CALLA   #APSME_LookupExtAddr
??APSME_TCLinkKeySync_0:
        MOV.W   SP, R10
        ADD.W   #0x0, R10
        CALLA   #?Subroutine17
??CrossCallReturnLabel_66:
        MOV.W   R10, R13
        MOV.W   R11, R12
        ADD.W   #0x6, R12
        CALLA   #AddrMgrExtAddrEqual
        CMP.B   #0x0, R12
        JNE     ??APSME_TCLinkKeySync_1
        MOV.W   R10, R12
        CALLA   #APSME_IsDefaultTCLK
        CMP.B   #0x0, R12
        JEQ     ??APSME_TCLinkKeySync_2
??APSME_TCLinkKeySync_1:
        MOV.W   0x14(R11), R14
        MOV.W   0x16(R11), R15
        CMP.W   &TCLinkKeyFrmCntr + 6, R15
        JNC     ??APSME_TCLinkKeySync_3
        JNE     ??APSME_TCLinkKeySync_4
        CMP.W   &TCLinkKeyFrmCntr + 4, R14
        JNC     ??APSME_TCLinkKeySync_3
??APSME_TCLinkKeySync_4:
        MOV.W   #0x101, 0x10(R11)
        ADD.W   #0x1, R14
        ADDC.W  #0x0, R15
        MOV.W   R14, &TCLinkKeyFrmCntr + 4
        MOV.W   R15, &TCLinkKeyFrmCntr + 6
        MOV.B   #0x0, R8
        JMP     ??APSME_TCLinkKeySync_2
??APSME_TCLinkKeySync_3:
        MOV.B   #0xa2, R8
??APSME_TCLinkKeySync_2:
        CALLA   #?Subroutine18
??CrossCallReturnLabel_5:
        MOV.B   R8, R12
        ADD.W   #0x20, SP
          CFI CFA SP+12
        POPM.W  #0x4, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI R8L SameValue
          CFI R9L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock29

        RSEG CODE:CODE:NOROOT(1)
?Subroutine18:
          CFI Block cfiCond30 Using cfiCommon0
          CFI Function ZDSecMgrSaveTCLinkKey
          CFI Conditional ??CrossCallReturnLabel_4
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+10
          CFI Block cfiCond31 Using cfiCommon0
          CFI (cfiCond31) Function APSME_TCLinkKeySync
          CFI (cfiCond31) Conditional ??CrossCallReturnLabel_5
          CFI (cfiCond31) R8L Frame(CFA, -12)
          CFI (cfiCond31) R9L Frame(CFA, -10)
          CFI (cfiCond31) R10L Frame(CFA, -8)
          CFI (cfiCond31) R11L Frame(CFA, -6)
          CFI (cfiCond31) CFA SP+48
          CFI Block cfiCond32 Using cfiCommon0
          CFI (cfiCond32) Function APSME_TCLinkKeyInit
          CFI (cfiCond32) Conditional ??CrossCallReturnLabel_6
          CFI (cfiCond32) R10L Frame(CFA, -6)
          CFI (cfiCond32) CFA SP+42
          CFI Block cfiCond33 Using cfiCommon0
          CFI (cfiCond33) Function APSME_TCLinkKeyInit
          CFI (cfiCond33) Conditional ??CrossCallReturnLabel_7
          CFI (cfiCond33) R10L Frame(CFA, -6)
          CFI (cfiCond33) CFA SP+42
          CFI Block cfiPicker34 Using cfiCommon1
          CFI (cfiPicker34) NoFunction
          CFI (cfiPicker34) Picker
        MOV.W   #0x20, R14
        BRA     #?Subroutine41
          CFI EndBlock cfiCond30
          CFI EndBlock cfiCond31
          CFI EndBlock cfiCond32
          CFI EndBlock cfiCond33
          CFI EndBlock cfiPicker34

        RSEG CODE:CODE:NOROOT(1)
?Subroutine17:
          CFI Block cfiCond35 Using cfiCommon0
          CFI Function APSME_TCLinkKeySync
          CFI Conditional ??CrossCallReturnLabel_66
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+48
          CFI Block cfiCond36 Using cfiCommon0
          CFI (cfiCond36) Function APSME_TCLinkKeyInit
          CFI (cfiCond36) Conditional ??CrossCallReturnLabel_65
          CFI (cfiCond36) R10L Frame(CFA, -6)
          CFI (cfiCond36) CFA SP+42
          CFI Block cfiPicker37 Using cfiCommon1
          CFI (cfiPicker37) NoFunction
          CFI (cfiPicker37) Picker
        MOV.W   R10, R15
          CFI EndBlock cfiCond35
          CFI EndBlock cfiCond36
          CFI EndBlock cfiPicker37
        REQUIRE ??Subroutine17_0
        // Fall through to label ??Subroutine17_0

        RSEG CODE:CODE:NOROOT(1)
??Subroutine17_0:
          CFI Block cfiCond38 Using cfiCommon0
          CFI Function ZDSecMgrSaveTCLinkKey
          CFI Conditional ??CrossCallReturnLabel_64
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+10
          CFI Block cfiCond39 Using cfiCommon0
          CFI (cfiCond39) Function APSME_TCLinkKeyLoad
          CFI (cfiCond39) Conditional ??CrossCallReturnLabel_63
          CFI (cfiCond39) R8L Frame(CFA, -12)
          CFI (cfiCond39) R9L Frame(CFA, -10)
          CFI (cfiCond39) R10L Frame(CFA, -8)
          CFI (cfiCond39) R11L Frame(CFA, -6)
          CFI (cfiCond39) CFA SP+62
          CFI Block cfiCond40 Using cfiCommon0
          CFI (cfiCond40) Function APSME_TCLinkKeySync
          CFI (cfiCond40) Conditional ??CrossCallReturnLabel_66
          CFI (cfiCond40) R8L Frame(CFA, -12)
          CFI (cfiCond40) R9L Frame(CFA, -10)
          CFI (cfiCond40) R10L Frame(CFA, -8)
          CFI (cfiCond40) R11L Frame(CFA, -6)
          CFI (cfiCond40) CFA SP+48
          CFI Block cfiCond41 Using cfiCommon0
          CFI (cfiCond41) Function APSME_TCLinkKeyInit
          CFI (cfiCond41) Conditional ??CrossCallReturnLabel_65
          CFI (cfiCond41) R10L Frame(CFA, -6)
          CFI (cfiCond41) CFA SP+42
          CFI Block cfiPicker42 Using cfiCommon1
          CFI (cfiPicker42) NoFunction
          CFI (cfiPicker42) Picker
        MOV.W   #0x20, R14
        MOV.W   #0x0, R13
        MOV.W   #0x101, R12
        BRA     #osal_nv_read
          CFI EndBlock cfiCond38
          CFI EndBlock cfiCond39
          CFI EndBlock cfiCond40
          CFI EndBlock cfiCond41
          CFI EndBlock cfiPicker42

        RSEG CODE:CODE:NOROOT(1)
APSME_TCLinkKeyInit:
          CFI Block cfiBlock43 Using cfiCommon0
          CFI Function APSME_TCLinkKeyInit
        FUNCALL APSME_TCLinkKeyInit, osal_memset
        LOCFRAME CSTACK, 38, STACK
        FUNCALL APSME_TCLinkKeyInit, osal_memset
        LOCFRAME CSTACK, 38, STACK
        FUNCALL APSME_TCLinkKeyInit, osal_memcpy
        LOCFRAME CSTACK, 38, STACK
        FUNCALL APSME_TCLinkKeyInit, osal_nv_item_init
        LOCFRAME CSTACK, 38, STACK
        FUNCALL APSME_TCLinkKeyInit, osal_nv_read
        LOCFRAME CSTACK, 38, STACK
        FUNCALL APSME_TCLinkKeyInit, osal_nv_write
        LOCFRAME CSTACK, 38, STACK
        FUNCALL APSME_TCLinkKeyInit, osal_memset
        LOCFRAME CSTACK, 38, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0x20, SP
          CFI CFA SP+38
        MOV.W   SP, R10
        ADD.W   #0x0, R10
        CALLA   #?Subroutine18
??CrossCallReturnLabel_6:
        CMP.B   #0x1, &zgUseDefaultTCLK
        JNE     ??APSME_TCLinkKeyInit_0
        MOV.W   #0x8, R14
        MOV.B   #0xff, R13
        CALLA   #??Subroutine46_0
??CrossCallReturnLabel_67:
        MOV.W   #0x10, R14
        MOV.W   #defaultTCLinkKey, R13
        MOV.W   R10, R12
        ADD.W   #0x8, R12
        CALLA   #osal_memcpy
??APSME_TCLinkKeyInit_0:
        MOV.W   R10, R14
        MOV.W   #0x20, R13
        MOV.W   #0x101, R12
        CALLA   #??Subroutine29_0
??CrossCallReturnLabel_54:
        JNE     ??APSME_TCLinkKeyInit_1
        CALLA   #?Subroutine17
??CrossCallReturnLabel_65:
        MOV.W   #0x0, 0x18(SP)
        MOV.W   #0x0, 0x1a(SP)
        MOV.W   #0x0, 0x1c(SP)
        MOV.W   #0x0, 0x1e(SP)
        CALLA   #?Subroutine19
??CrossCallReturnLabel_8:
        MOV.W   0x18(SP), &TCLinkKeyFrmCntr
        MOV.W   0x1a(SP), &TCLinkKeyFrmCntr + 2
        MOV.W   0x1c(SP), &TCLinkKeyFrmCntr + 4
        MOV.W   0x1e(SP), &TCLinkKeyFrmCntr + 6
??APSME_TCLinkKeyInit_1:
        CALLA   #?Subroutine18
??CrossCallReturnLabel_7:
        ADD.W   #0x20, SP
          CFI CFA SP+6
        POP.W   R10
          CFI R10L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock43

        RSEG CODE:CODE:NOROOT(1)
?Subroutine19:
          CFI Block cfiCond44 Using cfiCommon0
          CFI Function ZDSecMgrSaveTCLinkKey
          CFI Conditional ??CrossCallReturnLabel_9
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+10
          CFI Block cfiCond45 Using cfiCommon0
          CFI (cfiCond45) Function APSME_TCLinkKeyInit
          CFI (cfiCond45) Conditional ??CrossCallReturnLabel_8
          CFI (cfiCond45) R10L Frame(CFA, -6)
          CFI (cfiCond45) CFA SP+42
          CFI Block cfiPicker46 Using cfiCommon1
          CFI (cfiPicker46) NoFunction
          CFI (cfiPicker46) Picker
        MOV.W   R10, R15
        MOV.W   #0x20, R14
        MOV.W   #0x0, R13
        MOV.W   #0x101, R12
        BRA     #osal_nv_write
          CFI EndBlock cfiCond44
          CFI EndBlock cfiCond45
          CFI EndBlock cfiPicker46

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAPSRemove:
          CFI Block cfiBlock47 Using cfiCommon0
          CFI Function ZDSecMgrAPSRemove
        FUNCALL ZDSecMgrAPSRemove, ZDSecMgrDeviceRemove
        LOCFRAME CSTACK, 14, STACK
        SUB.W   #0xa, SP
          CFI CFA SP+14
        CMP.W   #0xfffe, R12
        JEQ     ??ZDSecMgrAPSRemove_0
        CMP.W   #0x0, R13
        JEQ     ??ZDSecMgrAPSRemove_0
        CMP.W   #0xfffe, R14
        JNE     ??ZDSecMgrAPSRemove_1
??ZDSecMgrAPSRemove_0:
        MOV.B   #0x1, R12
        JMP     ??ZDSecMgrAPSRemove_2
??ZDSecMgrAPSRemove_1:
        MOV.W   R12, 0(SP)
        MOV.W   R13, 0x2(SP)
        MOV.W   R14, 0x4(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #ZDSecMgrDeviceRemove
        MOV.B   #0x0, R12
          CFI EndBlock cfiBlock47
??ZDSecMgrAPSRemove_2:
        REQUIRE ?Subroutine13
        // Fall through to label ?Subroutine13

        RSEG CODE:CODE:NOROOT(1)
?Subroutine13:
          CFI Block cfiBlock48 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+14
        ADD.W   #0xa, SP
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock48

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrSetDefaultNV:
          CFI Block cfiBlock49 Using cfiCommon0
          CFI Function ZDSecMgrSetDefaultNV
        FUNCALL ZDSecMgrSetDefaultNV, osal_nv_write
        LOCFRAME CSTACK, 16, STACK
        FUNCALL ZDSecMgrSetDefaultNV, osal_memset
        LOCFRAME CSTACK, 16, STACK
        FUNCALL ZDSecMgrSetDefaultNV, osal_nv_write
        LOCFRAME CSTACK, 16, STACK
        FUNCALL ZDSecMgrSetDefaultNV, osal_mem_alloc
        LOCFRAME CSTACK, 16, STACK
        FUNCALL ZDSecMgrSetDefaultNV, osal_memset
        LOCFRAME CSTACK, 16, STACK
        FUNCALL ZDSecMgrSetDefaultNV, osal_nv_write
        LOCFRAME CSTACK, 16, STACK
        FUNCALL ZDSecMgrSetDefaultNV, osal_mem_free
        LOCFRAME CSTACK, 16, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        SUB.W   #0x8, SP
          CFI CFA SP+16
        MOV.W   #0x0, 0(SP)
        MOV.W   SP, R15
        ADD.W   #0x0, R15
        MOV.W   #0x2, R14
        MOV.W   #0x0, R13
        MOV.W   #0x4c, R12
        CALLA   #osal_nv_write
        MOV.W   #0x6, R14
        CALLA   #?Subroutine26
??CrossCallReturnLabel_13:
        MOV.W   #0x0, R10
??ZDSecMgrSetDefaultNV_0:
        MOV.W   SP, R15
        ADD.W   #0x2, R15
        MOV.W   #0x6, R14
        MOV.W   #0x2, R13
        RPT     #0x6
        ADDX.W  R10, R13
        MOV.W   #0x4c, R12
        CALLA   #osal_nv_write
        ADD.W   #0x1, R10
        CMP.W   #0x3, R10
        JNC     ??ZDSecMgrSetDefaultNV_0
        CALLA   #?Subroutine15
??CrossCallReturnLabel_3:
        MOV.W   R12, R11
        CMP.W   #0x0, R12
        JEQ     ??ZDSecMgrSetDefaultNV_2
        CALLA   #?Subroutine27
??CrossCallReturnLabel_15:
        MOV.W   #0x0, R10
??ZDSecMgrSetDefaultNV_1:
        CALLA   #?Subroutine28
??CrossCallReturnLabel_61:
        MOV.W   R10, R12
        ADD.W   #0x201, R12
        CALLA   #osal_nv_write
        ADD.W   #0x1, R10
        CMP.W   #0x3, R10
        JNC     ??ZDSecMgrSetDefaultNV_1
        MOV.W   R11, R12
        CALLA   #osal_mem_free
          CFI EndBlock cfiBlock49
??ZDSecMgrSetDefaultNV_2:
        REQUIRE ?Subroutine8
        // Fall through to label ?Subroutine8

        RSEG CODE:CODE:NOROOT(1)
?Subroutine8:
          CFI Block cfiBlock50 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+16
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
        ADD.W   #0x8, SP
          CFI CFA SP+8
        POPM.W  #0x2, R11
          CFI CFA SP+4
          CFI R10L SameValue
          CFI R11L SameValue
        RETA
          CFI EndBlock cfiBlock50

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAddLinkKey:
          CFI Block cfiBlock51 Using cfiCommon0
          CFI Function ZDSecMgrAddLinkKey
        FUNCALL ZDSecMgrAddLinkKey, ZDSecMgrAddrStore
        LOCFRAME CSTACK, 12, STACK
        FUNCALL ZDSecMgrAddLinkKey, ZDSecMgrEntryLookupAMI
        LOCFRAME CSTACK, 12, STACK
        FUNCALL ZDSecMgrAddLinkKey, ZDSecMgrEntryNew
        LOCFRAME CSTACK, 12, STACK
        FUNCALL ZDSecMgrAddLinkKey, APSME_LinkKeySet
        LOCFRAME CSTACK, 12, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        SUB.W   #0x4, SP
          CFI CFA SP+12
        MOV.W   R13, R10
        MOV.W   R14, R11
        MOV.W   SP, R14
        ADD.W   #0x2, R14
        CALLA   #ZDSecMgrAddrStore
        CMP.B   #0x0, R12
        JEQ     ??ZDSecMgrAddLinkKey_1
        MOV.B   #0x1, R12
        JMP     ??ZDSecMgrAddLinkKey_0
??ZDSecMgrAddLinkKey_1:
        MOV.W   SP, R13
        ADD.W   #0x0, R13
        MOV.W   0x2(SP), R12
        CALLA   #ZDSecMgrEntryLookupAMI
        CMP.W   #0x0, 0(SP)
        JNE     ??ZDSecMgrAddLinkKey_2
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #ZDSecMgrEntryNew
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrAddLinkKey_3
        MOV.W   @SP, R15
        MOV.W   0x2(SP), 0(R15)
??ZDSecMgrAddLinkKey_2:
        MOV.W   R11, R13
        MOV.W   R10, R12
        CALLA   #APSME_LinkKeySet
        MOV.B   #0x0, R12
??ZDSecMgrAddLinkKey_0:
        BRA     #?Subroutine9
??ZDSecMgrAddLinkKey_3:
        MOV.B   #0x11, R12
        JMP     ??ZDSecMgrAddLinkKey_0
          CFI EndBlock cfiBlock51

        RSEG CODE:CODE:NOROOT(1)
APSME_KeyFwdToChild:
          CFI Block cfiBlock52 Using cfiCommon0
          CFI Function APSME_KeyFwdToChild
        FUNCALL APSME_KeyFwdToChild, AssocGetWithExt
        LOCFRAME CSTACK, 4, STACK
        FUNCALL APSME_KeyFwdToChild, ZDSecMgrAssocDeviceAuth
        LOCFRAME CSTACK, 4, STACK
        CMP.W   #0x0, 0(R12)
        JNE     ??APSME_KeyFwdToChild_0
        MOV.B   0x2(R12), R14
        CMP.B   #0x1, R14
        JEQ     ??APSME_KeyFwdToChild_1
        CMP.B   #0x6, R14
        JEQ     ??APSME_KeyFwdToChild_1
        CMP.B   #0x5, R14
        JNE     ??APSME_KeyFwdToChild_2
??APSME_KeyFwdToChild_1:
        MOV.W   0x6(R12), R12
        CALLA   #AssocGetWithExt
        CALLA   #ZDSecMgrAssocDeviceAuth
??APSME_KeyFwdToChild_2:
        MOV.B   #0x1, R12
        RETA
??APSME_KeyFwdToChild_0:
        MOV.B   #0x0, R12
        RETA
          CFI EndBlock cfiBlock52

        RSEG CODE:CODE:NOROOT(1)
APSME_IsLinkKeyValid:
          CFI Block cfiBlock53 Using cfiCommon0
          CFI Function APSME_IsLinkKeyValid
        FUNCALL APSME_IsLinkKeyValid, osal_memset
        LOCFRAME CSTACK, 26, STACK
        FUNCALL APSME_IsLinkKeyValid, APSME_LinkKeyNVIdGet
        LOCFRAME CSTACK, 26, STACK
        FUNCALL APSME_IsLinkKeyValid, osal_mem_alloc
        LOCFRAME CSTACK, 26, STACK
        FUNCALL APSME_IsLinkKeyValid, osal_nv_read
        LOCFRAME CSTACK, 26, STACK
        FUNCALL APSME_IsLinkKeyValid, osal_memcmp
        LOCFRAME CSTACK, 26, STACK
        FUNCALL APSME_IsLinkKeyValid, osal_memset
        LOCFRAME CSTACK, 26, STACK
        FUNCALL APSME_IsLinkKeyValid, osal_mem_free
        LOCFRAME CSTACK, 26, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        SUB.W   #0x12, SP
          CFI CFA SP+26
        MOV.W   R12, R10
        MOV.B   #0x0, R11
        MOV.W   #0x10, R14
        CALLA   #?Subroutine26
??CrossCallReturnLabel_12:
        MOV.W   SP, R13
        ADD.W   #0x0, R13
        MOV.W   R10, R12
        CALLA   #APSME_LinkKeyNVIdGet
        CMP.W   #0x0, 0(SP)
        JEQ     ??APSME_IsLinkKeyValid_0
        CALLA   #?Subroutine14
??CrossCallReturnLabel_47:
        JEQ     ??APSME_IsLinkKeyValid_0
        MOV.W   R12, R15
        CALLA   #??Subroutine28_0
??CrossCallReturnLabel_57:
        MOV.W   @SP, R12
        CALLA   #osal_nv_read
        CMP.B   #0x0, R12
        JNE     ??APSME_IsLinkKeyValid_1
        MOV.W   #0x10, R14
        MOV.W   SP, R13
        ADD.W   #0x2, R13
        MOV.W   R10, R12
        CALLA   #osal_memcmp
        CMP.B   #0x0, R12
        JNE     ??APSME_IsLinkKeyValid_1
        MOV.B   #0x1, R11
??APSME_IsLinkKeyValid_1:
        CALLA   #?Subroutine22
??APSME_IsLinkKeyValid_0:
        MOV.B   R11, R12
        ADD.W   #0x12, SP
          CFI CFA SP+8
        POPM.W  #0x2, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock53

        RSEG CODE:CODE:NOROOT(1)
?Subroutine26:
          CFI Block cfiCond54 Using cfiCommon0
          CFI Function ZDSecMgrSetDefaultNV
          CFI Conditional ??CrossCallReturnLabel_13
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+20
          CFI Block cfiCond55 Using cfiCommon0
          CFI (cfiCond55) Function APSME_IsLinkKeyValid
          CFI (cfiCond55) Conditional ??CrossCallReturnLabel_12
          CFI (cfiCond55) R10L Frame(CFA, -8)
          CFI (cfiCond55) R11L Frame(CFA, -6)
          CFI (cfiCond55) CFA SP+30
          CFI Block cfiPicker56 Using cfiCommon1
          CFI (cfiPicker56) NoFunction
          CFI (cfiPicker56) Picker
        MOV.B   #0x0, R13
        MOV.W   SP, R12
        ADD.W   #0x6, R12
        BRA     #osal_memset
          CFI EndBlock cfiCond54
          CFI EndBlock cfiCond55
          CFI EndBlock cfiPicker56

        RSEG CODE:CODE:NOROOT(1)
?Subroutine22:
          CFI Block cfiCond57 Using cfiCommon0
          CFI Function ZDSecMgrSaveApsLinkKey
          CFI Conditional ??ZDSecMgrSaveApsLinkKey_1
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+16
          CFI Block cfiCond58 Using cfiCommon0
          CFI (cfiCond58) Function APSME_IsLinkKeyValid
          CFI (cfiCond58) Conditional ??APSME_IsLinkKeyValid_0
          CFI (cfiCond58) R10L Frame(CFA, -8)
          CFI (cfiCond58) R11L Frame(CFA, -6)
          CFI (cfiCond58) CFA SP+30
          CFI Block cfiPicker59 Using cfiCommon1
          CFI (cfiPicker59) NoFunction
          CFI (cfiPicker59) Picker
        MOV.W   #0x18, R14
        CALLA   #?Subroutine41
??CrossCallReturnLabel_71:
        MOV.W   R10, R12
        BRA     #osal_mem_free
          CFI EndBlock cfiCond57
          CFI EndBlock cfiCond58
          CFI EndBlock cfiPicker59

        RSEG CODE:CODE:NOROOT(1)
APSME_LinkKeyNVIdGet:
          CFI Block cfiBlock60 Using cfiCommon0
          CFI Function APSME_LinkKeyNVIdGet
        FUNCALL APSME_LinkKeyNVIdGet, ZDSecMgrEntryLookupExt
        LOCFRAME CSTACK, 8, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0x2, SP
          CFI CFA SP+8
        MOV.W   R13, R10
        CALLA   #?Subroutine34
??CrossCallReturnLabel_30:
        CMP.B   #0x0, R12
        JNE     ??APSME_LinkKeyNVIdGet_0
        MOV.W   @SP, R15
        MOV.W   0x2(R15), R15
        JMP     ??APSME_LinkKeyNVIdGet_1
??APSME_LinkKeyNVIdGet_0:
        MOV.W   #0x0, R15
??APSME_LinkKeyNVIdGet_1:
        MOV.W   R15, 0(R10)
          CFI EndBlock cfiBlock60
        REQUIRE ?Subroutine10
        // Fall through to label ?Subroutine10

        RSEG CODE:CODE:NOROOT(1)
?Subroutine10:
          CFI Block cfiBlock61 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+8
          CFI R10L Frame(CFA, -6)
        ADD.W   #0x2, SP
          CFI CFA SP+6
        POP.W   R10
          CFI CFA SP+4
          CFI R10L SameValue
        RETA
          CFI EndBlock cfiBlock61

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAuthenticationCheck:
          CFI Block cfiBlock62 Using cfiCommon0
          CFI Function ZDSecMgrAuthenticationCheck
        MOV.B   #0x1, R12
        RETA
          CFI EndBlock cfiBlock62

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAuthenticationSet:
          CFI Block cfiBlock63 Using cfiCommon0
          CFI Function ZDSecMgrAuthenticationSet
        FUNCALL ZDSecMgrAuthenticationSet, ZDSecMgrEntryLookupExt
        LOCFRAME CSTACK, 8, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0x2, SP
          CFI CFA SP+8
        MOV.B   R13, R10
        CALLA   #?Subroutine34
??CrossCallReturnLabel_29:
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrAuthenticationSet_0
        MOV.W   @SP, R15
        MOV.B   R10, 0x4(R15)
??ZDSecMgrAuthenticationSet_0:
        JMP     ?Subroutine10
          CFI EndBlock cfiBlock63

        RSEG CODE:CODE:NOROOT(1)
?Subroutine34:
          CFI Block cfiCond64 Using cfiCommon0
          CFI Function APSME_LinkKeyNVIdGet
          CFI Conditional ??CrossCallReturnLabel_30
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+12
          CFI Block cfiCond65 Using cfiCommon0
          CFI (cfiCond65) Function ZDSecMgrAuthenticationSet
          CFI (cfiCond65) Conditional ??CrossCallReturnLabel_29
          CFI (cfiCond65) R10L Frame(CFA, -6)
          CFI (cfiCond65) CFA SP+12
          CFI Block cfiCond66 Using cfiCommon0
          CFI (cfiCond66) Function ZDSecMgrDeviceRemoveByExtAddr
          CFI (cfiCond66) Conditional ??CrossCallReturnLabel_28
          CFI (cfiCond66) R10L Frame(CFA, -6)
          CFI (cfiCond66) CFA SP+12
          CFI Block cfiPicker67 Using cfiCommon1
          CFI (cfiPicker67) NoFunction
          CFI (cfiPicker67) Picker
        MOV.W   SP, R13
        ADD.W   #0x4, R13
        BRA     #ZDSecMgrEntryLookupExt
          CFI EndBlock cfiCond64
          CFI EndBlock cfiCond65
          CFI EndBlock cfiCond66
          CFI EndBlock cfiPicker67

        RSEG CODE:CODE:NOROOT(1)
APSME_LinkKeySet:
          CFI Block cfiBlock68 Using cfiCommon0
          CFI Function APSME_LinkKeySet
        FUNCALL APSME_LinkKeySet, ZDSecMgrEntryLookupExtGetIndex
        LOCFRAME CSTACK, 16, STACK
        FUNCALL APSME_LinkKeySet, osal_mem_alloc
        LOCFRAME CSTACK, 16, STACK
        FUNCALL APSME_LinkKeySet, osal_nv_read
        LOCFRAME CSTACK, 16, STACK
        FUNCALL APSME_LinkKeySet, osal_memcpy
        LOCFRAME CSTACK, 16, STACK
        FUNCALL APSME_LinkKeySet, osal_nv_write
        LOCFRAME CSTACK, 16, STACK
        FUNCALL APSME_LinkKeySet, osal_memset
        LOCFRAME CSTACK, 16, STACK
        FUNCALL APSME_LinkKeySet, osal_mem_free
        LOCFRAME CSTACK, 16, STACK
        PUSHM.W #0x4, R11
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+12
        SUB.W   #0x4, SP
          CFI CFA SP+16
        MOV.W   R13, R11
        MOV.W   SP, R14
        ADD.W   #0x2, R14
        MOV.W   SP, R13
        ADD.W   #0x0, R13
        CALLA   #ZDSecMgrEntryLookupExtGetIndex
        MOV.B   R12, R10
        CMP.B   #0x0, R12
        JNE     ??APSME_LinkKeySet_0
        MOV.W   0x2(SP), R15
        ADD.W   #0x201, R15
        MOV.W   @SP, R14
        MOV.W   R15, 0x2(R14)
        CALLA   #?Subroutine15
??CrossCallReturnLabel_2:
        MOV.W   R12, R8
        CMP.W   #0x0, R12
        JEQ     ??APSME_LinkKeySet_0
        MOV.W   R12, R15
        CALLA   #??Subroutine28_0
??CrossCallReturnLabel_58:
        MOV.W   @SP, R12
        MOV.W   0x2(R12), R12
        CALLA   #osal_nv_read
        MOV.W   #0x10, R14
        MOV.W   R11, R13
        MOV.W   R8, R12
        CALLA   #osal_memcpy
        MOV.W   #0x0, 0x14(R8)
        MOV.W   #0x0, 0x16(R8)
        MOV.W   #0x0, 0x10(R8)
        MOV.W   #0x0, 0x12(R8)
        MOV.W   R8, R15
        CALLA   #??Subroutine28_0
??CrossCallReturnLabel_59:
        MOV.W   @SP, R11
        MOV.W   0x2(R11), R12
        CALLA   #osal_nv_write
        MOV.W   #0x18, R14
        MOV.B   #0x0, R13
        MOV.W   R8, R12
        CALLA   #osal_memset
        MOV.W   R8, R12
        CALLA   #osal_mem_free
        MOV.W   @SP, R15
        MOV.W   0x2(R15), R11
        MOV.W   R11, R15
        RPT     #0x9
        ADDX.W  R11, R15
        MOV.W   #0x0, LWRD(ApsLinkKeyFrmCntr - 5130)(R15)
        MOV.W   #0x0, LWRD(ApsLinkKeyFrmCntr - 5128)(R15)
        MOV.W   #0x0, LWRD(ApsLinkKeyFrmCntr - 5126)(R15)
        MOV.W   #0x0, LWRD(ApsLinkKeyFrmCntr - 5124)(R15)
??APSME_LinkKeySet_0:
        MOV.B   R10, R12
        ADD.W   #0x4, SP
          CFI CFA SP+12
        POPM.W  #0x4, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI R8L SameValue
          CFI R9L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock68

        RSEG CODE:CODE:NOROOT(1)
APSME_MasterKeyGet:
          CFI Block cfiBlock69 Using cfiCommon0
          CFI Function APSME_MasterKeyGet
        FUNCALL APSME_MasterKeyGet, ZDSecMgrExtAddrLookup
        LOCFRAME CSTACK, 10, STACK
        FUNCALL APSME_MasterKeyGet, ZDSecMgrMasterKeyLookup
        LOCFRAME CSTACK, 10, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        SUB.W   #0x2, SP
          CFI CFA SP+10
        CALLA   #?Subroutine31
??CrossCallReturnLabel_17:
        JNE     ??APSME_MasterKeyGet_0
        MOV.W   R10, R13
        MOV.W   @SP, R12
        CALLA   #ZDSecMgrMasterKeyLookup
        JMP     ??APSME_MasterKeyGet_1
??APSME_MasterKeyGet_0:
        MOV.W   #0x0, 0(R10)
??APSME_MasterKeyGet_1:
        BRA     #?Subroutine2
          CFI EndBlock cfiBlock69

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrSetupPartner:
          CFI Block cfiBlock70 Using cfiCommon0
          CFI Function ZDSecMgrSetupPartner
        FUNCALL ZDSecMgrSetupPartner, AddrMgrExtAddrSet
        LOCFRAME CSTACK, 26, STACK
        FUNCALL ZDSecMgrSetupPartner, AddrMgrEntryUpdate
        LOCFRAME CSTACK, 26, STACK
        FUNCALL ZDSecMgrSetupPartner, ZDP_NwkAddrReq
        LOCFRAME CSTACK, 26, STACK
        FUNCALL ZDSecMgrSetupPartner, AddrMgrExtAddrValid
        LOCFRAME CSTACK, 26, STACK
        FUNCALL ZDSecMgrSetupPartner, ZDP_IEEEAddrReq
        LOCFRAME CSTACK, 26, STACK
        PUSHM.W #0x4, R11
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+12
        SUB.W   #0xe, SP
          CFI CFA SP+26
        MOV.W   R12, R10
        MOV.W   R13, R11
        MOV.B   #0x1, R8
        CALLA   #?Subroutine30
??CrossCallReturnLabel_16:
        CMP.B   #0x1, R12
        JNE     ??ZDSecMgrSetupPartner_0
        MOV.B   #0x0, R8
        CMP.W   #0xfffe, R10
        JNE     ??ZDSecMgrSetupPartner_1
        MOV.B   #0x0, R15
        MOV.B   #0x0, R14
        MOV.B   #0x0, R13
        MOV.W   R11, R12
        CALLA   #ZDP_NwkAddrReq
        JMP     ??ZDSecMgrSetupPartner_2
??ZDSecMgrSetupPartner_1:
        MOV.W   R11, R12
        CALLA   #AddrMgrExtAddrValid
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrSetupPartner_0
        MOV.B   #0x0, R15
        MOV.B   #0x0, R14
        MOV.B   #0x0, R13
        MOV.W   R10, R12
        CALLA   #ZDP_IEEEAddrReq
??ZDSecMgrSetupPartner_2:
        MOV.B   R12, R8
??ZDSecMgrSetupPartner_0:
        MOV.B   R8, R12
        ADD.W   #0xe, SP
          CFI CFA SP+12
        POPM.W  #0x4, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI R8L SameValue
          CFI R9L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock70

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrRequestAppKey:
          CFI Block cfiBlock71 Using cfiCommon0
          CFI Function ZDSecMgrRequestAppKey
        FUNCALL ZDSecMgrRequestAppKey, APSME_RequestKeyReq
        LOCFRAME CSTACK, 8, STACK
        SUB.W   #0x4, SP
          CFI CFA SP+8
        MOV.B   #0x0, 0(SP)
        MOV.B   #0x2, 0x1(SP)
        MOV.W   R12, 0x2(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #APSME_RequestKeyReq
        ADD.W   #0x4, SP
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock71

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAuthenticateCfm:
          CFI Block cfiBlock72 Using cfiCommon0
          CFI Function ZDSecMgrAuthenticateCfm
        FUNCALL ZDSecMgrAuthenticateCfm, osal_set_event
        LOCFRAME CSTACK, 4, STACK
        CMP.B   #0x0, 0xb(R12)
        JNE     ??ZDSecMgrAuthenticateCfm_0
        CMP.B   #0x1, 0x2(R12)
        JNE     ??ZDSecMgrAuthenticateCfm_0
        CALLA   #?Subroutine16
??ZDSecMgrAuthenticateCfm_0:
        RETA
          CFI EndBlock cfiBlock72

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAuthenticateInd:
          CFI Block cfiBlock73 Using cfiCommon0
          CFI Function ZDSecMgrAuthenticateInd
        FUNCALL ZDSecMgrAuthenticateInd, AddrMgrExtAddrSet
        LOCFRAME CSTACK, 28, STACK
        FUNCALL ZDSecMgrAuthenticateInd, AddrMgrEntryUpdate
        LOCFRAME CSTACK, 28, STACK
        FUNCALL ZDSecMgrAuthenticateInd, APSME_AuthenticateReq
        LOCFRAME CSTACK, 28, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0x16, SP
          CFI CFA SP+28
        MOV.W   R12, R10
        MOV.B   #0x2, 0x8(SP)
        MOV.W   0x2(R12), 0xa(SP)
        MOV.W   R12, R13
        ADD.W   #0x4, R13
        MOV.W   SP, R12
        ADD.W   #0xc, R12
        CALLA   #AddrMgrExtAddrSet
        MOV.W   SP, R12
        ADD.W   #0x8, R12
        CALLA   #AddrMgrEntryUpdate
        CMP.B   #0x1, R12
        JNE     ??ZDSecMgrAuthenticateInd_0
        CALLA   #?Subroutine37
??CrossCallReturnLabel_36:
        MOV.B   #0x1, 0x6(SP)
        ADD.W   #0xc, R10
        MOV.W   R10, 0x4(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #APSME_AuthenticateReq
??ZDSecMgrAuthenticateInd_0:
        ADD.W   #0x16, SP
          CFI CFA SP+6
        POP.W   R10
          CFI R10L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock73

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrSwitchKeyInd:
          CFI Block cfiBlock74 Using cfiCommon0
          CFI Function ZDSecMgrSwitchKeyInd
        FUNCALL ZDSecMgrSwitchKeyInd, SSP_SwitchNwkKey
        LOCFRAME CSTACK, 4, STACK
        FUNCALL ZDSecMgrSwitchKeyInd, ZDApp_NVUpdate
        LOCFRAME CSTACK, 4, STACK
        MOV.B   0x4(R12), R12
        CALLA   #SSP_SwitchNwkKey
        BRA     #ZDApp_NVUpdate
          CFI EndBlock cfiBlock74

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrRequestKeyInd:
          CFI Block cfiBlock75 Using cfiCommon0
          CFI Function ZDSecMgrRequestKeyInd
        FUNCALL ZDSecMgrRequestKeyInd, ZDSecMgrAppKeyReq
        LOCFRAME CSTACK, 4, STACK
        MOV.B   0x4(R12), R14
        CMP.B   #0x1, R14
        JEQ     ??ZDSecMgrRequestKeyInd_0
        CMP.B   #0x2, R14
        JNE     ??ZDSecMgrRequestKeyInd_0
        CALLA   #ZDSecMgrAppKeyReq
??ZDSecMgrRequestKeyInd_0:
        RETA
          CFI EndBlock cfiBlock75

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrRemoveDeviceInd:
          CFI Block cfiBlock76 Using cfiCommon0
          CFI Function ZDSecMgrRemoveDeviceInd
        FUNCALL ZDSecMgrRemoveDeviceInd, APSME_LookupNwkAddr
        LOCFRAME CSTACK, 16, STACK
        FUNCALL ZDSecMgrRemoveDeviceInd, NLME_GetShortAddr
        LOCFRAME CSTACK, 16, STACK
        FUNCALL ZDSecMgrRemoveDeviceInd, ZDSecMgrDeviceRemove
        LOCFRAME CSTACK, 16, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0xa, SP
          CFI CFA SP+16
        MOV.W   R12, R10
        CMP.W   #0x0, 0x2(R12)
        JNE     ??ZDSecMgrRemoveDeviceInd_0
        MOV.W   SP, R13
        ADD.W   #0x0, R13
        ADD.W   #0x4, R12
        CALLA   #APSME_LookupNwkAddr
        CMP.B   #0x1, R12
        JNE     ??ZDSecMgrRemoveDeviceInd_0
        CALLA   #NLME_GetShortAddr
        MOV.W   R12, 0x4(SP)
        ADD.W   #0x4, R10
        MOV.W   R10, 0x2(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #ZDSecMgrDeviceRemove
          CFI EndBlock cfiBlock76
??ZDSecMgrRemoveDeviceInd_0:
        REQUIRE ?Subroutine4
        // Fall through to label ?Subroutine4

        RSEG CODE:CODE:NOROOT(1)
?Subroutine4:
          CFI Block cfiBlock77 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+16
          CFI R10L Frame(CFA, -6)
        ADD.W   #0xa, SP
          CFI CFA SP+6
        POP.W   R10
          CFI CFA SP+4
          CFI R10L SameValue
        RETA
          CFI EndBlock cfiBlock77

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrUpdateDeviceInd:
          CFI Block cfiBlock78 Using cfiCommon0
          CFI Function ZDSecMgrUpdateDeviceInd
        FUNCALL ZDSecMgrUpdateDeviceInd, ZDSecMgrDeviceJoin
        LOCFRAME CSTACK, 14, STACK
        SUB.W   #0xa, SP
          CFI CFA SP+14
        MOV.W   0xc(R12), 0(SP)
        MOV.W   R12, R15
        ADD.W   #0x4, R15
        MOV.W   R15, 0x2(SP)
        MOV.W   0x2(R12), 0x4(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #ZDSecMgrDeviceJoin
        JMP     ?Subroutine13
          CFI EndBlock cfiBlock78

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrTransportKeyInd:
          CFI Block cfiBlock79 Using cfiCommon0
          CFI Function ZDSecMgrTransportKeyInd
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrTCDataLoad
        LOCFRAME CSTACK, 22, STACK
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrReadKeyFromNv
        LOCFRAME CSTACK, 22, STACK
        FUNCALL ZDSecMgrTransportKeyInd, SSP_UpdateNwkKey
        LOCFRAME CSTACK, 22, STACK
        FUNCALL ZDSecMgrTransportKeyInd, SSP_SwitchNwkKey
        LOCFRAME CSTACK, 22, STACK
        FUNCALL ZDSecMgrTransportKeyInd, osal_memset
        LOCFRAME CSTACK, 22, STACK
        FUNCALL ZDSecMgrTransportKeyInd, SSP_UpdateNwkKey
        LOCFRAME CSTACK, 22, STACK
        FUNCALL ZDSecMgrTransportKeyInd, SSP_SwitchNwkKey
        LOCFRAME CSTACK, 22, STACK
        FUNCALL ZDSecMgrTransportKeyInd, ZDSecMgrAuthNwkKey
        LOCFRAME CSTACK, 22, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0x10, SP
          CFI CFA SP+22
        MOV.W   R12, R10
        ADD.W   #0x16, R12
        CALLA   #ZDSecMgrTCDataLoad
        MOV.B   0x4(R10), R14
        CMP.B   #0x0, R14
        JEQ     ??ZDSecMgrTransportKeyInd_1
        CMP.B   #0x1, R14
        JEQ     ??ZDSecMgrTransportKeyInd_2
        CMP.B   #0x6, R14
        JEQ     ??ZDSecMgrTransportKeyInd_2
        CMP.B   #0x5, R14
        JNE     ??ZDSecMgrTransportKeyInd_1
??ZDSecMgrTransportKeyInd_2:
        MOV.B   #0x0, R15
??ZDSecMgrTransportKeyInd_0:
        MOV.W   R10, R14
        ADD.W   R15, R14
        CMP.B   #0x0, 0x6(R14)
        JNE     ??ZDSecMgrTransportKeyInd_3
        ADD.B   #0x1, R15
        CMP.B   #0x10, R15
        JNC     ??ZDSecMgrTransportKeyInd_0
??ZDSecMgrTransportKeyInd_3:
        CMP.B   #0x10, R15
        JNE     ??ZDSecMgrTransportKeyInd_4
        CMP.B   #0x0, &_NIB + 65
        JNE     ??ZDSecMgrTransportKeyInd_5
        MOV.W   SP, R10
        ADD.W   #0x0, R10
        MOV.W   R10, R13
        MOV.W   #0x62, R12
        CALLA   #ZDSecMgrReadKeyFromNv
        MOV.B   #0x0, R13
        MOV.W   R10, R12
        CALLA   #SSP_UpdateNwkKey
        MOV.B   #0x0, R12
        CALLA   #SSP_SwitchNwkKey
        CALLA   #?Subroutine23
??CrossCallReturnLabel_68:
        JMP     ??ZDSecMgrTransportKeyInd_5
??ZDSecMgrTransportKeyInd_4:
        MOV.B   0x5(R10), R13
        MOV.W   R10, R12
        ADD.W   #0x6, R12
        CALLA   #SSP_UpdateNwkKey
        CMP.B   #0x0, &_NIB + 65
        JNE     ??ZDSecMgrTransportKeyInd_5
        MOV.B   0x5(R10), R12
        CALLA   #SSP_SwitchNwkKey
??ZDSecMgrTransportKeyInd_5:
        CALLA   #ZDSecMgrAuthNwkKey
          CFI EndBlock cfiBlock79
??ZDSecMgrTransportKeyInd_1:
        REQUIRE ?Subroutine5
        // Fall through to label ?Subroutine5

        RSEG CODE:CODE:NOROOT(1)
?Subroutine5:
          CFI Block cfiBlock80 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+22
          CFI R10L Frame(CFA, -6)
        ADD.W   #0x10, SP
          CFI CFA SP+6
        POP.W   R10
          CFI CFA SP+4
          CFI R10L SameValue
        RETA
          CFI EndBlock cfiBlock80

        RSEG CODE:CODE:NOROOT(1)
?Subroutine23:
          CFI Block cfiCond81 Using cfiCommon0
          CFI Function ZDSecMgrTransportKeyInd
          CFI Conditional ??CrossCallReturnLabel_68
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+26
          CFI Block cfiCond82 Using cfiCommon0
          CFI (cfiCond82) Function ZDSecMgrTCDataLoad
          CFI (cfiCond82) Conditional ??ZDSecMgrTCDataLoad_0
          CFI (cfiCond82) R10L Frame(CFA, -6)
          CFI (cfiCond82) CFA SP+44
          CFI Block cfiPicker83 Using cfiCommon1
          CFI (cfiPicker83) NoFunction
          CFI (cfiPicker83) Picker
        MOV.W   #0x10, R14
          CFI EndBlock cfiCond81
          CFI EndBlock cfiCond82
          CFI EndBlock cfiPicker83
        REQUIRE ?Subroutine41
        // Fall through to label ?Subroutine41

        RSEG CODE:CODE:NOROOT(1)
?Subroutine41:
          CFI Block cfiCond84 Using cfiCommon0
          CFI Function ZDSecMgrSaveTCLinkKey
          CFI Conditional ??CrossCallReturnLabel_4
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+10
          CFI Block cfiCond85 Using cfiCommon0
          CFI (cfiCond85) Function APSME_TCLinkKeySync
          CFI (cfiCond85) Conditional ??CrossCallReturnLabel_5
          CFI (cfiCond85) R8L Frame(CFA, -12)
          CFI (cfiCond85) R9L Frame(CFA, -10)
          CFI (cfiCond85) R10L Frame(CFA, -8)
          CFI (cfiCond85) R11L Frame(CFA, -6)
          CFI (cfiCond85) CFA SP+48
          CFI Block cfiCond86 Using cfiCommon0
          CFI (cfiCond86) Function APSME_TCLinkKeyInit
          CFI (cfiCond86) Conditional ??CrossCallReturnLabel_6
          CFI (cfiCond86) R10L Frame(CFA, -6)
          CFI (cfiCond86) CFA SP+42
          CFI Block cfiCond87 Using cfiCommon0
          CFI (cfiCond87) Function APSME_TCLinkKeyInit
          CFI (cfiCond87) Conditional ??CrossCallReturnLabel_7
          CFI (cfiCond87) R10L Frame(CFA, -6)
          CFI (cfiCond87) CFA SP+42
          CFI Block cfiCond88 Using cfiCommon0
          CFI (cfiCond88) Function ZDSecMgrSaveApsLinkKey
          CFI (cfiCond88) Conditional ??CrossCallReturnLabel_71, ??ZDSecMgrSaveApsLinkKey_1
          CFI (cfiCond88) R8L Frame(CFA, -12)
          CFI (cfiCond88) R9L Frame(CFA, -10)
          CFI (cfiCond88) R10L Frame(CFA, -8)
          CFI (cfiCond88) R11L Frame(CFA, -6)
          CFI (cfiCond88) CFA SP+20
          CFI Block cfiCond89 Using cfiCommon0
          CFI (cfiCond89) Function APSME_IsLinkKeyValid
          CFI (cfiCond89) Conditional ??CrossCallReturnLabel_71, ??APSME_IsLinkKeyValid_0
          CFI (cfiCond89) R10L Frame(CFA, -8)
          CFI (cfiCond89) R11L Frame(CFA, -6)
          CFI (cfiCond89) CFA SP+34
          CFI Block cfiCond90 Using cfiCommon0
          CFI (cfiCond90) Function ZDSecMgrTransportKeyInd
          CFI (cfiCond90) Conditional ??CrossCallReturnLabel_68
          CFI (cfiCond90) R10L Frame(CFA, -6)
          CFI (cfiCond90) CFA SP+26
          CFI Block cfiCond91 Using cfiCommon0
          CFI (cfiCond91) Function ZDSecMgrTCDataLoad
          CFI (cfiCond91) Conditional ??ZDSecMgrTCDataLoad_0
          CFI (cfiCond91) R10L Frame(CFA, -6)
          CFI (cfiCond91) CFA SP+44
          CFI Block cfiCond92 Using cfiCommon0
          CFI (cfiCond92) Function ZDSecMgrNwkKeyInit
          CFI (cfiCond92) Conditional ??CrossCallReturnLabel_69
          CFI (cfiCond92) R10L Frame(CFA, -8)
          CFI (cfiCond92) R11L Frame(CFA, -6)
          CFI (cfiCond92) CFA SP+52
          CFI Block cfiCond93 Using cfiCommon0
          CFI (cfiCond93) Function ZDSecMgrNwkKeyInit
          CFI (cfiCond93) Conditional ??CrossCallReturnLabel_70
          CFI (cfiCond93) R10L Frame(CFA, -8)
          CFI (cfiCond93) R11L Frame(CFA, -6)
          CFI (cfiCond93) CFA SP+52
          CFI Block cfiPicker94 Using cfiCommon1
          CFI (cfiPicker94) NoFunction
          CFI (cfiPicker94) Picker
        MOV.B   #0x0, R13
          CFI EndBlock cfiCond84
          CFI EndBlock cfiCond85
          CFI EndBlock cfiCond86
          CFI EndBlock cfiCond87
          CFI EndBlock cfiCond88
          CFI EndBlock cfiCond89
          CFI EndBlock cfiCond90
          CFI EndBlock cfiCond91
          CFI EndBlock cfiCond92
          CFI EndBlock cfiCond93
          CFI EndBlock cfiPicker94
        REQUIRE ??Subroutine46_0
        // Fall through to label ??Subroutine46_0

        RSEG CODE:CODE:NOROOT(1)
??Subroutine46_0:
          CFI Block cfiCond95 Using cfiCommon0
          CFI Function APSME_TCLinkKeyInit
          CFI Conditional ??CrossCallReturnLabel_67
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+42
          CFI Block cfiCond96 Using cfiCommon0
          CFI (cfiCond96) Function ZDSecMgrSaveTCLinkKey
          CFI (cfiCond96) Conditional ??CrossCallReturnLabel_4
          CFI (cfiCond96) R10L Frame(CFA, -6)
          CFI (cfiCond96) CFA SP+10
          CFI Block cfiCond97 Using cfiCommon0
          CFI (cfiCond97) Function APSME_TCLinkKeySync
          CFI (cfiCond97) Conditional ??CrossCallReturnLabel_5
          CFI (cfiCond97) R8L Frame(CFA, -12)
          CFI (cfiCond97) R9L Frame(CFA, -10)
          CFI (cfiCond97) R10L Frame(CFA, -8)
          CFI (cfiCond97) R11L Frame(CFA, -6)
          CFI (cfiCond97) CFA SP+48
          CFI Block cfiCond98 Using cfiCommon0
          CFI (cfiCond98) Function APSME_TCLinkKeyInit
          CFI (cfiCond98) Conditional ??CrossCallReturnLabel_6
          CFI (cfiCond98) R10L Frame(CFA, -6)
          CFI (cfiCond98) CFA SP+42
          CFI Block cfiCond99 Using cfiCommon0
          CFI (cfiCond99) Function APSME_TCLinkKeyInit
          CFI (cfiCond99) Conditional ??CrossCallReturnLabel_7
          CFI (cfiCond99) R10L Frame(CFA, -6)
          CFI (cfiCond99) CFA SP+42
          CFI Block cfiCond100 Using cfiCommon0
          CFI (cfiCond100) Function ZDSecMgrSaveApsLinkKey
          CFI (cfiCond100) Conditional ??CrossCallReturnLabel_71, ??ZDSecMgrSaveApsLinkKey_1
          CFI (cfiCond100) R8L Frame(CFA, -12)
          CFI (cfiCond100) R9L Frame(CFA, -10)
          CFI (cfiCond100) R10L Frame(CFA, -8)
          CFI (cfiCond100) R11L Frame(CFA, -6)
          CFI (cfiCond100) CFA SP+20
          CFI Block cfiCond101 Using cfiCommon0
          CFI (cfiCond101) Function APSME_IsLinkKeyValid
          CFI (cfiCond101) Conditional ??CrossCallReturnLabel_71, ??APSME_IsLinkKeyValid_0
          CFI (cfiCond101) R10L Frame(CFA, -8)
          CFI (cfiCond101) R11L Frame(CFA, -6)
          CFI (cfiCond101) CFA SP+34
          CFI Block cfiCond102 Using cfiCommon0
          CFI (cfiCond102) Function ZDSecMgrTransportKeyInd
          CFI (cfiCond102) Conditional ??CrossCallReturnLabel_68
          CFI (cfiCond102) R10L Frame(CFA, -6)
          CFI (cfiCond102) CFA SP+26
          CFI Block cfiCond103 Using cfiCommon0
          CFI (cfiCond103) Function ZDSecMgrTCDataLoad
          CFI (cfiCond103) Conditional ??ZDSecMgrTCDataLoad_0
          CFI (cfiCond103) R10L Frame(CFA, -6)
          CFI (cfiCond103) CFA SP+44
          CFI Block cfiCond104 Using cfiCommon0
          CFI (cfiCond104) Function ZDSecMgrNwkKeyInit
          CFI (cfiCond104) Conditional ??CrossCallReturnLabel_69
          CFI (cfiCond104) R10L Frame(CFA, -8)
          CFI (cfiCond104) R11L Frame(CFA, -6)
          CFI (cfiCond104) CFA SP+52
          CFI Block cfiCond105 Using cfiCommon0
          CFI (cfiCond105) Function ZDSecMgrNwkKeyInit
          CFI (cfiCond105) Conditional ??CrossCallReturnLabel_70
          CFI (cfiCond105) R10L Frame(CFA, -8)
          CFI (cfiCond105) R11L Frame(CFA, -6)
          CFI (cfiCond105) CFA SP+52
          CFI Block cfiPicker106 Using cfiCommon1
          CFI (cfiPicker106) NoFunction
          CFI (cfiPicker106) Picker
        MOV.W   R10, R12
        BRA     #osal_memset
          CFI EndBlock cfiCond95
          CFI EndBlock cfiCond96
          CFI EndBlock cfiCond97
          CFI EndBlock cfiCond98
          CFI EndBlock cfiCond99
          CFI EndBlock cfiCond100
          CFI EndBlock cfiCond101
          CFI EndBlock cfiCond102
          CFI EndBlock cfiCond103
          CFI EndBlock cfiCond104
          CFI EndBlock cfiCond105
          CFI EndBlock cfiPicker106

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrEstablishKeyInd:
          CFI Block cfiBlock107 Using cfiCommon0
          CFI Function ZDSecMgrEstablishKeyInd
        FUNCALL ZDSecMgrEstablishKeyInd, ZDSecMgrTCDataLoad
        LOCFRAME CSTACK, 24, STACK
        FUNCALL ZDSecMgrEstablishKeyInd, ZDSecMgrTCExtAddrCheck
        LOCFRAME CSTACK, 24, STACK
        FUNCALL ZDSecMgrEstablishKeyInd, ZDSecMgrDeviceValidateSKKE
        LOCFRAME CSTACK, 24, STACK
        FUNCALL ZDSecMgrEstablishKeyInd, APSME_EstablishKeyRsp
        LOCFRAME CSTACK, 24, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0x12, SP
          CFI CFA SP+24
        MOV.W   R12, R10
        ADD.W   #0x4, R12
        CALLA   #ZDSecMgrTCDataLoad
        MOV.W   R10, R12
        ADD.W   #0x4, R12
        CALLA   #ZDSecMgrTCExtAddrCheck
        CMP.B   #0x0, R12
        JEQ     ??ZDSecMgrEstablishKeyInd_0
        MOV.W   #0x0, 0x8(SP)
        MOV.W   0x2(R10), 0xc(SP)
        JMP     ??ZDSecMgrEstablishKeyInd_1
??ZDSecMgrEstablishKeyInd_0:
        MOV.W   0x2(R10), 0x8(SP)
        MOV.W   #0xfffe, 0xc(SP)
??ZDSecMgrEstablishKeyInd_1:
        MOV.W   R10, R15
        ADD.W   #0x4, R15
        MOV.W   R15, 0xa(SP)
        MOV.B   0xe(R10), 0xe(SP)
        MOV.W   SP, R12
        ADD.W   #0x8, R12
        CALLA   #ZDSecMgrDeviceValidateSKKE
        CMP.B   #0x0, R12
        JEQ     ??ZDSecMgrEstablishKeyInd_2
        MOV.B   #0x0, R14
        JMP     ??ZDSecMgrEstablishKeyInd_3
??ZDSecMgrEstablishKeyInd_2:
        MOV.B   #0x1, R14
??ZDSecMgrEstablishKeyInd_3:
        MOV.B   R14, 0x4(SP)
        CALLA   #?Subroutine37
??CrossCallReturnLabel_37:
        MOV.B   0xd(R10), 0x5(SP)
        MOV.B   0xe(R10), 0x6(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #APSME_EstablishKeyRsp
        ADD.W   #0x12, SP
          CFI CFA SP+6
        POP.W   R10
          CFI R10L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock107

        RSEG CODE:CODE:NOROOT(1)
?Subroutine37:
          CFI Block cfiCond108 Using cfiCommon0
          CFI Function ZDSecMgrAuthenticateInd
          CFI Conditional ??CrossCallReturnLabel_36
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+32
          CFI Block cfiCond109 Using cfiCommon0
          CFI (cfiCond109) Function ZDSecMgrEstablishKeyInd
          CFI (cfiCond109) Conditional ??CrossCallReturnLabel_37
          CFI (cfiCond109) R10L Frame(CFA, -6)
          CFI (cfiCond109) CFA SP+28
          CFI Block cfiPicker110 Using cfiCommon1
          CFI (cfiPicker110) NoFunction
          CFI (cfiPicker110) Picker
        MOV.W   0x2(R10), 0x4(SP)
        MOV.W   R10, R15
        ADD.W   #0x4, R15
        MOV.W   R15, 0x6(SP)
        RETA
          CFI EndBlock cfiCond108
          CFI EndBlock cfiCond109
          CFI EndBlock cfiPicker110

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrTCDataLoad:
          CFI Block cfiBlock111 Using cfiCommon0
          CFI Function ZDSecMgrTCDataLoad
        FUNCALL ZDSecMgrTCDataLoad, AddrMgrEntryLookupNwk
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrTCDataLoad, ZDSecMgrAddrStore
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrTCDataLoad, ZDSecMgrMasterKeyLookup
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrTCDataLoad, osal_memcpy
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrTCDataLoad, ZDSecMgrMasterKeyStore
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrTCDataLoad, osal_memset
        LOCFRAME CSTACK, 40, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0x22, SP
          CFI CFA SP+40
        MOV.W   R12, R10
        MOV.B   #0x0, 0x4(SP)
        MOV.W   &zgTrustCenterAddr, 0x6(SP)
        MOV.W   SP, R12
        ADD.W   #0x4, R12
        CALLA   #AddrMgrEntryLookupNwk
        CMP.B   #0x1, R12
        JEQ     ??ZDSecMgrTCDataLoad_0
        MOV.W   SP, R14
        ADD.W   #0x0, R14
        MOV.W   R10, R13
        MOV.W   &zgTrustCenterAddr, R12
        CALLA   #ZDSecMgrAddrStore
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrTCDataLoad_0
        CMP.B   #0x1, &zgPreConfigKeys
        JNE     ??ZDSecMgrTCDataLoad_0
        CALLA   #?Subroutine33
??CrossCallReturnLabel_25:
        JEQ     ??ZDSecMgrTCDataLoad_0
        MOV.W   SP, R10
        ADD.W   #0x12, R10
        MOV.W   #0x10, R14
        MOV.W   #ZDSecMgrTCMasterKey, R13
        MOV.W   R10, R12
        CALLA   #osal_memcpy
        MOV.W   R10, R13
        MOV.W   @SP, R12
        CALLA   #ZDSecMgrMasterKeyStore
        CALLA   #?Subroutine23
??ZDSecMgrTCDataLoad_0:
        ADD.W   #0x22, SP
          CFI CFA SP+6
        POP.W   R10
          CFI R10L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock111

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrTCExtAddrCheck:
          CFI Block cfiBlock112 Using cfiCommon0
          CFI Function ZDSecMgrTCExtAddrCheck
        FUNCALL ZDSecMgrTCExtAddrCheck, AddrMgrExtAddrLookup
        LOCFRAME CSTACK, 16, STACK
        FUNCALL ZDSecMgrTCExtAddrCheck, AddrMgrExtAddrEqual
        LOCFRAME CSTACK, 16, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        SUB.W   #0x8, SP
          CFI CFA SP+16
        MOV.W   R12, R10
        MOV.B   #0x0, R11
        MOV.W   SP, R13
        ADD.W   #0x0, R13
        MOV.W   #0x0, R12
        CALLA   #AddrMgrExtAddrLookup
        CMP.B   #0x0, R12
        JEQ     ??ZDSecMgrTCExtAddrCheck_0
        MOV.W   R10, R13
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #AddrMgrExtAddrEqual
        MOV.B   R12, R11
??ZDSecMgrTCExtAddrCheck_0:
        MOV.B   R11, R12
        BRA     #?Subroutine8
          CFI EndBlock cfiBlock112

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrEstablishKeyCfm:
          CFI Block cfiBlock113 Using cfiCommon0
          CFI Function ZDSecMgrEstablishKeyCfm
        RETA
          CFI EndBlock cfiBlock113

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrEvent:
          CFI Block cfiBlock114 Using cfiCommon0
          CFI Function ZDSecMgrEvent
        FUNCALL ZDSecMgrEvent, AddrMgrEntryGet
        LOCFRAME CSTACK, 36, STACK
        FUNCALL ZDSecMgrEvent, ZDSecMgrDeviceCtrlHandler
        LOCFRAME CSTACK, 36, STACK
        FUNCALL ZDSecMgrEvent, osal_start_timerEx
        LOCFRAME CSTACK, 36, STACK
        PUSHM.W #0x4, R11
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+12
        SUB.W   #0x18, SP
          CFI CFA SP+36
        CMP.W   #0x0, &ZDSecMgrCtrlData
        JEQ     ??ZDSecMgrEvent_1
        MOV.B   #0x0, R8
        MOV.B   #0x0, R10
        MOV.W   #0x0, R11
??ZDSecMgrEvent_0:
        MOV.W   R11, R15
        RLAM.W  #0x3, R15
        MOV.W   &ZDSecMgrCtrlData, R14
        ADD.W   R15, R14
        CMP.B   #0x0, 0x5(R14)
        JEQ     ??ZDSecMgrEvent_2
        CMP.B   #0x0, 0x6(R14)
        JEQ     ??ZDSecMgrEvent_3
        ADD.B   #0xff, 0x6(R14)
??ZDSecMgrEvent_3:
        BIT.B   #0x1, R8
        JC      ??ZDSecMgrEvent_4
        MOV.W   &ZDSecMgrCtrlData, R14
        ADD.W   R15, R14
        CMP.B   #0x0, 0x6(R14)
        JNE     ??ZDSecMgrEvent_4
        MOV.B   #0x1, R8
        MOV.W   0x2(R14), 0x4(SP)
        MOV.B   0x4(R14), 0x6(SP)
        MOV.W   R14, 0x8(SP)
        MOV.B   #0x2, 0xa(SP)
        MOV.W   @R14, R15
        MOV.W   @R15, 0x16(SP)
        MOV.W   SP, R12
        ADD.W   #0xa, R12
        CALLA   #AddrMgrEntryGet
        MOV.W   0xc(SP), 0(SP)
        MOV.W   SP, R15
        ADD.W   #0xe, R15
        MOV.W   R15, 0x2(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #ZDSecMgrDeviceCtrlHandler
        JMP     ??ZDSecMgrEvent_2
??ZDSecMgrEvent_4:
        MOV.B   #0x1, R10
??ZDSecMgrEvent_2:
        ADD.W   #0x1, R11
        CMP.W   #0x3, R11
        JNC     ??ZDSecMgrEvent_0
        BIT.B   #0x1, R10
        JNC     ??ZDSecMgrEvent_1
        CALLA   #?Subroutine39
??ZDSecMgrEvent_1:
        BRA     #?Subroutine3
          CFI EndBlock cfiBlock114

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrNewDeviceEvent:
          CFI Block cfiBlock115 Using cfiCommon0
          CFI Function ZDSecMgrNewDeviceEvent
        FUNCALL ZDSecMgrNewDeviceEvent, AssocMatchDeviceStatus
        LOCFRAME CSTACK, 36, STACK
        FUNCALL ZDSecMgrNewDeviceEvent, ZDSecMgrAssocDeviceAuth
        LOCFRAME CSTACK, 36, STACK
        FUNCALL ZDSecMgrNewDeviceEvent, AddrMgrEntryGet
        LOCFRAME CSTACK, 36, STACK
        FUNCALL ZDSecMgrNewDeviceEvent, NLME_GetShortAddr
        LOCFRAME CSTACK, 36, STACK
        FUNCALL ZDSecMgrNewDeviceEvent, ZDSecMgrDeviceNew
        LOCFRAME CSTACK, 36, STACK
        FUNCALL ZDSecMgrNewDeviceEvent, AssocRemove
        LOCFRAME CSTACK, 36, STACK
        PUSHM.W #0x4, R11
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+12
        SUB.W   #0x18, SP
          CFI CFA SP+36
        MOV.B   #0x0, R10
        MOV.B   #0x4, R12
        CALLA   #AssocMatchDeviceStatus
        MOV.W   R12, R11
        CMP.W   #0x0, R12
        JEQ     ??ZDSecMgrNewDeviceEvent_0
        MOV.B   #0x1, R10
        CMP.B   #0x1, &zgPreConfigKeys
        JNE     ??ZDSecMgrNewDeviceEvent_1
        CALLA   #ZDSecMgrAssocDeviceAuth
??ZDSecMgrNewDeviceEvent_1:
        MOV.B   #0x0, 0xa(SP)
        MOV.W   0x2(R11), 0x16(SP)
        MOV.W   SP, R8
        ADD.W   #0xa, R8
        MOV.W   R8, R12
        CALLA   #AddrMgrEntryGet
        MOV.W   @R11, 0(SP)
        MOV.W   R8, R15
        ADD.W   #0x4, R15
        MOV.W   R15, 0x2(SP)
        CALLA   #NLME_GetShortAddr
        MOV.W   R12, 0x4(SP)
        MOV.B   #0x0, 0x6(SP)
        MOV.B   0x5(R11), 0x7(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #ZDSecMgrDeviceNew
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrNewDeviceEvent_2
        BIC.B   #0x4, 0x5(R11)
        JMP     ??ZDSecMgrNewDeviceEvent_0
??ZDSecMgrNewDeviceEvent_2:
        CMP.B   #0xc8, R12
        JNE     ??ZDSecMgrNewDeviceEvent_0
        ADD.W   #0x4, R8
        MOV.W   R8, R12
        CALLA   #AssocRemove
??ZDSecMgrNewDeviceEvent_0:
        MOV.B   R10, R12
        BRA     #?Subroutine3
          CFI EndBlock cfiBlock115

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrPermitJoiningTimeout:
          CFI Block cfiBlock116 Using cfiCommon0
          CFI Function ZDSecMgrPermitJoiningTimeout
        CMP.B   #0x1, &ZDSecMgrPermitJoiningTimed
        JNE     ??ZDSecMgrPermitJoiningTimeout_0
        MOV.B   #0x0, &ZDSecMgrPermitJoiningEnabled
        MOV.B   #0x0, &ZDSecMgrPermitJoiningTimed
??ZDSecMgrPermitJoiningTimeout_0:
        RETA
          CFI EndBlock cfiBlock116

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrPermitJoining:
          CFI Block cfiBlock117 Using cfiCommon0
          CFI Function ZDSecMgrPermitJoining
        MOV.B   #0x0, R14
        CMP.B   #0x0, R12
        JEQ     ??ZDSecMgrPermitJoining_0
        MOV.B   #0x1, R15
        CMP.B   #0xff, R12
        JEQ     ??ZDSecMgrPermitJoining_1
        MOV.B   #0x1, R14
        JMP     ??ZDSecMgrPermitJoining_1
??ZDSecMgrPermitJoining_0:
        MOV.B   #0x0, R15
??ZDSecMgrPermitJoining_1:
        MOV.B   R14, &ZDSecMgrPermitJoiningTimed
        MOV.B   R15, &ZDSecMgrPermitJoiningEnabled
        MOV.B   #0x1, R12
        RETA
          CFI EndBlock cfiBlock117

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrConfig:
          CFI Block cfiBlock118 Using cfiCommon0
          CFI Function ZDSecMgrConfig
        FUNCALL ZDSecMgrConfig, APSME_SecurityNM
        LOCFRAME CSTACK, 4, STACK
        BRA     #APSME_SecurityNM
          CFI EndBlock cfiBlock118

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrInit:
          CFI Block cfiBlock119 Using cfiCommon0
          CFI Function ZDSecMgrInit
        FUNCALL ZDSecMgrInit, APSME_SecurityNM
        LOCFRAME CSTACK, 4, STACK
        BRA     #APSME_SecurityNM
          CFI EndBlock cfiBlock119

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAuthNwkKey:
        FUNCALL ZDSecMgrAuthNwkKey, osal_set_event
        LOCFRAME CSTACK, 4, STACK
        REQUIRE ?Subroutine16
        // Fall through to label ?Subroutine16

        RSEG CODE:CODE:NOROOT(1)
?Subroutine16:
          CFI Block cfiCond120 Using cfiCommon0
          CFI Function ZDSecMgrAuthenticateCfm
          CFI Conditional ??ZDSecMgrAuthenticateCfm_0
          CFI CFA SP+8
          CFI Block cfiBlock121 Using cfiCommon0
          CFI (cfiBlock121) NoFunction
          CFI Block cfiPicker122 Using cfiCommon1
          CFI (cfiPicker122) NoFunction
          CFI (cfiPicker122) Picker
        CMP.B   #0x5, &devState
        JNE     ??ZDSecMgrAuthenticateCfm_1
        MOV.W   #0x80, R13
        MOV.B   &ZDAppTaskID, R12
        CALLA   #osal_set_event
??ZDSecMgrAuthenticateCfm_1:
        RETA
          CFI EndBlock cfiCond120
          CFI EndBlock cfiBlock121
          CFI EndBlock cfiPicker122

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAuthInitiate:
          CFI Block cfiBlock123 Using cfiCommon0
          CFI Function ZDSecMgrAuthInitiate
        FUNCALL ZDSecMgrAuthInitiate, APSME_LookupNwkAddr
        LOCFRAME CSTACK, 14, STACK
        FUNCALL ZDSecMgrAuthInitiate, APSME_AuthenticateReq
        LOCFRAME CSTACK, 14, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0x8, SP
          CFI CFA SP+14
        MOV.W   R12, R10
        MOV.W   SP, R13
        ADD.W   #0x0, R13
        CALLA   #APSME_LookupNwkAddr
        CMP.B   #0x0, R12
        JEQ     ??ZDSecMgrAuthInitiate_0
        MOV.W   R10, 0x2(SP)
        MOV.B   #0x0, 0x6(SP)
        MOV.W   #0x0, 0x4(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #APSME_AuthenticateReq
          CFI EndBlock cfiBlock123
??ZDSecMgrAuthInitiate_0:
        REQUIRE ?Subroutine11
        // Fall through to label ?Subroutine11

        RSEG CODE:CODE:NOROOT(1)
?Subroutine11:
          CFI Block cfiBlock124 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+14
          CFI R10L Frame(CFA, -6)
        ADD.W   #0x8, SP
          CFI CFA SP+6
        POP.W   R10
          CFI CFA SP+4
          CFI R10L SameValue
        RETA
          CFI EndBlock cfiBlock124

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAssocDeviceAuth:
          CFI Block cfiBlock125 Using cfiCommon0
          CFI Function ZDSecMgrAssocDeviceAuth
        CMP.W   #0x0, R12
        JEQ     ??ZDSecMgrAssocDeviceAuth_0
        BIS.B   #0x8, 0x5(R12)
??ZDSecMgrAssocDeviceAuth_0:
        RETA
          CFI EndBlock cfiBlock125

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceNew:
          CFI Block cfiBlock126 Using cfiCommon0
          CFI Function ZDSecMgrDeviceNew
        FUNCALL ZDSecMgrDeviceNew, ZDSecMgrDeviceJoinFwd
        LOCFRAME CSTACK, 4, STACK
        BRA     #ZDSecMgrDeviceJoinFwd
          CFI EndBlock cfiBlock126

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceJoinFwd:
          CFI Block cfiBlock127 Using cfiCommon0
          CFI Function ZDSecMgrDeviceJoinFwd
        FUNCALL ZDSecMgrDeviceJoinFwd, APSME_UpdateDeviceReq
        LOCFRAME CSTACK, 12, STACK
        SUB.W   #0x8, SP
          CFI CFA SP+12
        MOV.W   #0x0, 0(SP)
        MOV.W   @R12, 0x2(SP)
        MOV.W   0x2(R12), 0x4(SP)
        CMP.B   #0x0, 0x7(R12)
        JGE     ??ZDSecMgrDeviceJoinFwd_2
        BIT.B   #0x40, 0x7(R12)
        JNC     ??ZDSecMgrDeviceJoinFwd_3
        CMP.B   #0x1, 0x6(R12)
        JEQ     ??ZDSecMgrDeviceJoinFwd_4
        MOV.B   #0x7, R14
        JMP     ??ZDSecMgrDeviceJoinFwd_0
??ZDSecMgrDeviceJoinFwd_4:
        MOV.B   #0x4, R14
        JMP     ??ZDSecMgrDeviceJoinFwd_0
??ZDSecMgrDeviceJoinFwd_3:
        MOV.B   #0x5, 0x6(SP)
        JMP     ??ZDSecMgrDeviceJoinFwd_5
??ZDSecMgrDeviceJoinFwd_2:
        BIT.B   #0x40, 0x7(R12)
        JNC     ??ZDSecMgrDeviceJoinFwd_6
        CMP.B   #0x1, 0x6(R12)
        JEQ     ??ZDSecMgrDeviceJoinFwd_7
        MOV.B   #0x3, R14
        JMP     ??ZDSecMgrDeviceJoinFwd_0
??ZDSecMgrDeviceJoinFwd_7:
        MOV.B   #0x0, R14
??ZDSecMgrDeviceJoinFwd_0:
        MOV.B   R14, 0x6(SP)
        JMP     ??ZDSecMgrDeviceJoinFwd_5
??ZDSecMgrDeviceJoinFwd_6:
        MOV.B   #0x1, 0x6(SP)
??ZDSecMgrDeviceJoinFwd_5:
        MOV.B   #0x0, 0x7(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #APSME_UpdateDeviceReq
        ADD.W   #0x8, SP
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock127

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceJoinDirect:
          CFI Block cfiBlock128 Using cfiCommon0
          CFI Function ZDSecMgrDeviceJoinDirect
        FUNCALL ZDSecMgrDeviceJoinDirect, ZDSecMgrDeviceJoin
        LOCFRAME CSTACK, 8, STACK
        FUNCALL ZDSecMgrDeviceJoinDirect, AssocGetWithShort
        LOCFRAME CSTACK, 8, STACK
        FUNCALL ZDSecMgrDeviceJoinDirect, ZDSecMgrAssocDeviceAuth
        LOCFRAME CSTACK, 8, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        MOV.W   R12, R11
        CALLA   #ZDSecMgrDeviceJoin
        MOV.B   R12, R10
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrDeviceJoinDirect_0
        MOV.W   @R11, R12
        CALLA   #AssocGetWithShort
        CALLA   #ZDSecMgrAssocDeviceAuth
??ZDSecMgrDeviceJoinDirect_0:
        MOV.B   R10, R12
        POPM.W  #0x2, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock128

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceJoin:
          CFI Block cfiBlock129 Using cfiCommon0
          CFI Function ZDSecMgrDeviceJoin
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrDeviceValidate
        LOCFRAME CSTACK, 10, STACK
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrAddrStore
        LOCFRAME CSTACK, 10, STACK
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrSendNwkKey
        LOCFRAME CSTACK, 10, STACK
        FUNCALL ZDSecMgrDeviceJoin, ZDSecMgrDeviceRemove
        LOCFRAME CSTACK, 10, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        SUB.W   #0x2, SP
          CFI CFA SP+10
        MOV.W   R12, R11
        CALLA   #ZDSecMgrDeviceValidate
        MOV.B   R12, R10
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrDeviceJoin_0
        MOV.W   SP, R14
        ADD.W   #0x0, R14
        MOV.W   0x2(R11), R13
        MOV.W   @R11, R12
        CALLA   #ZDSecMgrAddrStore
        MOV.W   R11, R12
        CALLA   #ZDSecMgrSendNwkKey
        MOV.B   R12, R10
        JMP     ??ZDSecMgrDeviceJoin_1
??ZDSecMgrDeviceJoin_0:
        MOV.W   R11, R12
        CALLA   #ZDSecMgrDeviceRemove
??ZDSecMgrDeviceJoin_1:
        MOV.B   R10, R12
        JMP     ??Subroutine2_0
          CFI EndBlock cfiBlock129

        RSEG CODE:CODE:NOROOT(1)
?Subroutine2:
          CFI Block cfiBlock130 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+10
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
        MOV.B   R11, R12
          CFI EndBlock cfiBlock130
        REQUIRE ??Subroutine2_0
        // Fall through to label ??Subroutine2_0

        RSEG CODE:CODE:NOROOT(1)
??Subroutine2_0:
          CFI Block cfiBlock131 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+10
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
        ADD.W   #0x2, SP
          CFI CFA SP+8
        POPM.W  #0x2, R11
          CFI CFA SP+4
          CFI R10L SameValue
          CFI R11L SameValue
        RETA
          CFI EndBlock cfiBlock131

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceValidate:
          CFI Block cfiBlock132 Using cfiCommon0
          CFI Function ZDSecMgrDeviceValidate
        FUNCALL ZDSecMgrDeviceValidate, ZDSecMgrDeviceValidateRM
        LOCFRAME CSTACK, 4, STACK
        CMP.B   #0x1, &ZDSecMgrPermitJoiningEnabled
        JNE     ??ZDSecMgrDeviceValidate_0
        CMP.B   #0x1, &zgPreConfigKeys
        JEQ     ??ZDSecMgrDeviceValidate_1
        MOV.B   #0x0, R14
        JMP     ??ZDSecMgrDeviceValidate_2
??ZDSecMgrDeviceValidate_1:
        MOV.B   #0x1, R14
??ZDSecMgrDeviceValidate_2:
        MOV.B   R14, 0x6(R12)
        BRA     #ZDSecMgrDeviceValidateRM
??ZDSecMgrDeviceValidate_0:
        MOV.B   #0xc8, R12
        RETA
          CFI EndBlock cfiBlock132

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceValidateCM:
          CFI Block cfiBlock133 Using cfiCommon0
          CFI Function ZDSecMgrDeviceValidateCM
        FUNCALL ZDSecMgrDeviceValidateCM, osal_memcpy
        LOCFRAME CSTACK, 30, STACK
        FUNCALL ZDSecMgrDeviceValidateCM, ZDSecMgrAddrStore
        LOCFRAME CSTACK, 30, STACK
        FUNCALL ZDSecMgrDeviceValidateCM, ZDSecMgrMasterKeyLoad
        LOCFRAME CSTACK, 30, STACK
        FUNCALL ZDSecMgrDeviceValidateCM, ZDSecMgrDeviceEntryAdd
        LOCFRAME CSTACK, 30, STACK
        FUNCALL ZDSecMgrDeviceValidateCM, osal_memset
        LOCFRAME CSTACK, 30, STACK
        PUSHM.W #0x4, R11
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+12
        SUB.W   #0x12, SP
          CFI CFA SP+30
        MOV.W   R12, R10
        MOV.W   SP, R11
        ADD.W   #0x2, R11
        MOV.W   #0x10, R14
        MOV.W   #ZDSecMgrTCMasterKey, R13
        MOV.W   R11, R12
        CALLA   #osal_memcpy
        MOV.W   SP, R14
        ADD.W   #0x0, R14
        MOV.W   0x2(R10), R13
        MOV.W   @R10, R12
        CALLA   #ZDSecMgrAddrStore
        MOV.B   R12, R8
        MOV.W   R11, R13
        MOV.W   0x2(R10), R12
        CALLA   #ZDSecMgrMasterKeyLoad
        CMP.B   #0x0, R8
        JNE     ??ZDSecMgrDeviceValidateCM_0
        MOV.W   @SP, R13
        MOV.W   R10, R12
        CALLA   #ZDSecMgrDeviceEntryAdd
        MOV.B   R12, R8
??ZDSecMgrDeviceValidateCM_0:
        CALLA   #?Subroutine21
??CrossCallReturnLabel_74:
        MOV.B   R8, R12
          CFI EndBlock cfiBlock133
        REQUIRE ?Subroutine6
        // Fall through to label ?Subroutine6

        RSEG CODE:CODE:NOROOT(1)
?Subroutine6:
          CFI Block cfiBlock134 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+30
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
        ADD.W   #0x12, SP
          CFI CFA SP+12
        POPM.W  #0x4, R11
          CFI CFA SP+4
          CFI R8L SameValue
          CFI R9L SameValue
          CFI R10L SameValue
          CFI R11L SameValue
        RETA
          CFI EndBlock cfiBlock134

        RSEG CODE:CODE:NOROOT(1)
?Subroutine21:
          CFI Block cfiCond135 Using cfiCommon0
          CFI Function ZDSecMgrDeviceValidateCM
          CFI Conditional ??CrossCallReturnLabel_74
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+34
          CFI Block cfiCond136 Using cfiCommon0
          CFI (cfiCond136) Function ZDSecMgrSendMasterKey
          CFI (cfiCond136) Conditional ??ZDSecMgrSendMasterKey_1
          CFI (cfiCond136) R10L Frame(CFA, -8)
          CFI (cfiCond136) R11L Frame(CFA, -6)
          CFI (cfiCond136) CFA SP+44
          CFI Block cfiPicker137 Using cfiCommon1
          CFI (cfiPicker137) NoFunction
          CFI (cfiPicker137) Picker
        MOV.W   #0x10, R14
          CFI EndBlock cfiCond135
          CFI EndBlock cfiCond136
          CFI EndBlock cfiPicker137
        REQUIRE ??Subroutine21_0
        // Fall through to label ??Subroutine21_0

        RSEG CODE:CODE:NOROOT(1)
??Subroutine21_0:
          CFI Block cfiCond138 Using cfiCommon0
          CFI Function ZDSecMgrApsLinkKeyInit
          CFI Conditional ??CrossCallReturnLabel_73
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+40
          CFI Block cfiCond139 Using cfiCommon0
          CFI (cfiCond139) Function ZDSecMgrSendNwkKey
          CFI (cfiCond139) Conditional ??ZDSecMgrSendNwkKey_0
          CFI (cfiCond139) R10L Frame(CFA, -8)
          CFI (cfiCond139) R11L Frame(CFA, -6)
          CFI (cfiCond139) CFA SP+44
          CFI Block cfiCond140 Using cfiCommon0
          CFI (cfiCond140) Function ZDSecMgrSendNwkKey
          CFI (cfiCond140) Conditional ??CrossCallReturnLabel_72
          CFI (cfiCond140) R10L Frame(CFA, -8)
          CFI (cfiCond140) R11L Frame(CFA, -6)
          CFI (cfiCond140) CFA SP+44
          CFI Block cfiCond141 Using cfiCommon0
          CFI (cfiCond141) Function ZDSecMgrSendMasterKey
          CFI (cfiCond141) Conditional ??CrossCallReturnLabel_72
          CFI (cfiCond141) R10L Frame(CFA, -8)
          CFI (cfiCond141) R11L Frame(CFA, -6)
          CFI (cfiCond141) CFA SP+44
          CFI Block cfiCond142 Using cfiCommon0
          CFI (cfiCond142) Function ZDSecMgrDeviceValidateCM
          CFI (cfiCond142) Conditional ??CrossCallReturnLabel_74
          CFI (cfiCond142) R8L Frame(CFA, -12)
          CFI (cfiCond142) R9L Frame(CFA, -10)
          CFI (cfiCond142) R10L Frame(CFA, -8)
          CFI (cfiCond142) R11L Frame(CFA, -6)
          CFI (cfiCond142) CFA SP+34
          CFI Block cfiCond143 Using cfiCommon0
          CFI (cfiCond143) Function ZDSecMgrSendMasterKey
          CFI (cfiCond143) Conditional ??ZDSecMgrSendMasterKey_1
          CFI (cfiCond143) R10L Frame(CFA, -8)
          CFI (cfiCond143) R11L Frame(CFA, -6)
          CFI (cfiCond143) CFA SP+44
          CFI Block cfiPicker144 Using cfiCommon1
          CFI (cfiPicker144) NoFunction
          CFI (cfiPicker144) Picker
        MOV.B   #0x0, R13
        MOV.W   R11, R12
        BRA     #osal_memset
          CFI EndBlock cfiCond138
          CFI EndBlock cfiCond139
          CFI EndBlock cfiCond140
          CFI EndBlock cfiCond141
          CFI EndBlock cfiCond142
          CFI EndBlock cfiCond143
          CFI EndBlock cfiPicker144

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceValidateRM:
          CFI Block cfiBlock145 Using cfiCommon0
          CFI Function ZDSecMgrDeviceValidateRM
        MOV.B   #0x0, R12
        CMP.B   #0x0, &zgSecurePermitJoin
        JNE     ??ZDSecMgrDeviceValidateRM_0
        MOV.B   #0xc8, R12
??ZDSecMgrDeviceValidateRM_0:
        RETA
          CFI EndBlock cfiBlock145

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceValidateSKKE:
          CFI Block cfiBlock146 Using cfiCommon0
          CFI Function ZDSecMgrDeviceValidateSKKE
        FUNCALL ZDSecMgrDeviceValidateSKKE, ZDSecMgrExtAddrLookup
        LOCFRAME CSTACK, 10, STACK
        FUNCALL ZDSecMgrDeviceValidateSKKE, ZDSecMgrMasterKeyLookup
        LOCFRAME CSTACK, 10, STACK
        FUNCALL ZDSecMgrDeviceValidateSKKE, ZDSecMgrDeviceEntryAdd
        LOCFRAME CSTACK, 10, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0x4, SP
          CFI CFA SP+10
        MOV.W   R12, R10
        MOV.W   SP, R13
        ADD.W   #0x0, R13
        MOV.W   0x2(R10), R12
        CALLA   #ZDSecMgrExtAddrLookup
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrDeviceValidateSKKE_0
        CALLA   #?Subroutine33
??CrossCallReturnLabel_26:
        JNE     ??ZDSecMgrDeviceValidateSKKE_0
        MOV.W   @SP, R13
        MOV.W   R10, R12
        CALLA   #ZDSecMgrDeviceEntryAdd
          CFI EndBlock cfiBlock146
??ZDSecMgrDeviceValidateSKKE_0:
        REQUIRE ?Subroutine12
        // Fall through to label ?Subroutine12

        RSEG CODE:CODE:NOROOT(1)
?Subroutine12:
          CFI Block cfiBlock147 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+10
          CFI R10L Frame(CFA, -6)
        ADD.W   #0x4, SP
          CFI CFA SP+6
        POP.W   R10
          CFI CFA SP+4
          CFI R10L SameValue
        RETA
          CFI EndBlock cfiBlock147

        RSEG CODE:CODE:NOROOT(1)
?Subroutine33:
          CFI Block cfiCond148 Using cfiCommon0
          CFI Function ZDSecMgrTCDataLoad
          CFI Conditional ??CrossCallReturnLabel_25
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+44
          CFI Block cfiCond149 Using cfiCommon0
          CFI (cfiCond149) Function ZDSecMgrDeviceValidateSKKE
          CFI (cfiCond149) Conditional ??CrossCallReturnLabel_26
          CFI (cfiCond149) R10L Frame(CFA, -6)
          CFI (cfiCond149) CFA SP+14
          CFI Block cfiCond150 Using cfiCommon0
          CFI (cfiCond150) Function ZDSecMgrMasterKeyLoad
          CFI (cfiCond150) Conditional ??CrossCallReturnLabel_27
          CFI (cfiCond150) R10L Frame(CFA, -8)
          CFI (cfiCond150) R11L Frame(CFA, -6)
          CFI (cfiCond150) CFA SP+16
          CFI Block cfiPicker151 Using cfiCommon1
          CFI (cfiPicker151) NoFunction
          CFI (cfiPicker151) Picker
        MOV.W   SP, R13
        ADD.W   #0x6, R13
        MOV.W   0x4(SP), R12
        CALLA   #ZDSecMgrMasterKeyLookup
        CMP.B   #0x0, R12
        RETA
          CFI EndBlock cfiCond148
          CFI EndBlock cfiCond149
          CFI EndBlock cfiCond150
          CFI EndBlock cfiPicker151

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceRemove:
          CFI Block cfiBlock152 Using cfiCommon0
          CFI Function ZDSecMgrDeviceRemove
        FUNCALL ZDSecMgrDeviceRemove, NLME_GetShortAddr
        LOCFRAME CSTACK, 16, STACK
        FUNCALL ZDSecMgrDeviceRemove, AssocGetWithExt
        LOCFRAME CSTACK, 16, STACK
        FUNCALL ZDSecMgrDeviceRemove, NLME_LeaveReq
        LOCFRAME CSTACK, 16, STACK
        FUNCALL ZDSecMgrDeviceRemove, APSME_RemoveDeviceReq
        LOCFRAME CSTACK, 16, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0xa, SP
          CFI CFA SP+16
        MOV.W   R12, R10
        CALLA   #?Subroutine38
??CrossCallReturnLabel_38:
        JNE     ??ZDSecMgrDeviceRemove_0
        MOV.W   0x2(R10), 0(SP)
        MOV.B   #0x0, 0x2(SP)
        MOV.B   #0x0, 0x3(SP)
        MOV.W   0x2(R10), R12
        CALLA   #AssocGetWithExt
        CMP.W   #0x0, R12
        JEQ     ??ZDSecMgrDeviceRemove_1
        MOV.B   0x4(R12), R14
        CMP.B   #0x0, R14
        JEQ     ??ZDSecMgrDeviceRemove_1
        CMP.B   #0x5, R14
        JC      ??ZDSecMgrDeviceRemove_1
        BIT.B   #0x8, 0x5(R12)
        SUBC.B  R14, R14
        AND.B   #0x1, R14
        MOV.B   R14, 0x4(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #NLME_LeaveReq
        JMP     ??ZDSecMgrDeviceRemove_1
??ZDSecMgrDeviceRemove_0:
        MOV.W   R15, 0x6(SP)
        MOV.W   0x2(R10), 0x8(SP)
        MOV.W   SP, R12
        ADD.W   #0x6, R12
        CALLA   #APSME_RemoveDeviceReq
??ZDSecMgrDeviceRemove_1:
        BRA     #?Subroutine4
          CFI EndBlock cfiBlock152

        RSEG CODE:CODE:NOROOT(1)
APSME_SKA_TimerExpired:
          CFI Block cfiBlock153 Using cfiCommon0
          CFI Function APSME_SKA_TimerExpired
        RETA
          CFI EndBlock cfiBlock153

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceCtrlUpdate:
          CFI Block cfiBlock154 Using cfiCommon0
          CFI Function ZDSecMgrDeviceCtrlUpdate
        FUNCALL ZDSecMgrDeviceCtrlUpdate, ZDSecMgrEntryLookupExt
        LOCFRAME CSTACK, 10, STACK
        FUNCALL ZDSecMgrDeviceCtrlUpdate, ZDSecMgrCtrlLookup
        LOCFRAME CSTACK, 10, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0x4, SP
          CFI CFA SP+10
        MOV.B   R13, R10
        MOV.W   SP, R13
        ADD.W   #0x2, R13
        CALLA   #ZDSecMgrEntryLookupExt
        CMP.W   #0x0, 0x2(SP)
        JEQ     ??ZDSecMgrDeviceCtrlUpdate_0
        MOV.W   SP, R13
        ADD.W   #0x0, R13
        MOV.W   0x2(SP), R12
        CALLA   #?Subroutine40
??CrossCallReturnLabel_43:
        JEQ     ??ZDSecMgrDeviceCtrlUpdate_0
        MOV.W   @SP, R15
        CMP.B   #0x4, 0x5(R15)
        JNE     ??ZDSecMgrDeviceCtrlUpdate_0
        CMP.B   #0x5, R10
        JNE     ??ZDSecMgrDeviceCtrlUpdate_1
        MOV.B   #0x7, 0x5(R15)
        JMP     ??ZDSecMgrDeviceCtrlUpdate_2
??ZDSecMgrDeviceCtrlUpdate_1:
        CMP.B   #0x6, R10
        JNE     ??ZDSecMgrDeviceCtrlUpdate_0
        MOV.B   #0x6, 0x5(R15)
??ZDSecMgrDeviceCtrlUpdate_2:
        MOV.W   @SP, R15
        MOV.B   #0x1, 0x6(R15)
??ZDSecMgrDeviceCtrlUpdate_0:
        JMP     ?Subroutine12
          CFI EndBlock cfiBlock154

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceCtrlSetup:
          CFI Block cfiBlock155 Using cfiCommon0
          CFI Function ZDSecMgrDeviceCtrlSetup
        FUNCALL ZDSecMgrDeviceCtrlSetup, ZDSecMgrDeviceCtrlHandler
        LOCFRAME CSTACK, 4, STACK
        MOV.W   0x8(R12), R15
        CMP.W   #0x0, R15
        JEQ     ??ZDSecMgrDeviceCtrlSetup_0
        CMP.B   #0x0, 0x6(R12)
        JEQ     ??ZDSecMgrDeviceCtrlSetup_1
        MOV.B   #0x3, R14
        JMP     ??ZDSecMgrDeviceCtrlSetup_2
??ZDSecMgrDeviceCtrlSetup_1:
        MOV.B   #0x2, R14
??ZDSecMgrDeviceCtrlSetup_2:
        MOV.B   R14, 0x5(R15)
        CALLA   #ZDSecMgrDeviceCtrlHandler
??ZDSecMgrDeviceCtrlSetup_0:
        RETA
          CFI EndBlock cfiBlock155

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceCtrlHandler:
          CFI Block cfiBlock156 Using cfiCommon0
          CFI Function ZDSecMgrDeviceCtrlHandler
        FUNCALL ZDSecMgrDeviceCtrlHandler, ZDSecMgrSendMasterKey
        LOCFRAME CSTACK, 8, STACK
        FUNCALL ZDSecMgrDeviceCtrlHandler, ZDSecMgrEstablishKey
        LOCFRAME CSTACK, 8, STACK
        FUNCALL ZDSecMgrDeviceCtrlHandler, ZDSecMgrSendNwkKey
        LOCFRAME CSTACK, 8, STACK
        FUNCALL ZDSecMgrDeviceCtrlHandler, osal_start_timerEx
        LOCFRAME CSTACK, 8, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        MOV.W   R12, R10
        ADD.W   #0x8, R10
        MOV.W   @R10, R15
        MOV.B   0x5(R15), R11
        MOV.B   R11, R14
        SUB.B   #0x2, R14
        JEQ     ??ZDSecMgrDeviceCtrlHandler_0
        SUB.B   #0x1, R14
        JEQ     ??ZDSecMgrDeviceCtrlHandler_1
        SUB.B   #0x1, R14
        JEQ     ??ZDSecMgrDeviceCtrlHandler_2
        SUB.B   #0x3, R14
        JEQ     ??ZDSecMgrDeviceCtrlHandler_3
        JMP     ??ZDSecMgrDeviceCtrlHandler_4
??ZDSecMgrDeviceCtrlHandler_0:
        CALLA   #ZDSecMgrSendMasterKey
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrDeviceCtrlHandler_2
        MOV.B   #0x3, R11
        JMP     ??ZDSecMgrDeviceCtrlHandler_2
??ZDSecMgrDeviceCtrlHandler_1:
        CALLA   #ZDSecMgrEstablishKey
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrDeviceCtrlHandler_2
        MOV.B   #0x4, R11
        JMP     ??ZDSecMgrDeviceCtrlHandler_2
??ZDSecMgrDeviceCtrlHandler_3:
        CALLA   #ZDSecMgrSendNwkKey
        CMP.B   #0x0, R12
        JEQ     ??ZDSecMgrDeviceCtrlHandler_4
??ZDSecMgrDeviceCtrlHandler_2:
        MOV.W   @R10, R15
        MOV.B   R11, 0x5(R15)
        MOV.W   @R10, R15
        MOV.B   #0x1, 0x6(R15)
        CALLA   #?Subroutine39
??CrossCallReturnLabel_42:
        JMP     ??ZDSecMgrDeviceCtrlHandler_5
??ZDSecMgrDeviceCtrlHandler_4:
        MOV.W   @R10, R15
        MOV.B   #0x0, 0x5(R15)
??ZDSecMgrDeviceCtrlHandler_5:
        POPM.W  #0x2, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock156

        RSEG CODE:CODE:NOROOT(1)
?Subroutine39:
          CFI Block cfiCond157 Using cfiCommon0
          CFI Function ZDSecMgrEvent
          CFI Conditional ??ZDSecMgrEvent_1
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+40
          CFI Block cfiCond158 Using cfiCommon0
          CFI (cfiCond158) Function ZDSecMgrDeviceCtrlHandler
          CFI (cfiCond158) Conditional ??CrossCallReturnLabel_42
          CFI (cfiCond158) R10L Frame(CFA, -8)
          CFI (cfiCond158) R11L Frame(CFA, -6)
          CFI (cfiCond158) CFA SP+12
          CFI Block cfiPicker159 Using cfiCommon1
          CFI (cfiPicker159) NoFunction
          CFI (cfiPicker159) Picker
        MOV.W   #0x64, R14
        MOV.W   #0x100, R13
        MOV.B   &ZDAppTaskID, R12
        BRA     #osal_start_timerEx
          CFI EndBlock cfiCond157
          CFI EndBlock cfiCond158
          CFI EndBlock cfiPicker159

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceEntryAdd:
          CFI Block cfiBlock160 Using cfiCommon0
          CFI Function ZDSecMgrDeviceEntryAdd
        FUNCALL ZDSecMgrDeviceEntryAdd, ZDSecMgrEntryLookup
        LOCFRAME CSTACK, 14, STACK
        FUNCALL ZDSecMgrDeviceEntryAdd, ZDSecMgrEntryFree
        LOCFRAME CSTACK, 14, STACK
        FUNCALL ZDSecMgrDeviceEntryAdd, ZDSecMgrEntryLookupAMI
        LOCFRAME CSTACK, 14, STACK
        FUNCALL ZDSecMgrDeviceEntryAdd, ZDSecMgrEntryLookupAMI
        LOCFRAME CSTACK, 14, STACK
        FUNCALL ZDSecMgrDeviceEntryAdd, ZDSecMgrAddrMgrUpdate
        LOCFRAME CSTACK, 14, STACK
        FUNCALL ZDSecMgrDeviceEntryAdd, ZDSecMgrEntryNew
        LOCFRAME CSTACK, 14, STACK
        FUNCALL ZDSecMgrDeviceEntryAdd, ZDSecMgrAddrMgrUpdate
        LOCFRAME CSTACK, 14, STACK
        PUSHM.W #0x4, R11
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+12
        SUB.W   #0x2, SP
          CFI CFA SP+14
        MOV.W   R12, R10
        MOV.W   R13, R11
        MOV.B   #0xc8, R8
        MOV.W   #0x0, 0x8(R12)
        MOV.W   SP, R13
        ADD.W   #0x0, R13
        MOV.W   @R10, R12
        CALLA   #ZDSecMgrEntryLookup
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrDeviceEntryAdd_1
        MOV.W   @SP, R12
        CMP.W   R11, 0(R12)
        JEQ     ??ZDSecMgrDeviceEntryAdd_2
        CALLA   #ZDSecMgrEntryFree
        CALLA   #?Subroutine36
??CrossCallReturnLabel_34:
        JNE     ??ZDSecMgrDeviceEntryAdd_2
        JMP     ??ZDSecMgrDeviceEntryAdd_3
??ZDSecMgrDeviceEntryAdd_1:
        CALLA   #?Subroutine36
??CrossCallReturnLabel_35:
        JNE     ??ZDSecMgrDeviceEntryAdd_2
??ZDSecMgrDeviceEntryAdd_3:
        MOV.W   @R10, R13
        MOV.W   R11, R12
        CALLA   #ZDSecMgrAddrMgrUpdate
??ZDSecMgrDeviceEntryAdd_2:
        CMP.W   #0x0, 0(SP)
        JNE     ??ZDSecMgrDeviceEntryAdd_0
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #ZDSecMgrEntryNew
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrDeviceEntryAdd_4
        MOV.W   @SP, R15
        MOV.W   R11, 0(R15)
        MOV.W   @R10, R13
        MOV.W   R11, R12
        CALLA   #ZDSecMgrAddrMgrUpdate
??ZDSecMgrDeviceEntryAdd_0:
        MOV.B   #0x0, R8
??ZDSecMgrDeviceEntryAdd_4:
        MOV.B   R8, R12
        ADD.W   #0x2, SP
          CFI CFA SP+12
        POPM.W  #0x4, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI R8L SameValue
          CFI R9L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock160

        RSEG CODE:CODE:NOROOT(1)
?Subroutine36:
          CFI Block cfiCond161 Using cfiCommon0
          CFI Function ZDSecMgrDeviceEntryAdd
          CFI Conditional ??CrossCallReturnLabel_34
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+18
          CFI Block cfiCond162 Using cfiCommon0
          CFI (cfiCond162) Function ZDSecMgrDeviceEntryAdd
          CFI (cfiCond162) Conditional ??CrossCallReturnLabel_35
          CFI (cfiCond162) R8L Frame(CFA, -12)
          CFI (cfiCond162) R9L Frame(CFA, -10)
          CFI (cfiCond162) R10L Frame(CFA, -8)
          CFI (cfiCond162) R11L Frame(CFA, -6)
          CFI (cfiCond162) CFA SP+18
          CFI Block cfiPicker163 Using cfiCommon1
          CFI (cfiPicker163) NoFunction
          CFI (cfiPicker163) Picker
        MOV.W   SP, R13
        ADD.W   #0x4, R13
        MOV.W   R11, R12
        CALLA   #ZDSecMgrEntryLookupAMI
        CMP.B   #0x0, R12
        RETA
          CFI EndBlock cfiCond161
          CFI EndBlock cfiCond162
          CFI EndBlock cfiPicker163

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAddrMgrUpdate:
          CFI Block cfiBlock164 Using cfiCommon0
          CFI Function ZDSecMgrAddrMgrUpdate
        FUNCALL ZDSecMgrAddrMgrUpdate, AddrMgrEntryGet
        LOCFRAME CSTACK, 20, STACK
        FUNCALL ZDSecMgrAddrMgrUpdate, AddrMgrEntryUpdate
        LOCFRAME CSTACK, 20, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0xe, SP
          CFI CFA SP+20
        MOV.W   R13, R10
        MOV.B   #0x2, 0(SP)
        MOV.W   R12, 0xc(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #AddrMgrEntryGet
        CMP.W   R10, 0x2(SP)
        JEQ     ??ZDSecMgrAddrMgrUpdate_0
        MOV.W   R10, 0x2(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #AddrMgrEntryUpdate
??ZDSecMgrAddrMgrUpdate_0:
        BRA     #??Subroutine0_0
          CFI EndBlock cfiBlock164

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceRemoveByExtAddr:
          CFI Block cfiBlock165 Using cfiCommon0
          CFI Function ZDSecMgrDeviceRemoveByExtAddr
        FUNCALL ZDSecMgrDeviceRemoveByExtAddr, ZDSecMgrEntryLookupExt
        LOCFRAME CSTACK, 8, STACK
        FUNCALL ZDSecMgrDeviceRemoveByExtAddr, ZDSecMgrEntryFree
        LOCFRAME CSTACK, 8, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0x2, SP
          CFI CFA SP+8
        CALLA   #?Subroutine34
??CrossCallReturnLabel_28:
        MOV.B   R12, R10
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrDeviceRemoveByExtAddr_0
        MOV.W   @SP, R12
        CALLA   #ZDSecMgrEntryFree
??ZDSecMgrDeviceRemoveByExtAddr_0:
        MOV.B   R10, R12
        BRA     #?Subroutine10
          CFI EndBlock cfiBlock165

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrDeviceEntryRemove:
          CFI Block cfiBlock166 Using cfiCommon0
          CFI Function ZDSecMgrDeviceEntryRemove
        FUNCALL ZDSecMgrDeviceEntryRemove, ZDSecMgrEntryFree
        LOCFRAME CSTACK, 4, STACK
        BRA     #ZDSecMgrEntryFree
          CFI EndBlock cfiBlock166

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrSendNwkKey:
          CFI Block cfiBlock167 Using cfiCommon0
          CFI Function ZDSecMgrSendNwkKey
        FUNCALL ZDSecMgrSendNwkKey, NLME_ReadNwkKeyInfo
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrSendNwkKey, osal_memset
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrSendNwkKey, NLME_GetShortAddr
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrSendNwkKey, NLME_GetShortAddr
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrSendNwkKey, APSME_TransportKeyReq
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrSendNwkKey, osal_memset
        LOCFRAME CSTACK, 40, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        SUB.W   #0x20, SP
          CFI CFA SP+40
        MOV.W   R12, R10
        MOV.W   @R12, 0(SP)
        MOV.W   0x2(R12), 0x6(SP)
        MOV.B   #0x1, 0x2(SP)
        MOV.W   SP, R11
        ADD.W   #0xe, R11
        MOV.W   #0x3a, R15
        MOV.W   R11, R14
        MOV.W   #0x11, R13
        MOV.W   #0x0, R12
        CALLA   #NLME_ReadNwkKeyInfo
        CMP.B   #0x0, R12
        JEQ     ??ZDSecMgrSendNwkKey_0
        MOV.W   #0x11, R14
        CALLA   #??Subroutine21_0
??ZDSecMgrSendNwkKey_0:
        MOV.B   #0x1, 0xa(SP)
        MOV.B   #0x0, 0x9(SP)
        MOV.W   #0x0, 0xc(SP)
        CALLA   #?Subroutine38
??CrossCallReturnLabel_39:
        JEQ     ??ZDSecMgrSendNwkKey_1
        MOV.W   R15, 0(SP)
??ZDSecMgrSendNwkKey_1:
        CMP.B   #0x0, 0x6(R10)
        JNE     ??ZDSecMgrSendNwkKey_2
        MOV.B   0xe(SP), 0x3(SP)
        MOV.W   R11, R15
        ADD.W   #0x1, R15
        MOV.W   R15, 0x4(SP)
        CALLA   #NLME_GetShortAddr
        CMP.W   R12, 0x4(R10)
        JNE     ??ZDSecMgrSendNwkKey_3
        MOV.B   #0x0, 0xa(SP)
        JMP     ??ZDSecMgrSendNwkKey_3
??ZDSecMgrSendNwkKey_2:
        MOV.W   #0x0, 0x4(SP)
        MOV.B   #0x0, 0x3(SP)
??ZDSecMgrSendNwkKey_3:
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #APSME_TransportKeyReq
        MOV.B   R12, R10
        MOV.W   #0x11, R14
          CFI EndBlock cfiBlock167
        REQUIRE ?Subroutine1
        // Fall through to label ?Subroutine1

        RSEG CODE:CODE:NOROOT(1)
?Subroutine1:
          CFI Block cfiBlock168 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+40
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
        CALLA   #??Subroutine21_0
??CrossCallReturnLabel_72:
        MOV.B   R10, R12
        ADD.W   #0x20, SP
          CFI CFA SP+8
        POPM.W  #0x2, R11
          CFI CFA SP+4
          CFI R10L SameValue
          CFI R11L SameValue
        RETA
          CFI EndBlock cfiBlock168

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrSendMasterKey:
          CFI Block cfiBlock169 Using cfiCommon0
          CFI Function ZDSecMgrSendMasterKey
        FUNCALL ZDSecMgrSendMasterKey, ZDSecMgrMasterKeyLookup
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrSendMasterKey, osal_nv_read
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrSendMasterKey, osal_memset
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrSendMasterKey, NLME_GetShortAddr
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrSendMasterKey, APSME_TransportKeyReq
        LOCFRAME CSTACK, 40, STACK
        FUNCALL ZDSecMgrSendMasterKey, osal_memset
        LOCFRAME CSTACK, 40, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        SUB.W   #0x20, SP
          CFI CFA SP+40
        MOV.W   R12, R10
        MOV.B   #0x0, 0x4(SP)
        MOV.W   0x2(R12), 0x8(SP)
        MOV.W   #0x0, 0xe(SP)
        MOV.W   SP, R11
        ADD.W   #0x10, R11
        MOV.W   SP, R13
        ADD.W   #0x0, R13
        MOV.W   0x8(R12), R15
        MOV.W   @R15, R15
        MOV.W   @R15, R12
        CALLA   #ZDSecMgrMasterKeyLookup
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrSendMasterKey_0
        MOV.W   R11, R15
        MOV.W   #0x10, R14
        MOV.W   #0x2, R13
        MOV.W   @SP, R12
        CALLA   #osal_nv_read
        JMP     ??ZDSecMgrSendMasterKey_1
??ZDSecMgrSendMasterKey_0:
        CALLA   #?Subroutine21
??ZDSecMgrSendMasterKey_1:
        MOV.W   R11, 0x6(SP)
        CALLA   #?Subroutine38
??CrossCallReturnLabel_40:
        JEQ     ??ZDSecMgrSendMasterKey_2
        MOV.W   R15, 0x2(SP)
        MOV.B   #0x1, 0xc(SP)
        MOV.B   #0x1, 0xb(SP)
        JMP     ??ZDSecMgrSendMasterKey_3
??ZDSecMgrSendMasterKey_2:
        MOV.W   @R10, 0x2(SP)
        MOV.B   #0x0, 0xc(SP)
        MOV.B   #0x0, 0xb(SP)
??ZDSecMgrSendMasterKey_3:
        MOV.W   SP, R12
        ADD.W   #0x2, R12
        CALLA   #APSME_TransportKeyReq
        MOV.B   R12, R10
        MOV.W   #0x10, R14
        JMP     ?Subroutine1
          CFI EndBlock cfiBlock169

        RSEG CODE:CODE:NOROOT(1)
?Subroutine38:
          CFI Block cfiCond170 Using cfiCommon0
          CFI Function ZDSecMgrDeviceRemove
          CFI Conditional ??CrossCallReturnLabel_38
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+20
          CFI Block cfiCond171 Using cfiCommon0
          CFI (cfiCond171) Function ZDSecMgrSendNwkKey
          CFI (cfiCond171) Conditional ??CrossCallReturnLabel_39
          CFI (cfiCond171) R10L Frame(CFA, -8)
          CFI (cfiCond171) R11L Frame(CFA, -6)
          CFI (cfiCond171) CFA SP+44
          CFI Block cfiCond172 Using cfiCommon0
          CFI (cfiCond172) Function ZDSecMgrSendMasterKey
          CFI (cfiCond172) Conditional ??CrossCallReturnLabel_40
          CFI (cfiCond172) R10L Frame(CFA, -8)
          CFI (cfiCond172) R11L Frame(CFA, -6)
          CFI (cfiCond172) CFA SP+44
          CFI Block cfiCond173 Using cfiCommon0
          CFI (cfiCond173) Function ZDSecMgrEstablishKey
          CFI (cfiCond173) Conditional ??CrossCallReturnLabel_41
          CFI (cfiCond173) R10L Frame(CFA, -6)
          CFI (cfiCond173) CFA SP+18
          CFI Block cfiPicker174 Using cfiCommon1
          CFI (cfiPicker174) NoFunction
          CFI (cfiPicker174) Picker
        CALLA   #NLME_GetShortAddr
        MOV.W   0x4(R10), R15
        CMP.W   R12, R15
        RETA
          CFI EndBlock cfiCond170
          CFI EndBlock cfiCond171
          CFI EndBlock cfiCond172
          CFI EndBlock cfiCond173
          CFI EndBlock cfiPicker174

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrEstablishKey:
          CFI Block cfiBlock175 Using cfiCommon0
          CFI Function ZDSecMgrEstablishKey
        FUNCALL ZDSecMgrEstablishKey, NLME_GetShortAddr
        LOCFRAME CSTACK, 14, STACK
        FUNCALL ZDSecMgrEstablishKey, APSME_EstablishKeyReq
        LOCFRAME CSTACK, 14, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0x8, SP
          CFI CFA SP+14
        MOV.W   R12, R10
        MOV.W   0x2(R12), 0x2(SP)
        MOV.B   #0x0, 0x4(SP)
        CALLA   #?Subroutine38
??CrossCallReturnLabel_41:
        JNE     ??ZDSecMgrEstablishKey_0
        MOV.W   @R10, 0(SP)
        MOV.B   #0x0, 0x5(SP)
        MOV.B   #0x0, 0x6(SP)
        JMP     ??ZDSecMgrEstablishKey_1
??ZDSecMgrEstablishKey_0:
        MOV.W   R15, 0(SP)
        MOV.B   #0x1, 0x5(SP)
        MOV.B   #0x1, 0x6(SP)
??ZDSecMgrEstablishKey_1:
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #APSME_EstablishKeyReq
        BRA     #?Subroutine11
          CFI EndBlock cfiBlock175

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAppKeyReq:
          CFI Block cfiBlock176 Using cfiCommon0
          CFI Function ZDSecMgrAppKeyReq
        FUNCALL ZDSecMgrAppKeyReq, APSME_LookupNwkAddr
        LOCFRAME CSTACK, 52, STACK
        FUNCALL ZDSecMgrAppKeyReq, APSME_LookupExtAddr
        LOCFRAME CSTACK, 52, STACK
        FUNCALL ZDSecMgrAppKeyReq, ZDSecMgrAppKeyGet
        LOCFRAME CSTACK, 56, STACK
        FUNCALL ZDSecMgrAppKeyReq, APSME_TransportKeyReq
        LOCFRAME CSTACK, 52, STACK
        FUNCALL ZDSecMgrAppKeyReq, APSME_TransportKeyReq
        LOCFRAME CSTACK, 52, STACK
        FUNCALL ZDSecMgrAppKeyReq, osal_memset
        LOCFRAME CSTACK, 52, STACK
        PUSHM.W #0x4, R11
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+12
        SUB.W   #0x28, SP
          CFI CFA SP+52
        MOV.W   R12, R10
        MOV.W   SP, R13
        ADD.W   #0x0, R13
        ADD.W   #0x5, R12
        CALLA   #APSME_LookupNwkAddr
        CMP.B   #0x1, R12
        JNE     ??ZDSecMgrAppKeyReq_0
        MOV.W   SP, R11
        ADD.W   #0x10, R11
        MOV.W   R11, R13
        MOV.W   0x2(R10), R12
        CALLA   #APSME_LookupExtAddr
        CMP.B   #0x1, R12
        JNE     ??ZDSecMgrAppKeyReq_0
        MOV.W   SP, R15
        ADD.W   #0x18, R15
        MOV.W   R15, 0x6(SP)
        MOV.W   SP, R8
        ADD.W   #0x2, R8
        MOV.W   R8, R15
        ADD.W   #0x2, R15
        PUSH.W  R15
          CFI CFA SP+54
        MOV.W   R8, R15
        ADD.W   #0x4, R15
        PUSH.W  R15
          CFI CFA SP+56
        MOV.W   R10, R15
        ADD.W   #0x5, R15
        MOV.W   0x4(SP), R14
        MOV.W   R11, R13
        MOV.W   0x2(R10), R12
        CALLA   #ZDSecMgrAppKeyGet
        ADD.W   #0x4, SP
          CFI CFA SP+52
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrAppKeyReq_0
        MOV.B   #0x1, 0xc(SP)
        MOV.B   #0x1, 0xb(SP)
        MOV.W   #0x0, 0xe(SP)
        MOV.W   0x2(R10), 0x2(SP)
        ADD.W   #0x5, R10
        MOV.W   R10, 0x8(SP)
        MOV.B   #0x1, 0xa(SP)
        MOV.W   R8, R12
        CALLA   #APSME_TransportKeyReq
        MOV.W   @SP, 0x2(SP)
        MOV.W   R11, 0x8(SP)
        MOV.B   #0x0, 0xa(SP)
        MOV.W   R8, R12
        CALLA   #APSME_TransportKeyReq
        MOV.W   #0x10, R14
        MOV.B   #0x0, R13
        MOV.W   SP, R12
        ADD.W   #0x18, R12
        CALLA   #osal_memset
??ZDSecMgrAppKeyReq_0:
        ADD.W   #0x28, SP
          CFI CFA SP+12
        POPM.W  #0x4, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI R8L SameValue
          CFI R9L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock176

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAppKeyGet:
          CFI Block cfiBlock177 Using cfiCommon0
          CFI Function ZDSecMgrAppKeyGet
        FUNCALL ZDSecMgrAppKeyGet, SSP_GetTrueRand
        LOCFRAME CSTACK, 6, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        MOV.W   0x6(SP), R15
        MOV.W   0x8(SP), R10
        MOV.W   @R15, R13
        MOV.B   #0x10, R12
        CALLA   #SSP_GetTrueRand
        MOV.B   &ZDSecMgrAppKeyType, 0(R10)
        MOV.B   #0x0, R12
        POP.W   R10
          CFI R10L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock177

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrMasterKeyLoad:
          CFI Block cfiBlock178 Using cfiCommon0
          CFI Function ZDSecMgrMasterKeyLoad
        FUNCALL ZDSecMgrMasterKeyLoad, ZDSecMgrExtAddrLookup
        LOCFRAME CSTACK, 12, STACK
        FUNCALL ZDSecMgrMasterKeyLoad, ZDSecMgrMasterKeyLookup
        LOCFRAME CSTACK, 12, STACK
        FUNCALL ZDSecMgrMasterKeyLoad, osal_nv_write
        LOCFRAME CSTACK, 12, STACK
        FUNCALL ZDSecMgrMasterKeyLoad, ZDSecMgrMasterKeyStore
        LOCFRAME CSTACK, 12, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        SUB.W   #0x4, SP
          CFI CFA SP+12
        CALLA   #?Subroutine31
??CrossCallReturnLabel_18:
        JNE     ??ZDSecMgrMasterKeyLoad_0
        CALLA   #?Subroutine33
??CrossCallReturnLabel_27:
        JNE     ??ZDSecMgrMasterKeyLoad_1
        MOV.W   R10, R15
        MOV.W   #0x10, R14
        MOV.W   #0x2, R13
        MOV.W   0x2(SP), R12
        CALLA   #osal_nv_write
        JMP     ??ZDSecMgrMasterKeyLoad_0
??ZDSecMgrMasterKeyLoad_1:
        MOV.W   R10, R13
        MOV.W   @SP, R12
        CALLA   #ZDSecMgrMasterKeyStore
        MOV.B   R12, R11
??ZDSecMgrMasterKeyLoad_0:
        MOV.B   R11, R12
          CFI EndBlock cfiBlock178
        REQUIRE ?Subroutine9
        // Fall through to label ?Subroutine9

        RSEG CODE:CODE:NOROOT(1)
?Subroutine9:
          CFI Block cfiBlock179 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+12
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
        ADD.W   #0x4, SP
          CFI CFA SP+8
        POPM.W  #0x2, R11
          CFI CFA SP+4
          CFI R10L SameValue
          CFI R11L SameValue
        RETA
          CFI EndBlock cfiBlock179

        RSEG CODE:CODE:NOROOT(1)
?Subroutine31:
          CFI Block cfiCond180 Using cfiCommon0
          CFI Function APSME_MasterKeyGet
          CFI Conditional ??CrossCallReturnLabel_17
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+14
          CFI Block cfiCond181 Using cfiCommon0
          CFI (cfiCond181) Function ZDSecMgrMasterKeyLoad
          CFI (cfiCond181) Conditional ??CrossCallReturnLabel_18
          CFI (cfiCond181) R10L Frame(CFA, -8)
          CFI (cfiCond181) R11L Frame(CFA, -6)
          CFI (cfiCond181) CFA SP+16
          CFI Block cfiPicker182 Using cfiCommon1
          CFI (cfiPicker182) NoFunction
          CFI (cfiPicker182) Picker
        MOV.W   R13, R10
        MOV.W   SP, R13
        ADD.W   #0x4, R13
        CALLA   #ZDSecMgrExtAddrLookup
        MOV.B   R12, R11
        CMP.B   #0x0, R12
        RETA
          CFI EndBlock cfiCond180
          CFI EndBlock cfiCond181
          CFI EndBlock cfiPicker182

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrCtrlReset:
          CFI Block cfiBlock183 Using cfiCommon0
          CFI Function ZDSecMgrCtrlReset
        FUNCALL ZDSecMgrCtrlReset, ZDSecMgrCtrlLookup
        LOCFRAME CSTACK, 10, STACK
        FUNCALL ZDSecMgrCtrlReset, ZDSecMgrCtrlSet
        LOCFRAME CSTACK, 10, STACK
        FUNCALL ZDSecMgrCtrlReset, ZDSecMgrCtrlAdd
        LOCFRAME CSTACK, 10, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        SUB.W   #0x2, SP
          CFI CFA SP+10
        MOV.W   R12, R10
        MOV.W   R13, R11
        MOV.W   SP, R13
        ADD.W   #0x0, R13
        MOV.W   R11, R12
        CALLA   #?Subroutine40
??CrossCallReturnLabel_44:
        JEQ     ??ZDSecMgrCtrlReset_0
        MOV.W   @SP, R14
        MOV.W   R11, R13
        MOV.W   R10, R12
        CALLA   #ZDSecMgrCtrlSet
        MOV.B   #0x0, R12
        JMP     ??ZDSecMgrCtrlReset_1
??ZDSecMgrCtrlReset_0:
        MOV.W   R11, R13
        MOV.W   R10, R12
        CALLA   #ZDSecMgrCtrlAdd
??ZDSecMgrCtrlReset_1:
        BRA     #??Subroutine2_0
          CFI EndBlock cfiBlock183

        RSEG CODE:CODE:NOROOT(1)
?Subroutine40:
          CFI Block cfiCond184 Using cfiCommon0
          CFI Function ZDSecMgrDeviceCtrlUpdate
          CFI Conditional ??CrossCallReturnLabel_43
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+14
          CFI Block cfiCond185 Using cfiCommon0
          CFI (cfiCond185) Function ZDSecMgrCtrlReset
          CFI (cfiCond185) Conditional ??CrossCallReturnLabel_44
          CFI (cfiCond185) R10L Frame(CFA, -8)
          CFI (cfiCond185) R11L Frame(CFA, -6)
          CFI (cfiCond185) CFA SP+14
          CFI Block cfiCond186 Using cfiCommon0
          CFI (cfiCond186) Function ZDSecMgrCtrlTerm
          CFI (cfiCond186) Conditional ??CrossCallReturnLabel_45
          CFI (cfiCond186) CFA SP+10
          CFI Block cfiPicker187 Using cfiCommon1
          CFI (cfiPicker187) NoFunction
          CFI (cfiPicker187) Picker
        CALLA   #ZDSecMgrCtrlLookup
        CMP.W   #0x0, 0x4(SP)
        RETA
          CFI EndBlock cfiCond184
          CFI EndBlock cfiCond185
          CFI EndBlock cfiCond186
          CFI EndBlock cfiPicker187

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrCtrlTerm:
          CFI Block cfiBlock188 Using cfiCommon0
          CFI Function ZDSecMgrCtrlTerm
        FUNCALL ZDSecMgrCtrlTerm, ZDSecMgrCtrlLookup
        LOCFRAME CSTACK, 6, STACK
        SUB.W   #0x2, SP
          CFI CFA SP+6
        MOV.W   SP, R13
        ADD.W   #0x0, R13
        CALLA   #?Subroutine40
??CrossCallReturnLabel_45:
        JEQ     ??ZDSecMgrCtrlTerm_0
        MOV.W   @SP, R15
        MOV.B   #0x0, 0x5(R15)
??ZDSecMgrCtrlTerm_0:
        ADD.W   #0x2, SP
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock188

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrCtrlAdd:
          CFI Block cfiBlock189 Using cfiCommon0
          CFI Function ZDSecMgrCtrlAdd
        FUNCALL ZDSecMgrCtrlAdd, ZDSecMgrCtrlSet
        LOCFRAME CSTACK, 8, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        MOV.W   &ZDSecMgrCtrlData, R10
        CMP.W   #0x0, R10
        JEQ     ??ZDSecMgrCtrlAdd_1
        MOV.W   #0x0, R11
??ZDSecMgrCtrlAdd_0:
        MOV.W   R11, R15
        RLAM.W  #0x3, R15
        MOV.W   R10, R14
        ADD.W   R15, R14
        CMP.B   #0x0, 0x5(R14)
        JNE     ??ZDSecMgrCtrlAdd_2
        CALLA   #ZDSecMgrCtrlSet
        MOV.B   #0x0, R12
        JMP     ??ZDSecMgrCtrlAdd_3
??ZDSecMgrCtrlAdd_2:
        ADD.W   #0x1, R11
        CMP.W   #0x3, R11
        JNC     ??ZDSecMgrCtrlAdd_0
??ZDSecMgrCtrlAdd_1:
        MOV.B   #0xc8, R12
??ZDSecMgrCtrlAdd_3:
        POPM.W  #0x2, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock189

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrCtrlSet:
          CFI Block cfiBlock190 Using cfiCommon0
          CFI Function ZDSecMgrCtrlSet
        MOV.W   0x4(R12), 0x2(R14)
        MOV.B   0x6(R12), 0x4(R14)
        MOV.W   R13, 0(R14)
        MOV.B   #0x1, 0x5(R14)
        MOV.B   #0x0, 0x6(R14)
        MOV.W   R14, 0x8(R12)
        RETA
          CFI EndBlock cfiBlock190

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrCtrlLookup:
          CFI Block cfiBlock191 Using cfiCommon0
          CFI Function ZDSecMgrCtrlLookup
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        MOV.W   #0x0, 0(R13)
        MOV.W   &ZDSecMgrCtrlData, R14
        CMP.W   #0x0, R14
        JEQ     ??ZDSecMgrCtrlLookup_1
        MOV.W   #0x0, R10
??ZDSecMgrCtrlLookup_0:
        MOV.W   R10, R15
        RLAM.W  #0x3, R15
        MOV.W   R14, R11
        ADD.W   R15, R11
        CMP.B   #0x0, 0x5(R11)
        JEQ     ??ZDSecMgrCtrlLookup_2
        CMP.W   R12, 0(R11)
        JNE     ??ZDSecMgrCtrlLookup_2
        MOV.W   R11, 0(R13)
        JMP     ??ZDSecMgrCtrlLookup_1
??ZDSecMgrCtrlLookup_2:
        ADD.W   #0x1, R10
        CMP.W   #0x3, R10
        JNC     ??ZDSecMgrCtrlLookup_0
??ZDSecMgrCtrlLookup_1:
        POPM.W  #0x2, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock191

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrCtrlRelease:
          CFI Block cfiBlock192 Using cfiCommon0
          CFI Function ZDSecMgrCtrlRelease
        MOV.B   #0x0, 0x5(R12)
        RETA
          CFI EndBlock cfiBlock192

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrCtrlInit:
          CFI Block cfiBlock193 Using cfiCommon0
          CFI Function ZDSecMgrCtrlInit
        FUNCALL ZDSecMgrCtrlInit, osal_mem_alloc
        LOCFRAME CSTACK, 4, STACK
        CALLA   #?Subroutine15
??CrossCallReturnLabel_1:
        MOV.W   R12, &ZDSecMgrCtrlData
        CMP.W   #0x0, R12
        JEQ     ??ZDSecMgrCtrlInit_1
        MOV.W   #0x0, R14
??ZDSecMgrCtrlInit_0:
        MOV.W   &ZDSecMgrCtrlData, R13
        MOV.W   R14, R15
        RLAM.W  #0x3, R15
        ADD.W   R15, R13
        MOV.B   #0x0, 0x5(R13)
        CALLA   #?Subroutine32
??CrossCallReturnLabel_19:
        JNC     ??ZDSecMgrCtrlInit_0
??ZDSecMgrCtrlInit_1:
        RETA
          CFI EndBlock cfiBlock193

        RSEG CODE:CODE:NOROOT(1)
?Subroutine15:
          CFI Block cfiCond194 Using cfiCommon0
          CFI Function ZDSecMgrSetDefaultNV
          CFI Conditional ??CrossCallReturnLabel_3
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+20
          CFI Block cfiCond195 Using cfiCommon0
          CFI (cfiCond195) Function APSME_LinkKeySet
          CFI (cfiCond195) Conditional ??CrossCallReturnLabel_2
          CFI (cfiCond195) R8L Frame(CFA, -12)
          CFI (cfiCond195) R9L Frame(CFA, -10)
          CFI (cfiCond195) R10L Frame(CFA, -8)
          CFI (cfiCond195) R11L Frame(CFA, -6)
          CFI (cfiCond195) CFA SP+20
          CFI Block cfiCond196 Using cfiCommon0
          CFI (cfiCond196) Function ZDSecMgrCtrlInit
          CFI (cfiCond196) Conditional ??CrossCallReturnLabel_1
          CFI (cfiCond196) CFA SP+8
          CFI Block cfiCond197 Using cfiCommon0
          CFI (cfiCond197) Function ZDSecMgrEntryFree
          CFI (cfiCond197) Conditional ??CrossCallReturnLabel_0
          CFI (cfiCond197) R10L Frame(CFA, -8)
          CFI (cfiCond197) R11L Frame(CFA, -6)
          CFI (cfiCond197) CFA SP+12
          CFI Block cfiPicker198 Using cfiCommon1
          CFI (cfiPicker198) NoFunction
          CFI (cfiPicker198) Picker
        MOV.W   #0x18, R12
        BRA     #osal_mem_alloc
          CFI EndBlock cfiCond194
          CFI EndBlock cfiCond195
          CFI EndBlock cfiCond196
          CFI EndBlock cfiCond197
          CFI EndBlock cfiPicker198

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrEntryNew:
          CFI Block cfiBlock199 Using cfiCommon0
          CFI Function ZDSecMgrEntryNew
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        MOV.W   #0x0, 0(R12)
        MOV.W   &ZDSecMgrEntries, R15
        CMP.W   #0x0, R15
        JEQ     ??ZDSecMgrEntryNew_1
        MOV.W   #0x0, R14
??ZDSecMgrEntryNew_0:
        MOV.W   R14, R13
        RPT     #0x5
        ADDX.W  R14, R13
        MOV.W   R15, R10
        ADD.W   R13, R10
        CMP.W   #0xfffe, 0(R10)
        JNE     ??ZDSecMgrEntryNew_2
        MOV.W   R10, 0(R12)
        MOV.W   &ZDSecMgrEntries, R15
        ADD.W   R13, R15
        MOV.B   #0x0, 0x4(R15)
        MOV.B   #0x0, R12
        JMP     ??ZDSecMgrEntryNew_3
??ZDSecMgrEntryNew_2:
        CALLA   #?Subroutine32
??CrossCallReturnLabel_20:
        JNC     ??ZDSecMgrEntryNew_0
??ZDSecMgrEntryNew_1:
        MOV.B   #0xc8, R12
??ZDSecMgrEntryNew_3:
        POP.W   R10
          CFI R10L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock199

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrEntryFree:
          CFI Block cfiBlock200 Using cfiCommon0
          CFI Function ZDSecMgrEntryFree
        FUNCALL ZDSecMgrEntryFree, osal_mem_alloc
        LOCFRAME CSTACK, 8, STACK
        FUNCALL ZDSecMgrEntryFree, osal_memset
        LOCFRAME CSTACK, 8, STACK
        FUNCALL ZDSecMgrEntryFree, osal_nv_write
        LOCFRAME CSTACK, 8, STACK
        FUNCALL ZDSecMgrEntryFree, osal_mem_free
        LOCFRAME CSTACK, 8, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        MOV.W   R12, R10
        CALLA   #?Subroutine15
??CrossCallReturnLabel_0:
        MOV.W   R12, R11
        CMP.W   #0x0, R12
        JEQ     ??ZDSecMgrEntryFree_0
        CALLA   #?Subroutine27
??CrossCallReturnLabel_14:
        CALLA   #?Subroutine28
??CrossCallReturnLabel_62:
        MOV.W   0x2(R10), R12
        CALLA   #osal_nv_write
        MOV.W   #0x0, 0x2(R10)
        MOV.W   R11, R12
        CALLA   #osal_mem_free
??ZDSecMgrEntryFree_0:
        MOV.W   #0xfffe, 0(R10)
        MOV.B   #0x0, 0x4(R10)
        POPM.W  #0x2, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock200

        RSEG CODE:CODE:NOROOT(1)
?Subroutine27:
          CFI Block cfiCond201 Using cfiCommon0
          CFI Function ZDSecMgrSetDefaultNV
          CFI Conditional ??CrossCallReturnLabel_15
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+20
          CFI Block cfiCond202 Using cfiCommon0
          CFI (cfiCond202) Function ZDSecMgrEntryFree
          CFI (cfiCond202) Conditional ??CrossCallReturnLabel_14
          CFI (cfiCond202) R10L Frame(CFA, -8)
          CFI (cfiCond202) R11L Frame(CFA, -6)
          CFI (cfiCond202) CFA SP+12
          CFI Block cfiPicker203 Using cfiCommon1
          CFI (cfiPicker203) NoFunction
          CFI (cfiPicker203) Picker
        MOV.W   #0x18, R14
        MOV.B   #0x0, R13
        BRA     #osal_memset
          CFI EndBlock cfiCond201
          CFI EndBlock cfiCond202
          CFI EndBlock cfiPicker203

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrEntryLookupAMIGetIndex:
          CFI Block cfiBlock204 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupAMIGetIndex
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        MOV.W   &ZDSecMgrEntries, R15
        CMP.W   #0x0, R15
        JEQ     ??ZDSecMgrEntryLookupAMIGetIndex_1
        MOV.W   #0x0, R14
??ZDSecMgrEntryLookupAMIGetIndex_0:
        MOV.W   R14, R10
        RPT     #0x5
        ADDX.W  R14, R10
        MOV.W   R15, R11
        ADD.W   R10, R11
        CMP.W   R12, 0(R11)
        JNE     ??ZDSecMgrEntryLookupAMIGetIndex_2
        MOV.W   R14, 0(R13)
        MOV.B   #0x0, R12
        JMP     ??ZDSecMgrEntryLookupAMIGetIndex_3
??ZDSecMgrEntryLookupAMIGetIndex_2:
        CALLA   #?Subroutine32
??CrossCallReturnLabel_21:
        JNC     ??ZDSecMgrEntryLookupAMIGetIndex_0
??ZDSecMgrEntryLookupAMIGetIndex_1:
        MOV.B   #0xc8, R12
??ZDSecMgrEntryLookupAMIGetIndex_3:
        POPM.W  #0x2, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock204

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrEntryLookupExtGetIndex:
          CFI Block cfiBlock205 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupExtGetIndex
        FUNCALL ZDSecMgrEntryLookupExtGetIndex, ZDSecMgrExtAddrLookup
        LOCFRAME CSTACK, 10, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        SUB.W   #0x2, SP
          CFI CFA SP+10
        MOV.W   R13, R10
        MOV.W   R14, R11
        CALLA   #?Subroutine35
??CrossCallReturnLabel_33:
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrEntryLookupExtGetIndex_1
        MOV.W   &ZDSecMgrEntries, R15
        CMP.W   #0x0, R15
        JEQ     ??ZDSecMgrEntryLookupExtGetIndex_1
        MOV.W   #0x0, R14
??ZDSecMgrEntryLookupExtGetIndex_0:
        MOV.W   R14, R12
        RPT     #0x5
        ADDX.W  R14, R12
        MOV.W   R15, R13
        ADD.W   R12, R13
        CMP.W   @SP, 0(R13)
        JNE     ??ZDSecMgrEntryLookupExtGetIndex_2
        MOV.W   R13, 0(R10)
        MOV.W   R14, 0(R11)
        MOV.B   #0x0, R12
        JMP     ??ZDSecMgrEntryLookupExtGetIndex_3
??ZDSecMgrEntryLookupExtGetIndex_2:
        CALLA   #?Subroutine32
??CrossCallReturnLabel_22:
        JNC     ??ZDSecMgrEntryLookupExtGetIndex_0
??ZDSecMgrEntryLookupExtGetIndex_1:
        MOV.B   #0xc8, R12
??ZDSecMgrEntryLookupExtGetIndex_3:
        BRA     #??Subroutine2_0
          CFI EndBlock cfiBlock205

        RSEG CODE:CODE:NOROOT(1)
?Subroutine32:
          CFI Block cfiCond206 Using cfiCommon0
          CFI Function ZDSecMgrCtrlInit
          CFI Conditional ??CrossCallReturnLabel_19
          CFI CFA SP+8
          CFI Block cfiCond207 Using cfiCommon0
          CFI (cfiCond207) Function ZDSecMgrEntryNew
          CFI (cfiCond207) Conditional ??CrossCallReturnLabel_20
          CFI (cfiCond207) R10L Frame(CFA, -6)
          CFI (cfiCond207) CFA SP+10
          CFI Block cfiCond208 Using cfiCommon0
          CFI (cfiCond208) Function ZDSecMgrEntryLookupAMIGetIndex
          CFI (cfiCond208) Conditional ??CrossCallReturnLabel_21
          CFI (cfiCond208) R10L Frame(CFA, -8)
          CFI (cfiCond208) R11L Frame(CFA, -6)
          CFI (cfiCond208) CFA SP+12
          CFI Block cfiCond209 Using cfiCommon0
          CFI (cfiCond209) Function ZDSecMgrEntryLookupExtGetIndex
          CFI (cfiCond209) Conditional ??CrossCallReturnLabel_22
          CFI (cfiCond209) R10L Frame(CFA, -8)
          CFI (cfiCond209) R11L Frame(CFA, -6)
          CFI (cfiCond209) CFA SP+14
          CFI Block cfiCond210 Using cfiCommon0
          CFI (cfiCond210) Function ZDSecMgrEntryLookupAMI
          CFI (cfiCond210) Conditional ??CrossCallReturnLabel_23
          CFI (cfiCond210) R10L Frame(CFA, -8)
          CFI (cfiCond210) R11L Frame(CFA, -6)
          CFI (cfiCond210) CFA SP+12
          CFI Block cfiCond211 Using cfiCommon0
          CFI (cfiCond211) Function ZDSecMgrEntryInit
          CFI (cfiCond211) Conditional ??CrossCallReturnLabel_24
          CFI (cfiCond211) CFA SP+8
          CFI Block cfiPicker212 Using cfiCommon1
          CFI (cfiPicker212) NoFunction
          CFI (cfiPicker212) Picker
        ADD.W   #0x1, R14
        CMP.W   #0x3, R14
        RETA
          CFI EndBlock cfiCond206
          CFI EndBlock cfiCond207
          CFI EndBlock cfiCond208
          CFI EndBlock cfiCond209
          CFI EndBlock cfiCond210
          CFI EndBlock cfiCond211
          CFI EndBlock cfiPicker212

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrEntryLookupExt:
          CFI Block cfiBlock213 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupExt
        FUNCALL ZDSecMgrEntryLookupExt, ZDSecMgrExtAddrLookup
        LOCFRAME CSTACK, 10, STACK
        FUNCALL ZDSecMgrEntryLookupExt, ZDSecMgrEntryLookupAMI
        LOCFRAME CSTACK, 10, STACK
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        SUB.W   #0x2, SP
          CFI CFA SP+10
        MOV.W   R13, R10
        MOV.W   #0x0, 0(R13)
        MOV.B   #0xc8, R11
        CALLA   #?Subroutine35
??CrossCallReturnLabel_32:
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrEntryLookupExt_0
        MOV.W   R10, R13
        MOV.W   @SP, R12
        CALLA   #ZDSecMgrEntryLookupAMI
        MOV.B   R12, R11
??ZDSecMgrEntryLookupExt_0:
        BRA     #?Subroutine2
          CFI EndBlock cfiBlock213

        RSEG CODE:CODE:NOROOT(1)
?Subroutine35:
          CFI Block cfiCond214 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupExtGetIndex
          CFI Conditional ??CrossCallReturnLabel_33
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+14
          CFI Block cfiCond215 Using cfiCommon0
          CFI (cfiCond215) Function ZDSecMgrEntryLookupExt
          CFI (cfiCond215) Conditional ??CrossCallReturnLabel_32
          CFI (cfiCond215) R10L Frame(CFA, -8)
          CFI (cfiCond215) R11L Frame(CFA, -6)
          CFI (cfiCond215) CFA SP+14
          CFI Block cfiCond216 Using cfiCommon0
          CFI (cfiCond216) Function ZDSecMgrAddrClear
          CFI (cfiCond216) Conditional ??CrossCallReturnLabel_31
          CFI (cfiCond216) R10L Frame(CFA, -6)
          CFI (cfiCond216) CFA SP+26
          CFI Block cfiPicker217 Using cfiCommon1
          CFI (cfiPicker217) NoFunction
          CFI (cfiPicker217) Picker
        MOV.W   SP, R13
        ADD.W   #0x4, R13
        BRA     #ZDSecMgrExtAddrLookup
          CFI EndBlock cfiCond214
          CFI EndBlock cfiCond215
          CFI EndBlock cfiCond216
          CFI EndBlock cfiPicker217

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrEntryLookupAMI:
          CFI Block cfiBlock218 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookupAMI
        PUSHM.W #0x2, R11
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+8
        MOV.W   #0x0, 0(R13)
        MOV.W   &ZDSecMgrEntries, R15
        CMP.W   #0x0, R15
        JEQ     ??ZDSecMgrEntryLookupAMI_1
        MOV.W   #0x0, R14
??ZDSecMgrEntryLookupAMI_0:
        MOV.W   R14, R11
        RPT     #0x5
        ADDX.W  R14, R11
        MOV.W   R15, R10
        ADD.W   R11, R10
        CMP.W   R12, 0(R10)
        JNE     ??ZDSecMgrEntryLookupAMI_2
        MOV.W   R10, 0(R13)
        MOV.B   #0x0, R12
        JMP     ??ZDSecMgrEntryLookupAMI_3
??ZDSecMgrEntryLookupAMI_2:
        CALLA   #?Subroutine32
??CrossCallReturnLabel_23:
        JNC     ??ZDSecMgrEntryLookupAMI_0
??ZDSecMgrEntryLookupAMI_1:
        MOV.B   #0xc8, R12
??ZDSecMgrEntryLookupAMI_3:
        POPM.W  #0x2, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock218

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrEntryLookup:
          CFI Block cfiBlock219 Using cfiCommon0
          CFI Function ZDSecMgrEntryLookup
        FUNCALL ZDSecMgrEntryLookup, AddrMgrEntryLookupNwk
        LOCFRAME CSTACK, 20, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0xe, SP
          CFI CFA SP+20
        MOV.W   R13, R10
        MOV.W   #0x0, 0(R13)
        CMP.W   #0x0, &ZDSecMgrEntries
        JEQ     ??ZDSecMgrEntryLookup_1
        MOV.B   #0x2, 0(SP)
        MOV.W   R12, 0x2(SP)
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #AddrMgrEntryLookupNwk
        CMP.B   #0x1, R12
        JNE     ??ZDSecMgrEntryLookup_1
        MOV.W   #0x0, R15
??ZDSecMgrEntryLookup_0:
        MOV.W   &ZDSecMgrEntries, R14
        MOV.W   R15, R13
        RPT     #0x5
        ADDX.W  R15, R13
        ADD.W   R13, R14
        CMP.W   @R14, 0xc(SP)
        JNE     ??ZDSecMgrEntryLookup_2
        MOV.W   R14, 0(R10)
        MOV.B   #0x0, R12
        JMP     ??ZDSecMgrEntryLookup_3
??ZDSecMgrEntryLookup_2:
        ADD.W   #0x1, R15
        CMP.W   #0x3, R15
        JNC     ??ZDSecMgrEntryLookup_0
??ZDSecMgrEntryLookup_1:
        MOV.B   #0xc8, R12
??ZDSecMgrEntryLookup_3:
        JMP     ??Subroutine0_0
          CFI EndBlock cfiBlock219

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrEntryInit:
          CFI Block cfiBlock220 Using cfiCommon0
          CFI Function ZDSecMgrEntryInit
        FUNCALL ZDSecMgrEntryInit, osal_mem_alloc
        LOCFRAME CSTACK, 4, STACK
        CMP.W   #0x0, &ZDSecMgrEntries
        JNE     ??ZDSecMgrEntryInit_1
        MOV.W   #0x12, R12
        CALLA   #osal_mem_alloc
        MOV.W   R12, &ZDSecMgrEntries
        MOV.W   R12, R15
        CMP.W   #0x0, R12
        JEQ     ??ZDSecMgrEntryInit_1
        MOV.W   #0x0, R14
??ZDSecMgrEntryInit_0:
        MOV.W   R14, R12
        RPT     #0x5
        ADDX.W  R14, R12
        MOV.W   R15, R13
        ADD.W   R12, R13
        MOV.W   #0xfffe, 0(R13)
        MOV.W   #0x0, 0x2(R13)
        CALLA   #?Subroutine32
??CrossCallReturnLabel_24:
        JNC     ??ZDSecMgrEntryInit_0
??ZDSecMgrEntryInit_1:
        RETA
          CFI EndBlock cfiBlock220

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrMasterKeyStore:
          CFI Block cfiBlock221 Using cfiCommon0
          CFI Function ZDSecMgrMasterKeyStore
        FUNCALL ZDSecMgrMasterKeyStore, osal_nv_read
        LOCFRAME CSTACK, 34, STACK
        FUNCALL ZDSecMgrMasterKeyStore, osal_memcpy
        LOCFRAME CSTACK, 34, STACK
        FUNCALL ZDSecMgrMasterKeyStore, osal_memset
        LOCFRAME CSTACK, 34, STACK
        FUNCALL ZDSecMgrMasterKeyStore, osal_nv_write
        LOCFRAME CSTACK, 34, STACK
        FUNCALL ZDSecMgrMasterKeyStore, osal_memset
        LOCFRAME CSTACK, 34, STACK
        FUNCALL ZDSecMgrMasterKeyStore, osal_memset
        LOCFRAME CSTACK, 34, STACK
        PUSHM.W #0x6, R11
          CFI R6L Frame(CFA, -16)
          CFI R7L Frame(CFA, -14)
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+16
        SUB.W   #0x12, SP
          CFI CFA SP+34
        MOV.W   R12, R10
        MOV.W   R13, R11
        MOV.W   #0x0, R8
        MOV.W   SP, R9
        ADD.W   #0x0, R9
??ZDSecMgrMasterKeyStore_0:
        CALLA   #?Subroutine20
??CrossCallReturnLabel_11:
        CMP.W   #0xfffe, 0(SP)
        JNE     ??ZDSecMgrMasterKeyStore_1
        MOV.W   R10, 0(SP)
        CMP.W   #0x0, R11
        MOV.W   #0x10, R14
        JEQ     ??ZDSecMgrMasterKeyStore_2
        MOV.W   R11, R13
        MOV.W   R9, R12
        ADD.W   #0x2, R12
        CALLA   #osal_memcpy
        JMP     ??ZDSecMgrMasterKeyStore_3
??ZDSecMgrMasterKeyStore_2:
        MOV.B   #0x0, R13
        MOV.W   R9, R12
        ADD.W   #0x2, R12
        CALLA   #osal_memset
??ZDSecMgrMasterKeyStore_3:
        MOV.W   R9, R15
        MOV.W   #0x12, R14
        MOV.W   #0x0, R13
        MOV.W   R6, R12
        CALLA   #osal_nv_write
        CALLA   #?Subroutine25
??CrossCallReturnLabel_77:
        MOV.B   #0x0, R12
        JMP     ??ZDSecMgrMasterKeyStore_4
??ZDSecMgrMasterKeyStore_1:
        ADD.W   #0x1, R8
        CMP.W   #0x3, R8
        JNC     ??ZDSecMgrMasterKeyStore_0
        CALLA   #?Subroutine24
          CFI EndBlock cfiBlock221
??ZDSecMgrMasterKeyStore_4:
        REQUIRE ?Subroutine7
        // Fall through to label ?Subroutine7

        RSEG CODE:CODE:NOROOT(1)
?Subroutine7:
          CFI Block cfiBlock222 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+34
          CFI R6L Frame(CFA, -16)
          CFI R7L Frame(CFA, -14)
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
        ADD.W   #0x12, SP
          CFI CFA SP+16
        POPM.W  #0x6, R11
          CFI CFA SP+4
          CFI R6L SameValue
          CFI R7L SameValue
          CFI R8L SameValue
          CFI R9L SameValue
          CFI R10L SameValue
          CFI R11L SameValue
        RETA
          CFI EndBlock cfiBlock222

        RSEG CODE:CODE:NOROOT(1)
?Subroutine25:
          CFI Block cfiCond223 Using cfiCommon0
          CFI Function ZDSecMgrMasterKeyStore
          CFI Conditional ??CrossCallReturnLabel_77
          CFI R6L Frame(CFA, -16)
          CFI R7L Frame(CFA, -14)
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+38
          CFI Block cfiCond224 Using cfiCommon0
          CFI (cfiCond224) Function ZDSecMgrMasterKeyLookup
          CFI (cfiCond224) Conditional ??CrossCallReturnLabel_76
          CFI (cfiCond224) R6L Frame(CFA, -16)
          CFI (cfiCond224) R7L Frame(CFA, -14)
          CFI (cfiCond224) R8L Frame(CFA, -12)
          CFI (cfiCond224) R9L Frame(CFA, -10)
          CFI (cfiCond224) R10L Frame(CFA, -8)
          CFI (cfiCond224) R11L Frame(CFA, -6)
          CFI (cfiCond224) CFA SP+38
          CFI Block cfiPicker225 Using cfiCommon1
          CFI (cfiPicker225) NoFunction
          CFI (cfiPicker225) Picker
        MOV.W   #0x12, R14
          CFI EndBlock cfiCond223
          CFI EndBlock cfiCond224
          CFI EndBlock cfiPicker225
        REQUIRE ??Subroutine49_0
        // Fall through to label ??Subroutine49_0

        RSEG CODE:CODE:NOROOT(1)
??Subroutine49_0:
          CFI Block cfiCond226 Using cfiCommon0
          CFI Function APSME_TCLinkKeyLoad
          CFI Conditional ??CrossCallReturnLabel_75
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+62
          CFI Block cfiCond227 Using cfiCommon0
          CFI (cfiCond227) Function ZDSecMgrMasterKeyStore
          CFI (cfiCond227) Conditional ??CrossCallReturnLabel_77
          CFI (cfiCond227) R6L Frame(CFA, -16)
          CFI (cfiCond227) R7L Frame(CFA, -14)
          CFI (cfiCond227) R8L Frame(CFA, -12)
          CFI (cfiCond227) R9L Frame(CFA, -10)
          CFI (cfiCond227) R10L Frame(CFA, -8)
          CFI (cfiCond227) R11L Frame(CFA, -6)
          CFI (cfiCond227) CFA SP+38
          CFI Block cfiCond228 Using cfiCommon0
          CFI (cfiCond228) Function ZDSecMgrMasterKeyLookup
          CFI (cfiCond228) Conditional ??CrossCallReturnLabel_76
          CFI (cfiCond228) R6L Frame(CFA, -16)
          CFI (cfiCond228) R7L Frame(CFA, -14)
          CFI (cfiCond228) R8L Frame(CFA, -12)
          CFI (cfiCond228) R9L Frame(CFA, -10)
          CFI (cfiCond228) R10L Frame(CFA, -8)
          CFI (cfiCond228) R11L Frame(CFA, -6)
          CFI (cfiCond228) CFA SP+38
          CFI Block cfiPicker229 Using cfiCommon1
          CFI (cfiPicker229) NoFunction
          CFI (cfiPicker229) Picker
        MOV.B   #0x0, R13
        MOV.W   R9, R12
        BRA     #osal_memset
          CFI EndBlock cfiCond226
          CFI EndBlock cfiCond227
          CFI EndBlock cfiCond228
          CFI EndBlock cfiPicker229

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrMasterKeyLookup:
          CFI Block cfiBlock230 Using cfiCommon0
          CFI Function ZDSecMgrMasterKeyLookup
        FUNCALL ZDSecMgrMasterKeyLookup, osal_nv_read
        LOCFRAME CSTACK, 34, STACK
        FUNCALL ZDSecMgrMasterKeyLookup, osal_memset
        LOCFRAME CSTACK, 34, STACK
        FUNCALL ZDSecMgrMasterKeyLookup, osal_memset
        LOCFRAME CSTACK, 34, STACK
        PUSHM.W #0x6, R11
          CFI R6L Frame(CFA, -16)
          CFI R7L Frame(CFA, -14)
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+16
        SUB.W   #0x12, SP
          CFI CFA SP+34
        MOV.W   R12, R10
        MOV.W   R13, R11
        MOV.W   #0x0, R8
        MOV.W   SP, R9
        ADD.W   #0x0, R9
??ZDSecMgrMasterKeyLookup_0:
        CALLA   #?Subroutine20
??CrossCallReturnLabel_10:
        CMP.W   R10, 0(SP)
        JNE     ??ZDSecMgrMasterKeyLookup_1
        MOV.W   R6, 0(R11)
        CALLA   #?Subroutine25
??CrossCallReturnLabel_76:
        MOV.B   #0x0, R12
        JMP     ??ZDSecMgrMasterKeyLookup_2
??ZDSecMgrMasterKeyLookup_1:
        ADD.W   #0x1, R8
        CMP.W   #0x3, R8
        JNC     ??ZDSecMgrMasterKeyLookup_0
        MOV.W   #0x0, 0(R11)
        CALLA   #?Subroutine24
??ZDSecMgrMasterKeyLookup_2:
        JMP     ?Subroutine7
          CFI EndBlock cfiBlock230

        RSEG CODE:CODE:NOROOT(1)
?Subroutine24:
          CFI Block cfiCond231 Using cfiCommon0
          CFI Function ZDSecMgrMasterKeyStore
          CFI Conditional ??ZDSecMgrMasterKeyStore_4
          CFI R6L Frame(CFA, -16)
          CFI R7L Frame(CFA, -14)
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+38
          CFI Block cfiCond232 Using cfiCommon0
          CFI (cfiCond232) Function ZDSecMgrMasterKeyLookup
          CFI (cfiCond232) Conditional ??ZDSecMgrMasterKeyLookup_2
          CFI (cfiCond232) R6L Frame(CFA, -16)
          CFI (cfiCond232) R7L Frame(CFA, -14)
          CFI (cfiCond232) R8L Frame(CFA, -12)
          CFI (cfiCond232) R9L Frame(CFA, -10)
          CFI (cfiCond232) R10L Frame(CFA, -8)
          CFI (cfiCond232) R11L Frame(CFA, -6)
          CFI (cfiCond232) CFA SP+38
          CFI Block cfiPicker233 Using cfiCommon1
          CFI (cfiPicker233) NoFunction
          CFI (cfiPicker233) Picker
        MOV.W   #0x12, R14
        MOV.B   #0x0, R13
        MOV.W   R9, R12
        CALLA   #osal_memset
        MOV.B   #0xc8, R12
        RETA
          CFI EndBlock cfiCond231
          CFI EndBlock cfiCond232
          CFI EndBlock cfiPicker233

        RSEG CODE:CODE:NOROOT(1)
?Subroutine20:
          CFI Block cfiCond234 Using cfiCommon0
          CFI Function ZDSecMgrMasterKeyStore
          CFI Conditional ??CrossCallReturnLabel_11
          CFI R6L Frame(CFA, -16)
          CFI R7L Frame(CFA, -14)
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+38
          CFI Block cfiCond235 Using cfiCommon0
          CFI (cfiCond235) Function ZDSecMgrMasterKeyLookup
          CFI (cfiCond235) Conditional ??CrossCallReturnLabel_10
          CFI (cfiCond235) R6L Frame(CFA, -16)
          CFI (cfiCond235) R7L Frame(CFA, -14)
          CFI (cfiCond235) R8L Frame(CFA, -12)
          CFI (cfiCond235) R9L Frame(CFA, -10)
          CFI (cfiCond235) R10L Frame(CFA, -8)
          CFI (cfiCond235) R11L Frame(CFA, -6)
          CFI (cfiCond235) CFA SP+38
          CFI Block cfiPicker236 Using cfiCommon1
          CFI (cfiPicker236) NoFunction
          CFI (cfiPicker236) Picker
        MOV.W   R8, R6
        ADD.W   #0x301, R6
        MOV.W   R9, R15
        MOV.W   #0x12, R14
        MOV.W   #0x0, R13
        MOV.W   R6, R12
        BRA     #osal_nv_read
          CFI EndBlock cfiCond234
          CFI EndBlock cfiCond235
          CFI EndBlock cfiPicker236

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAddrClear:
          CFI Block cfiBlock237 Using cfiCommon0
          CFI Function ZDSecMgrAddrClear
        FUNCALL ZDSecMgrAddrClear, ZDSecMgrExtAddrLookup
        LOCFRAME CSTACK, 22, STACK
        FUNCALL ZDSecMgrAddrClear, AddrMgrEntryRelease
        LOCFRAME CSTACK, 22, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0x10, SP
          CFI CFA SP+22
        CALLA   #?Subroutine35
??CrossCallReturnLabel_31:
        MOV.B   R12, R10
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrAddrClear_0
        MOV.B   #0x2, 0x2(SP)
        MOV.W   @SP, 0xe(SP)
        MOV.W   SP, R12
        ADD.W   #0x2, R12
        CALLA   #AddrMgrEntryRelease
        CMP.B   #0x1, R12
        JEQ     ??ZDSecMgrAddrClear_0
        MOV.B   #0x1, R10
??ZDSecMgrAddrClear_0:
        MOV.B   R10, R12
        BRA     #?Subroutine5
          CFI EndBlock cfiBlock237

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrExtAddrLookup:
          CFI Block cfiBlock238 Using cfiCommon0
          CFI Function ZDSecMgrExtAddrLookup
        FUNCALL ZDSecMgrExtAddrLookup, AddrMgrExtAddrSet
        LOCFRAME CSTACK, 20, STACK
        FUNCALL ZDSecMgrExtAddrLookup, AddrMgrEntryLookupExt
        LOCFRAME CSTACK, 20, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        SUB.W   #0xe, SP
          CFI CFA SP+20
        MOV.W   R13, R10
        MOV.B   #0x2, 0(SP)
        MOV.W   R12, R13
        MOV.W   SP, R12
        ADD.W   #0x4, R12
        CALLA   #AddrMgrExtAddrSet
        MOV.W   SP, R12
        ADD.W   #0x0, R12
        CALLA   #AddrMgrEntryLookupExt
        JMP     ??Subroutine0_1
          CFI EndBlock cfiBlock238

        RSEG CODE:CODE:NOROOT(1)
?Subroutine0:
          CFI Block cfiBlock239 Using cfiCommon0
          CFI NoFunction
        PUSH.W  R10
          CFI CFA SP+6
          CFI R10L Frame(CFA, -6)
        SUB.W   #0xe, SP
          CFI CFA SP+20
        MOV.W   R14, R10
        CALLA   #?Subroutine30
??Subroutine0_1:
        CMP.B   #0x1, R12
        MOV.W   0xc(SP), R15
        JNE     ??Subroutine0_2
        MOV.B   #0x0, R12
        JMP     ??Subroutine0_3
??Subroutine0_2:
        MOV.B   #0xc8, R12
??Subroutine0_3:
        MOV.W   R15, 0(R10)
          CFI EndBlock cfiBlock239
        REQUIRE ??Subroutine0_0
        // Fall through to label ??Subroutine0_0

        RSEG CODE:CODE:NOROOT(1)
??Subroutine0_0:
          CFI Block cfiBlock240 Using cfiCommon0
          CFI NoFunction
          CFI CFA SP+20
          CFI R10L Frame(CFA, -6)
        ADD.W   #0xe, SP
          CFI CFA SP+6
        POP.W   R10
          CFI CFA SP+4
          CFI R10L SameValue
        RETA
          CFI EndBlock cfiBlock240

        RSEG CODE:CODE:NOROOT(1)
?Subroutine30:
          CFI Block cfiCond241 Using cfiCommon0
          CFI Function ZDSecMgrSetupPartner
          CFI Conditional ??CrossCallReturnLabel_16
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+30
          CFI Block cfiCond242 Using cfiCommon0
          CFI (cfiCond242) Function ZDSecMgrExtAddrStore
          CFI (cfiCond242) Conditional ??Subroutine0_1
          CFI (cfiCond242) R10L Frame(CFA, -6)
          CFI (cfiCond242) CFA SP+24
          CFI Block cfiCond243 Using cfiCommon0
          CFI (cfiCond243) Function ZDSecMgrAddrStore
          CFI (cfiCond243) Conditional ??Subroutine0_1
          CFI (cfiCond243) R10L Frame(CFA, -6)
          CFI (cfiCond243) CFA SP+24
          CFI Block cfiPicker244 Using cfiCommon1
          CFI (cfiPicker244) NoFunction
          CFI (cfiPicker244) Picker
        MOV.B   #0x2, 0x4(SP)
        MOV.W   R12, 0x6(SP)
        MOV.W   SP, R12
        ADD.W   #0x8, R12
        CALLA   #AddrMgrExtAddrSet
        MOV.W   SP, R12
        ADD.W   #0x4, R12
        BRA     #AddrMgrEntryUpdate
          CFI EndBlock cfiCond241
          CFI EndBlock cfiCond242
          CFI EndBlock cfiCond243
          CFI EndBlock cfiPicker244

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrExtAddrStore:
          CFI Block cfiBlock245 Using cfiCommon0
          CFI Function ZDSecMgrExtAddrStore
        FUNCALL ZDSecMgrExtAddrStore, AddrMgrExtAddrSet
        LOCFRAME CSTACK, 20, STACK
        FUNCALL ZDSecMgrExtAddrStore, AddrMgrEntryUpdate
        LOCFRAME CSTACK, 20, STACK
        JMP     ?Subroutine0
          CFI EndBlock cfiBlock245

        RSEG CODE:CODE:NOROOT(1)
ZDSecMgrAddrStore:
          CFI Block cfiBlock246 Using cfiCommon0
          CFI Function ZDSecMgrAddrStore
        FUNCALL ZDSecMgrAddrStore, AddrMgrExtAddrSet
        LOCFRAME CSTACK, 20, STACK
        FUNCALL ZDSecMgrAddrStore, AddrMgrEntryUpdate
        LOCFRAME CSTACK, 20, STACK
        JMP     ?Subroutine0
          CFI EndBlock cfiBlock246

        RSEG CODE:CODE:REORDER:NOROOT(1)
ZDSecMgrMasterKeyInit:
          CFI Block cfiBlock247 Using cfiCommon0
          CFI Function ZDSecMgrMasterKeyInit
        FUNCALL ZDSecMgrMasterKeyInit, osal_memset
        LOCFRAME CSTACK, 30, STACK
        FUNCALL ZDSecMgrMasterKeyInit, osal_nv_item_init
        LOCFRAME CSTACK, 30, STACK
        FUNCALL ZDSecMgrMasterKeyInit, osal_nv_write
        LOCFRAME CSTACK, 30, STACK
        PUSHM.W #0x4, R11
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+12
        SUB.W   #0x12, SP
          CFI CFA SP+30
        MOV.W   #0xfffe, 0(SP)
        MOV.W   SP, R10
        ADD.W   #0x0, R10
        MOV.W   #0x10, R14
        MOV.B   #0x0, R13
        MOV.W   R10, R12
        ADD.W   #0x2, R12
        CALLA   #osal_memset
        MOV.W   #0x0, R11
??ZDSecMgrMasterKeyInit_0:
        MOV.W   R11, R8
        ADD.W   #0x301, R8
        MOV.W   R10, R14
        MOV.W   #0x12, R13
        CALLA   #?Subroutine29
??CrossCallReturnLabel_50:
        JNE     ??ZDSecMgrMasterKeyInit_1
        MOV.W   R10, R15
        MOV.W   #0x12, R14
        MOV.W   #0x0, R13
        MOV.W   R8, R12
        CALLA   #osal_nv_write
??ZDSecMgrMasterKeyInit_1:
        ADD.W   #0x1, R11
        CMP.W   #0x3, R11
        JNC     ??ZDSecMgrMasterKeyInit_0
        BRA     #?Subroutine6
          CFI EndBlock cfiBlock247

        RSEG CODE:CODE:NOROOT(1)
?Subroutine14:
          CFI Block cfiCond248 Using cfiCommon0
          CFI Function ZDSecMgrSaveApsLinkKey
          CFI Conditional ??CrossCallReturnLabel_46
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+16
          CFI Block cfiCond249 Using cfiCommon0
          CFI (cfiCond249) Function APSME_IsLinkKeyValid
          CFI (cfiCond249) Conditional ??CrossCallReturnLabel_47
          CFI (cfiCond249) R10L Frame(CFA, -8)
          CFI (cfiCond249) R11L Frame(CFA, -6)
          CFI (cfiCond249) CFA SP+30
          CFI Block cfiPicker250 Using cfiCommon1
          CFI (cfiPicker250) NoFunction
          CFI (cfiPicker250) Picker
        MOV.W   #0x18, R12
          CFI EndBlock cfiCond248
          CFI EndBlock cfiCond249
          CFI EndBlock cfiPicker250
        REQUIRE ??Subroutine42_0
        // Fall through to label ??Subroutine42_0

        RSEG CODE:CODE:REORDER:NOROOT(1)
??Subroutine42_0:
          CFI Block cfiCond251 Using cfiCommon0
          CFI Function ZDSecMgrSaveTCLinkKey
          CFI Conditional ??CrossCallReturnLabel_48
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+10
          CFI Block cfiCond252 Using cfiCommon0
          CFI (cfiCond252) Function ZDSecMgrSaveApsLinkKey
          CFI (cfiCond252) Conditional ??CrossCallReturnLabel_46
          CFI (cfiCond252) R8L Frame(CFA, -12)
          CFI (cfiCond252) R9L Frame(CFA, -10)
          CFI (cfiCond252) R10L Frame(CFA, -8)
          CFI (cfiCond252) R11L Frame(CFA, -6)
          CFI (cfiCond252) CFA SP+16
          CFI Block cfiCond253 Using cfiCommon0
          CFI (cfiCond253) Function APSME_IsLinkKeyValid
          CFI (cfiCond253) Conditional ??CrossCallReturnLabel_47
          CFI (cfiCond253) R10L Frame(CFA, -8)
          CFI (cfiCond253) R11L Frame(CFA, -6)
          CFI (cfiCond253) CFA SP+30
          CFI Block cfiPicker254 Using cfiCommon1
          CFI (cfiPicker254) NoFunction
          CFI (cfiPicker254) Picker
        CALLA   #osal_mem_alloc
        MOV.W   R12, R10
        CMP.W   #0x0, R12
        RETA
          CFI EndBlock cfiCond251
          CFI EndBlock cfiCond252
          CFI EndBlock cfiCond253
          CFI EndBlock cfiPicker254
// 4316   {
// 4317     osal_nv_write( ZCD_NV_NWK_ALTERN_KEY_INFO, 0, sizeof(nwkKey), &nwkKey );
// 4318   }
// 4319 #endif // defined (NV_RESTORE)
// 4320 
// 4321 }
// 4322 
// 4323 /*********************************************************************
// 4324  * @fn          ZDSecMgrReadKeyFromNv
// 4325  *
// 4326  * @brief       Looks for a specific key in NV based on Index value
// 4327  *
// 4328  * @param   keyNvId - Index of key to look in NV
// 4329  *                    valid values are:
// 4330  *                    ZCD_NV_NWK_ACTIVE_KEY_INFO
// 4331  *                    ZCD_NV_NWK_ALTERN_KEY_INFO
// 4332  *                    ZCD_NV_TCLK_TABLE_START + <offset_in_table>
// 4333  *                    ZCD_NV_APS_LINK_KEY_DATA_START + <offset_in_table>
// 4334  *                    ZCD_NV_MASTER_KEY_DATA_START + <offset_in_table>
// 4335  *                    ZCD_NV_PRECFGKEY
// 4336  *
// 4337  * @param  *keyinfo - Data is read into this buffer.
// 4338  *
// 4339  * @return  SUCCESS if NV data was copied to the keyinfo parameter .
// 4340  *          Otherwise, NV_OPER_FAILED for failure.
// 4341  */
// 4342 ZStatus_t ZDSecMgrReadKeyFromNv(uint16 keyNvId, void *keyinfo)
// 4343 {
// 4344   if ((keyNvId == ZCD_NV_NWK_ACTIVE_KEY_INFO) ||
// 4345       (keyNvId == ZCD_NV_NWK_ALTERN_KEY_INFO))
// 4346   {
// 4347     // get NWK active or alternate key from NV
// 4348     return (osal_nv_read(keyNvId,
// 4349                          osal_offsetof(nwkKeyDesc, key),
// 4350                          SEC_KEY_LEN,
// 4351                          keyinfo));
// 4352   }
// 4353   else if ((keyNvId >= ZCD_NV_TCLK_TABLE_START) &&
// 4354            (keyNvId < (ZCD_NV_TCLK_TABLE_START + ZDSECMGR_TC_DEVICE_MAX)))
// 4355   {
// 4356     // Read entry keyNvId of the TC link key table from NV. keyNvId should be
// 4357     // ZCD_NV_TCLK_TABLE_START + <offset_in_table>
// 4358     return (osal_nv_read(keyNvId,
// 4359                          osal_offsetof(APSME_TCLinkKey_t, key),
// 4360                          SEC_KEY_LEN,
// 4361                          keyinfo));
// 4362   }
// 4363   else if ((keyNvId >= ZCD_NV_APS_LINK_KEY_DATA_START) &&
// 4364            (keyNvId < (ZCD_NV_APS_LINK_KEY_DATA_START + ZDSECMGR_ENTRY_MAX)))
// 4365   {
// 4366     // Read entry keyNvId of the APS link key table from NV. keyNvId should be
// 4367     // ZCD_NV_APS_LINK_KEY_DATA_START + <offset_in_table>
// 4368     return (osal_nv_read(keyNvId,
// 4369                          osal_offsetof(APSME_LinkKeyData_t, key),
// 4370                          SEC_KEY_LEN,
// 4371                          keyinfo));
// 4372   }
// 4373   else if ((keyNvId >= ZCD_NV_MASTER_KEY_DATA_START) &&
// 4374            (keyNvId < (ZCD_NV_MASTER_KEY_DATA_START + ZDSECMGR_MASTERKEY_MAX)))
// 4375   {
// 4376     // Read entry keyNvId of the MASTER key table from NV. keyNvId should be
// 4377     // ZCD_NV_MASTER_KEY_DATA_START + <offset_in_table>
// 4378     return (osal_nv_read(keyNvId,
// 4379                          osal_offsetof(ZDSecMgrMasterKeyData_t, key),
// 4380                          SEC_KEY_LEN,
// 4381                          keyinfo));
// 4382   }
// 4383   else if (keyNvId == ZCD_NV_PRECFGKEY)
// 4384   {
// 4385     // Read entry keyNvId of the Preconfig key from NV.
// 4386     return (osal_nv_read(keyNvId,
// 4387                          0,
// 4388                          SEC_KEY_LEN,
// 4389                          keyinfo));
// 4390   }
// 4391 
// 4392   return NV_OPER_FAILED;
// 4393 }
// 4394 
// 4395 /******************************************************************************
// 4396  * @fn          ZDSecMgrApsLinkKeyInit
// 4397  *
// 4398  * @brief       Initialize the NV table for Application link keys
// 4399  *
// 4400  * @param       none
// 4401  *
// 4402  * @return      none
// 4403  */
// 4404 void ZDSecMgrApsLinkKeyInit(void)
// 4405 {
// 4406   APSME_LinkKeyData_t pApsLinkKey;
// 4407   uint8 i;
// 4408   uint8 status;
// 4409 
// 4410   // Initialize all NV items for APS link key, if not exist already.
// 4411   osal_memset( &pApsLinkKey, 0x00, sizeof(APSME_LinkKeyData_t) );
// 4412 
// 4413   for( i = 0; i < ZDSECMGR_ENTRY_MAX; i++ )
// 4414   {
// 4415     status = osal_nv_item_init( (ZCD_NV_APS_LINK_KEY_DATA_START + i),
// 4416                                sizeof(APSME_LinkKeyData_t), &pApsLinkKey );
// 4417 
// 4418 #if defined ( NV_RESTORE )
// 4419     (void)status;   // to eliminate compiler warning
// 4420 #else
// 4421     // reset the values of NV items if NV_RESTORE is not enabled
// 4422     if (status == SUCCESS)
// 4423     {
// 4424       osal_nv_write( (ZCD_NV_APS_LINK_KEY_DATA_START + i), 0,
// 4425                     sizeof(APSME_LinkKeyData_t), &pApsLinkKey );
// 4426 
// 4427     }
// 4428 #endif // defined (NV_RESTORE)
// 4429   }
// 4430 }
// 4431 
// 4432 /******************************************************************************
// 4433  * @fn          ZDSecMgrInitNVKeyTables
// 4434  *
// 4435  * @brief       Initialize the NV table for All keys: NWK, Master, TCLK and APS
// 4436  *
// 4437  * @param       setDefault - TRUE to set default values
// 4438  *
// 4439  * @return      none
// 4440  */

        RSEG CODE:CODE:REORDER:NOROOT(1)
// 4441 void ZDSecMgrInitNVKeyTables(uint8 setDefault)
ZDSecMgrInitNVKeyTables:
          CFI Block cfiBlock255 Using cfiCommon0
          CFI Function ZDSecMgrInitNVKeyTables
// 4442 {
        FUNCALL ZDSecMgrInitNVKeyTables, ZDSecMgrNwkKeyInit
        LOCFRAME CSTACK, 6, STACK
        FUNCALL ZDSecMgrInitNVKeyTables, ZDSecMgrMasterKeyInit
        LOCFRAME CSTACK, 6, STACK
        FUNCALL ZDSecMgrInitNVKeyTables, ZDSecMgrApsLinkKeyInit
        LOCFRAME CSTACK, 6, STACK
        FUNCALL ZDSecMgrInitNVKeyTables, APSME_TCLinkKeyInit
        LOCFRAME CSTACK, 6, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
        MOV.B   R12, R10
// 4443   ZDSecMgrNwkKeyInit(setDefault);
        CALLA   #ZDSecMgrNwkKeyInit
// 4444   ZDSecMgrMasterKeyInit();
        CALLA   #ZDSecMgrMasterKeyInit
// 4445   ZDSecMgrApsLinkKeyInit();
        CALLA   #ZDSecMgrApsLinkKeyInit
// 4446   APSME_TCLinkKeyInit(setDefault);
        MOV.B   R10, R12
        CALLA   #APSME_TCLinkKeyInit
// 4447 }
        POP.W   R10
          CFI R10L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock255
// 4448 
// 4449 /******************************************************************************
// 4450  * @fn          ZDSecMgrSaveApsLinkKey
// 4451  *
// 4452  * @brief       Save APS Link Key to NV. It will loop through all the keys
// 4453  *              to see which one to save.
// 4454  *
// 4455  * @param       none
// 4456  *
// 4457  * @return      none
// 4458  */

        RSEG CODE:CODE:REORDER:NOROOT(1)
// 4459 void ZDSecMgrSaveApsLinkKey(void)
ZDSecMgrSaveApsLinkKey:
          CFI Block cfiBlock256 Using cfiCommon0
          CFI Function ZDSecMgrSaveApsLinkKey
// 4460 {
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_mem_alloc
        LOCFRAME CSTACK, 12, STACK
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_nv_read
        LOCFRAME CSTACK, 12, STACK
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_nv_write
        LOCFRAME CSTACK, 12, STACK
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_memset
        LOCFRAME CSTACK, 12, STACK
        FUNCALL ZDSecMgrSaveApsLinkKey, osal_mem_free
        LOCFRAME CSTACK, 12, STACK
        PUSHM.W #0x4, R11
          CFI R8L Frame(CFA, -12)
          CFI R9L Frame(CFA, -10)
          CFI R10L Frame(CFA, -8)
          CFI R11L Frame(CFA, -6)
          CFI CFA SP+12
// 4461   APSME_LinkKeyData_t *pKeyData = NULL;
// 4462   int i;
// 4463 
// 4464   pKeyData = (APSME_LinkKeyData_t *)osal_mem_alloc(sizeof(APSME_LinkKeyData_t));
        CALLA   #?Subroutine14
// 4465 
// 4466   if (pKeyData != NULL)
??CrossCallReturnLabel_46:
        JEQ     ??ZDSecMgrSaveApsLinkKey_1
// 4467   {
// 4468     // checks all pending flags to know which one to save
// 4469     for (i = 0; i < ZDSECMGR_ENTRY_MAX; i++)
        MOV.W   #0x0, R11
// 4470     {
// 4471       if (ApsLinkKeyFrmCntr[i].pendingFlag == TRUE)
??ZDSecMgrSaveApsLinkKey_0:
        MOV.W   R11, R8
        RPT     #0x9
        ADDX.W  R11, R8
        CMP.B   #0x1, ApsLinkKeyFrmCntr + 8(R8)
        JNE     ??ZDSecMgrSaveApsLinkKey_2
        MOV.W   R11, R9
        ADD.W   #0x201, R9
        MOV.W   R10, R15
        CALLA   #??Subroutine28_0
??CrossCallReturnLabel_55:
        MOV.W   R9, R12
// 4472       {
// 4473         // retrieve key from NV
// 4474         if (osal_nv_read(ZCD_NV_APS_LINK_KEY_DATA_START + i, 0,
// 4475                          sizeof(APSME_LinkKeyData_t), pKeyData) == SUCCESS)
        CALLA   #osal_nv_read
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrSaveApsLinkKey_2
// 4476         {
// 4477           pKeyData->txFrmCntr = ApsLinkKeyFrmCntr[i].txFrmCntr;
        MOV.W   ApsLinkKeyFrmCntr(R8), 0x10(R10)
        MOV.W   ApsLinkKeyFrmCntr + 2(R8), 0x12(R10)
// 4478           pKeyData->rxFrmCntr = ApsLinkKeyFrmCntr[i].rxFrmCntr;
        MOV.W   ApsLinkKeyFrmCntr + 4(R8), 0x14(R10)
        MOV.W   ApsLinkKeyFrmCntr + 6(R8), 0x16(R10)
// 4479 
// 4480           // Write the APS link key back to the NV
// 4481           osal_nv_write(ZCD_NV_APS_LINK_KEY_DATA_START + i, 0,
// 4482                         sizeof(APSME_LinkKeyData_t), pKeyData);
        MOV.W   R10, R15
        CALLA   #??Subroutine28_0
??CrossCallReturnLabel_56:
        MOV.W   R9, R12
        CALLA   #osal_nv_write
// 4483 
// 4484           // clear the pending write flag
// 4485           ApsLinkKeyFrmCntr[i].pendingFlag = FALSE;
        MOV.B   #0x0, ApsLinkKeyFrmCntr + 8(R8)
// 4486         }
// 4487       }
// 4488     }
??ZDSecMgrSaveApsLinkKey_2:
        ADD.W   #0x1, R11
        CMP.W   #0x3, R11
        JL      ??ZDSecMgrSaveApsLinkKey_0
// 4489 
// 4490     // clear copy of key in RAM
// 4491     osal_memset( pKeyData, 0x00, sizeof(APSME_LinkKeyData_t) );
        CALLA   #?Subroutine22
// 4492 
// 4493     osal_mem_free(pKeyData);
// 4494   }
// 4495 }
??ZDSecMgrSaveApsLinkKey_1:
        POPM.W  #0x4, R11
          CFI R10L SameValue
          CFI R11L SameValue
          CFI R8L SameValue
          CFI R9L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock256
// 4496 
// 4497 /******************************************************************************
// 4498  * @fn          ZDSecMgrSaveTCLinkKey
// 4499  *
// 4500  * @brief       Save TC Link Key to NV. It will loop through all the keys
// 4501  *              to see which one to save.
// 4502  *
// 4503  * @param       none
// 4504  *
// 4505  * @return      none
// 4506  */

        RSEG CODE:CODE:REORDER:NOROOT(1)
// 4507 void ZDSecMgrSaveTCLinkKey(void)
ZDSecMgrSaveTCLinkKey:
          CFI Block cfiBlock257 Using cfiCommon0
          CFI Function ZDSecMgrSaveTCLinkKey
// 4508 {
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_mem_alloc
        LOCFRAME CSTACK, 6, STACK
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_nv_read
        LOCFRAME CSTACK, 6, STACK
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_nv_write
        LOCFRAME CSTACK, 6, STACK
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_memset
        LOCFRAME CSTACK, 6, STACK
        FUNCALL ZDSecMgrSaveTCLinkKey, osal_mem_free
        LOCFRAME CSTACK, 6, STACK
        PUSH.W  R10
          CFI R10L Frame(CFA, -6)
          CFI CFA SP+6
// 4509   APSME_TCLinkKey_t *pKeyData = NULL;
// 4510   uint16 i;
// 4511 
// 4512   pKeyData = (APSME_TCLinkKey_t *)osal_mem_alloc(sizeof(APSME_TCLinkKey_t));
        MOV.W   #0x20, R12
        CALLA   #??Subroutine42_0
// 4513 
// 4514   if (pKeyData != NULL)
??CrossCallReturnLabel_48:
        JEQ     ??ZDSecMgrSaveTCLinkKey_0
// 4515   {
// 4516     for( i = 0; i < ZDSECMGR_TC_DEVICE_MAX; i++ )
// 4517     {
// 4518       if (TCLinkKeyFrmCntr[i].pendingFlag == TRUE)
        CMP.B   #0x1, &TCLinkKeyFrmCntr + 8
        JNE     ??ZDSecMgrSaveTCLinkKey_1
// 4519       {
// 4520         if (osal_nv_read(ZCD_NV_TCLK_TABLE_START + i, 0,
// 4521                          sizeof(APSME_TCLinkKey_t), pKeyData) == SUCCESS)
        MOV.W   R12, R15
        CALLA   #??Subroutine17_0
??CrossCallReturnLabel_64:
        CMP.B   #0x0, R12
        JNE     ??ZDSecMgrSaveTCLinkKey_1
// 4522         {
// 4523           pKeyData->txFrmCntr = TCLinkKeyFrmCntr[i].txFrmCntr;
        MOV.W   &TCLinkKeyFrmCntr, 0x18(R10)
        MOV.W   &TCLinkKeyFrmCntr + 2, 0x1a(R10)
// 4524           pKeyData->rxFrmCntr = TCLinkKeyFrmCntr[i].rxFrmCntr;
        MOV.W   &TCLinkKeyFrmCntr + 4, 0x1c(R10)
        MOV.W   &TCLinkKeyFrmCntr + 6, 0x1e(R10)
// 4525 
// 4526           // Write the TC link key back to the NV
// 4527           osal_nv_write(ZCD_NV_TCLK_TABLE_START + i, 0,
// 4528                         sizeof(APSME_TCLinkKey_t), pKeyData);
        CALLA   #?Subroutine19
// 4529 
// 4530           // clear the pending write flag
// 4531           TCLinkKeyFrmCntr[i].pendingFlag = FALSE;
??CrossCallReturnLabel_9:
        MOV.B   #0x0, &TCLinkKeyFrmCntr + 8
// 4532         }
// 4533       }
// 4534     }
// 4535       // clear copy of key in RAM
// 4536     osal_memset( pKeyData, 0x00, sizeof(APSME_TCLinkKey_t) );
??ZDSecMgrSaveTCLinkKey_1:
        CALLA   #?Subroutine18
// 4537 
// 4538     osal_mem_free(pKeyData);
??CrossCallReturnLabel_4:
        MOV.W   R10, R12
        CALLA   #osal_mem_free
// 4539   }
// 4540 }
??ZDSecMgrSaveTCLinkKey_0:
        POP.W   R10
          CFI R10L SameValue
          CFI CFA SP+4
        RETA
          CFI EndBlock cfiBlock257

        RSEG DATA16_ID:CONST:SORT:NOROOT(0)
`?<Initializer for ZDSecMgrAppKeyType>`:
        DC8 3

        RSEG CODE:CODE:REORDER:NOROOT(1)
?setjmp_save_r4:
        REQUIRE ?setjmp_r4
        REQUIRE ?longjmp_r4

        RSEG CODE:CODE:REORDER:NOROOT(1)
?setjmp_save_r5:
        REQUIRE ?setjmp_r5
        REQUIRE ?longjmp_r5

        END
// 4541 
// 4542 #if defined ( ZBA_FALLBACK_NWKKEY )
// 4543 /******************************************************************************
// 4544  * @fn          ZDSecMgrFallbackNwkKey
// 4545  *
// 4546  * @brief       Use the ZBA fallback network key.
// 4547  *
// 4548  * @param       none
// 4549  *
// 4550  * @return      none
// 4551  */
// 4552 void ZDSecMgrFallbackNwkKey( void )
// 4553 {
// 4554   if ( !_NIB.nwkKeyLoaded )
// 4555   {
// 4556     uint8 fallbackKey[SEC_KEY_LEN];
// 4557 
// 4558     ZDSecMgrReadKeyFromNv( ZCD_NV_PRECFGKEY, fallbackKey );
// 4559     SSP_UpdateNwkKey( fallbackKey, 0);
// 4560     SSP_SwitchNwkKey( 0 );
// 4561 
// 4562     // clear local copy of key
// 4563     osal_memset( fallbackKey, 0x00, SEC_KEY_LEN );
// 4564 
// 4565     // handle next step in authentication process
// 4566     ZDSecMgrAuthNwkKey();
// 4567   }
// 4568 }
// 4569 #endif // defined ( ZBA_FALLBACK_NWKKEY )
// 4570 
// 4571 #if defined ( NV_RESTORE )
// 4572 /******************************************************************************
// 4573  * @fn          ZDSecMgrClearNVKeyValues
// 4574  *
// 4575  * @brief       If NV_RESTORE is enabled and the status of the network needs
// 4576  *              default values this fuction clears ZCD_NV_NWKKEY,
// 4577  *              ZCD_NV_NWK_ACTIVE_KEY_INFO and ZCD_NV_NWK_ALTERN_KEY_INFO link
// 4578  *
// 4579  * @param       none
// 4580  *
// 4581  * @return      none
// 4582  */
// 4583 void ZDSecMgrClearNVKeyValues(void)
// 4584 {
// 4585   nwkActiveKeyItems keyItems;
// 4586   nwkKeyDesc nwkKey;
// 4587 
// 4588   osal_memset(&keyItems, 0x00, sizeof(nwkActiveKeyItems));
// 4589 
// 4590   osal_nv_write(ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), &keyItems);
// 4591 
// 4592   // Initialize NV items for NWK Active and Alternate keys.
// 4593   osal_memset( &nwkKey, 0x00, sizeof(nwkKeyDesc) );
// 4594 
// 4595   osal_nv_write(ZCD_NV_NWK_ACTIVE_KEY_INFO, 0, sizeof(nwkKeyDesc), &nwkKey);
// 4596 
// 4597   osal_nv_write(ZCD_NV_NWK_ALTERN_KEY_INFO, 0, sizeof(nwkKeyDesc), &nwkKey);
// 4598 }
// 4599 #endif // defined ( NV_RESTORE )
// 4600 
// 4601 /******************************************************************************
// 4602 ******************************************************************************/
// 
// 5 534 bytes in segment CODE
//    16 bytes in segment DATA16_C
//     1 byte  in segment DATA16_I
//     1 byte  in segment DATA16_ID
//    87 bytes in segment DATA16_Z
// 
// 5 534 bytes of CODE  memory
//    17 bytes of CONST memory
//    88 bytes of DATA  memory
//
//Errors: none
//Warnings: none
