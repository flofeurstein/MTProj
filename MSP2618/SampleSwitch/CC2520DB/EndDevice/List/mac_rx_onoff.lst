###############################################################################
#                                                                             #
# IAR C/C++ Compiler V5.52.1.50724/W32 for MSP430       10/Jun/2013  17:10:45 #
# Copyright 1996-2013 IAR Systems AB.                                         #
#                                                                             #
#    __rt_version  =  3                                                       #
#    __double_size =  32                                                      #
#    __reg_r4      =  free                                                    #
#    __reg_r5      =  free                                                    #
#    __pic         =  no                                                      #
#    __core        =  430X                                                    #
#    __data_model  =  small                                                   #
#    Source file   =  C:\Texas Instruments\ZStack-MSP2618-2.5.1\Components\ma #
#                     c\low_level\srf04\mac_rx_onoff.c                        #
#    Command line  =  -f "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\ #
#                     zstack\HomeAutomation\SampleSwitch\CC2520DB\..\..\..\To #
#                     ols\MSP2618\f8wConfig.cfg" (-DZIGBEEPRO -DSECURE=0      #
#                     -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                       #
#                     -DDEFAULT_CHANLIST=0x00000800                           #
#                     -DZDAPP_CONFIG_PAN_ID=0xFFFF -DNWK_START_DELAY=100      #
#                     -DEXTENDED_JOINING_RANDOM_MASK=0x007F                   #
#                     -DBEACON_REQUEST_DELAY=100                              #
#                     -DBEACON_REQ_DELAY_MASK=0x00FF                          #
#                     -DLINK_STATUS_JITTER_MASK=0x007F                        #
#                     -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_POLLED= #
#                     3000 -DNWK_INDIRECT_MSG_TIMEOUT=7 -DMAX_RREQ_ENTRIES=8  #
#                     -DAPSC_MAX_FRAME_RETRIES=3 -DNWK_MAX_DATA_RETRIES=2     #
#                     -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9              #
#                     -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40                #
#                     -DNWK_MAX_BINDING_ENTRIES=4                             #
#                     -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,       #
#                     0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00, 0x02,   #
#                     0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"                    #
#                     -DMAC_MAX_FRAME_SIZE=116 -DZDNWKMGR_MIN_TRANSMISSIONS=2 #
#                     0 -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000           #
#                     -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100         #
#                     -DREJOIN_POLL_RATE=440) -f "C:\Texas                    #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\Tools\MSP2618\f #
#                     8wEndev.cfg" (-DCPU6MHZ -DMAC_CFG_TX_DATA_MAX=3         #
#                     -DMAC_CFG_TX_MAX=6 -DMAC_CFG_RX_MAX=3) -f "C:\Texas     #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\Tools\MSP2618\f #
#                     8wZCL.cfg" (-DZCL_READ -DZCL_WRITE -DZCL_BASIC          #
#                     -DZCL_IDENTIFY -DZCL_ON_OFF -DZCL_KEY_ESTABLISH         #
#                     -DZCL_KEY_ESTABLISHMENT_KEY_GENERATE_TIMEOUT=4          #
#                     -DZCL_KEY_ESTABLISHMENT_MAC_GENERATE_TIMEOUT=10         #
#                     -DZCL_KEY_ESTABLISHMENT_EKEY_GENERATE_TIMEOUT=10        #
#                     -DZCL_LOAD_CONTROL -DZCL_SIMPLE_METERING -DZCL_PRICING  #
#                     -DZCL_MESSAGE -DZCL_TUNNELING -DZCL_TOU)                #
#                     -DZCL_DEVICE_MGMT "C:\Texas                             #
#                     Instruments\ZStack-MSP2618-2.5.1\Components\mac\low_lev #
#                     el\srf04\mac_rx_onoff.c" -D MSP430F2618 -D              #
#                     NWK_AUTO_POLL -D ZTOOL_P1 -D MT_TASK -D MT_SYS_FUNC -D  #
#                     MT_ZDO_FUNC -D LCD_SUPPORTED -lC "C:\Texas              #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\EndDevice\List\" -lA     #
#                     "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\zst #
#                     ack\HomeAutomation\SampleSwitch\CC2520DB\EndDevice\List #
#                     \" --remarks --diag_suppress Pe001,Pe193,Pe236,Pe826    #
#                     -o "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\ #
#                     zstack\HomeAutomation\SampleSwitch\CC2520DB\EndDevice\O #
#                     bj\" --debug -D__MSP430F2618__ -e --double=32 --clib    #
#                     -I "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\ #
#                     zstack\HomeAutomation\SampleSwitch\CC2520DB\" -I        #
#                     "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\zst #
#                     ack\HomeAutomation\SampleSwitch\CC2520DB\..\Source\"    #
#                     -I "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\ #
#                     zstack\HomeAutomation\SampleSwitch\CC2520DB\..\..\Sourc #
#                     e\" -I "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Proje #
#                     cts\zstack\HomeAutomation\SampleSwitch\CC2520DB\..\..\. #
#                     .\ZMain\MSP2618\" -I "C:\Texas                          #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\hal\include\" -I "C:\Texas                            #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\hal\target\MSP2618CC2520\" -I "C:\Texas               #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\mac\include\" -I "C:\Texas                            #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\mac\high_level\" -I "C:\Texas                         #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\mac\low_level\srf04\" -I "C:\Texas                    #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\mac\low_level\srf04\dual_chip\" -I "C:\Texas          #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\mt\" -I "C:\Texas Instruments\ZStack-MSP2618-2.5.1\Pr #
#                     ojects\zstack\HomeAutomation\SampleSwitch\CC2520DB\..\. #
#                     .\..\..\..\Components\osal\include\" -I "C:\Texas       #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\osal\mcu\msp430\" -I "C:\Texas                        #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\services\saddr\" -I "C:\Texas                         #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\services\sdata\" -I "C:\Texas                         #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\stack\af\" -I "C:\Texas Instruments\ZStack-MSP2618-2. #
#                     5.1\Projects\zstack\HomeAutomation\SampleSwitch\CC2520D #
#                     B\..\..\..\..\..\Components\stack\nwk\" -I "C:\Texas    #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\stack\sec\" -I "C:\Texas                              #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\stack\sapi\" -I "C:\Texas                             #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\stack\sys\" -I "C:\Texas                              #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\stack\zcl\" -I "C:\Texas                              #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\stack\zdo\" -I "C:\Texas                              #
#                     Instruments\ZStack-MSP2618-2.5.1\Projects\zstack\HomeAu #
#                     tomation\SampleSwitch\CC2520DB\..\..\..\..\..\Component #
#                     s\zmac\" -I "C:\Texas Instruments\ZStack-MSP2618-2.5.1\ #
#                     Projects\zstack\HomeAutomation\SampleSwitch\CC2520DB\.. #
#                     \..\..\..\..\Components\zmac\f8w\" --core=430X          #
#                     --data_model=small -Ohz --multiplier=16s                #
#                     --require_prototypes                                    #
#    List file     =  C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\zsta #
#                     ck\HomeAutomation\SampleSwitch\CC2520DB\EndDevice\List\ #
#                     mac_rx_onoff.lst                                        #
#    Object file   =  C:\Texas Instruments\ZStack-MSP2618-2.5.1\Projects\zsta #
#                     ck\HomeAutomation\SampleSwitch\CC2520DB\EndDevice\Obj\m #
#                     ac_rx_onoff.r43                                         #
#                                                                             #
#                                                                             #
###############################################################################

C:\Texas Instruments\ZStack-MSP2618-2.5.1\Components\mac\low_level\srf04\mac_rx_onoff.c
      1          /**************************************************************************************************
      2            Filename:       mac_rx_onoff.c
      3            Revised:        $Date: 2007-09-11 10:58:41 -0700 (Tue, 11 Sep 2007) $
      4            Revision:       $Revision: 15371 $
      5          
      6            Description:    Describe the purpose and contents of the file.
      7          
      8          
      9            Copyright 2006-2009 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, 
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE, 
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com. 
     38          **************************************************************************************************/
     39          
     40          /* ------------------------------------------------------------------------------------------------
     41           *                                          Includes
     42           * ------------------------------------------------------------------------------------------------
     43           */
     44          
     45          /* hal */
     46          #include "hal_defs.h"
     47          #include "hal_types.h"
     48          
     49          /* exported low-level */
     50          #include "mac_low_level.h"
     51          
     52          /* low-level specific */
     53          #include "mac_rx_onoff.h"
     54          #include "mac_rx.h"
     55          #include "mac_tx.h"
     56          
     57          /* target specific */
     58          #include "mac_radio_defs.h"

   \                                 In  segment DATA16_AN, at 0x23
   \   unsigned char volatile P1IFG
   \                     P1IFG:
   \   000000                DS8 1
     59          
     60          /* debug */
     61          #include "mac_assert.h"
     62          
     63          
     64          /* ------------------------------------------------------------------------------------------------
     65           *                                         Global Variables
     66           * ------------------------------------------------------------------------------------------------
     67           */

   \                                 In  segment DATA16_Z, align 1, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     68          uint8 macRxOnFlag;
   \                     macRxOnFlag:
   \   000000                DS8 1

   \                                 In  segment DATA16_Z, align 1, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     69          uint8 macRxEnableFlags;
   \                     macRxEnableFlags:
   \   000000                DS8 1
     70          
     71          
     72          /**************************************************************************************************
     73           * @fn          macRxOnOffInit
     74           *
     75           * @brief       Initialize variables for rx on/off module.
     76           *
     77           * @param       none
     78           *
     79           * @return      none
     80           **************************************************************************************************
     81           */

   \                                 In  segment CODE, align 2
     82          MAC_INTERNAL_API void macRxOnOffInit(void)
   \                     macRxOnOffInit:
     83          {
     84            macRxEnableFlags = 0;
   \   000000   C243....     MOV.B   #0x0, &macRxEnableFlags
     85            macRxOnFlag = 0;
   \   000004   C243....     MOV.B   #0x0, &macRxOnFlag
     86          }
   \   000008   1001         RETA
     87          
     88          
     89          /**************************************************************************************************
     90           * @fn          macRxEnable
     91           *
     92           * @brief       Set enable flags and then turn on receiver.
     93           *
     94           * @param       flags - byte containing rx enable flags to set
     95           *
     96           * @return      none
     97           **************************************************************************************************
     98           */

   \                                 In  segment CODE, align 2
     99          MAC_INTERNAL_API void macRxEnable(uint8 flags)
   \                     macRxEnable:
    100          {
   \   000000   1B15         PUSHM.W #0x2, R11
   \   000002   4A4C         MOV.B   R12, R10
    101            halIntState_t  s;
    102          
    103            MAC_ASSERT(flags != 0); /* rx flags not affected */
   \   000004   4C93         CMP.B   #0x0, R12
   \   000006   0220         JNE     ??macRxEnable_0
   \   000008   ........     CALLA   #halAssertHandler
    104          
    105            /* set enable flags and then turn on receiver */
    106            HAL_ENTER_CRITICAL_SECTION(s);
   \                     ??macRxEnable_0:
   \   00000C   0B42         MOV.W   SR, R11
   \   00000E   32C2         dint
   \   000010   0343         nop
    107            macRxEnableFlags |= flags;
   \   000012   C2DA....     BIS.B   R10, &macRxEnableFlags
    108            macRxOn();
   \   000016   ........     CALLA   #macRxOn
    109            HAL_EXIT_CRITICAL_SECTION(s);
   \   00001A   024B         MOV.W   R11, SR
    110          }
   \   00001C   1A17         POPM.W  #0x2, R11
   \   00001E   1001         RETA
    111          
    112          
    113          /**************************************************************************************************
    114           * @fn          macRxSoftEnable
    115           *
    116           * @brief       Set enable flags but don't turn on the receiver.  Useful to leave the receiver
    117           *              on after a transmit, but without turning it on immediately.
    118           *
    119           * @param       flags - byte containing rx enable flags to set
    120           *
    121           * @return      none
    122           **************************************************************************************************
    123           */

   \                                 In  segment CODE, align 2
    124          MAC_INTERNAL_API void macRxSoftEnable(uint8 flags)
   \                     macRxSoftEnable:
    125          {
   \   000000   0A12         PUSH.W  R10
   \   000002   ........     CALLA   #?Subroutine2
    126            halIntState_t  s;
    127          
    128            MAC_ASSERT(flags != 0); /* rx flags not affected */
    129          
    130            /* set the enable flags but do not turn on the receiver */
    131            HAL_ENTER_CRITICAL_SECTION(s);
   \                     ??CrossCallReturnLabel_3:
   \   000006   32C2         dint
   \   000008   0343         nop
    132            macRxEnableFlags |= flags;
   \   00000A   C2DA....     BIS.B   R10, &macRxEnableFlags
    133            HAL_EXIT_CRITICAL_SECTION(s);
   \   00000E   024F         MOV.W   R15, SR
    134          }
   \   000010   3A41         POP.W   R10
   \   000012   1001         RETA

   \                                 In  segment CODE, align 2
   \                     ?Subroutine2:
   \   000000   4A4C         MOV.B   R12, R10
   \   000002   4C93         CMP.B   #0x0, R12
   \   000004   0220         JNE     ??macRxDisable_0
   \   000006   ........     CALLA   #halAssertHandler
   \                     ??macRxDisable_0:
   \   00000A   0F42         MOV.W   SR, R15
   \   00000C   1001         RETA
    135          
    136          
    137          /**************************************************************************************************
    138           * @fn          macRxDisable
    139           *
    140           * @brief       Clear indicated rx enable flags.  If all flags are clear, turn off receiver
    141           *              unless there is an active receive or transmit.
    142           *
    143           * @param       flags - byte containg rx enable flags to clear
    144           *
    145           * @return      none
    146           **************************************************************************************************
    147           */

   \                                 In  segment CODE, align 2
    148          MAC_INTERNAL_API void macRxDisable(uint8 flags)
   \                     macRxDisable:
    149          {
   \   000000   0A12         PUSH.W  R10
   \   000002   ........     CALLA   #?Subroutine2
    150            halIntState_t  s;
    151          
    152            MAC_ASSERT(flags != 0); /* rx flags not affected */
    153          
    154            /* clear the indicated flags */
    155            HAL_ENTER_CRITICAL_SECTION(s);
   \                     ??CrossCallReturnLabel_2:
   \   000006   32C2         dint
   \   000008   0343         nop
    156            macRxEnableFlags &= (flags ^ 0xFF);
   \   00000A   7AE3         XOR.B   #0xff, R10
   \   00000C   C2FA....     AND.B   R10, &macRxEnableFlags
    157            HAL_EXIT_CRITICAL_SECTION(s);
   \   000010   024F         MOV.W   R15, SR
    158          
    159            /* turn off the radio if it is allowed */
    160            macRxOffRequest();
   \   000012   ........     CALLA   #macRxOffRequest
    161          }
   \   000016   3A41         POP.W   R10
   \   000018   1001         RETA
    162          
    163          
    164          /**************************************************************************************************
    165           * @fn          macRxHardDisable
    166           *
    167           * @brief       Clear all enable flags and turn off receiver.
    168           *
    169           * @param       none
    170           *
    171           * @return      none
    172           **************************************************************************************************
    173           */

   \                                 In  segment CODE, align 2
    174          MAC_INTERNAL_API void macRxHardDisable(void)
   \                     macRxHardDisable:
    175          {
   \   000000   0A12         PUSH.W  R10
    176            halIntState_t  s;
    177          
    178            HAL_ENTER_CRITICAL_SECTION(s);
   \   000002   0A42         MOV.W   SR, R10
   \   000004   32C2         dint
   \   000006   0343         nop
    179          
    180            macRxEnableFlags = 0;
   \   000008   C243....     MOV.B   #0x0, &macRxEnableFlags
    181            macRxOnFlag = 0;
   \   00000C   ........     CALLA   #?Subroutine1
    182          
    183            /* force receiver off */
    184            MAC_RADIO_RXTX_OFF();
    185            MAC_RADIO_FLUSH_RX_FIFO();
    186            MAC_DEBUG_TURN_OFF_RX_LED();
    187          
    188            HAL_EXIT_CRITICAL_SECTION(s);
   \                     ??CrossCallReturnLabel_0:
   \   000010   024A         MOV.W   R10, SR
    189          
    190            /* clean up after being forced off */
    191            macRxHaltCleanup();
   \   000012   ........     CALLA   #macRxHaltCleanup
    192          }
   \   000016   3A41         POP.W   R10
   \   000018   1001         RETA

   \                                 In  segment CODE, align 2
   \                     ?Subroutine1:
   \   000000   C243....     MOV.B   #0x0, &macRxOnFlag
   \   000004   7C404500     MOV.B   #0x45, R12
   \   000008   ........     CALLA   #macSpiCmdStrobe
   \   00000C   7C404700     MOV.B   #0x47, R12
   \   000010   ........     CALLA   #macSpiCmdStrobe
   \   000014   7C404700     MOV.B   #0x47, R12
   \   000018   ........     BRA     #macSpiCmdStrobe
    193          
    194          /**************************************************************************************************
    195           * @fn          macRxOnRequest
    196           *
    197           * @brief       Turn on the receiver if any rx enable flag is set.
    198           *
    199           * @param       none
    200           *
    201           * @return      none
    202           **************************************************************************************************
    203           */

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine0:
   \   000000   024A         MOV.W   R10, SR
   \   000002   3A41         POP.W   R10
   \   000004   1001         RETA

   \                                 In  segment CODE, align 2
    204          MAC_INTERNAL_API void macRxOnRequest(void)
   \                     macRxOnRequest:
    205          {
   \   000000   0A12         PUSH.W  R10
    206            halIntState_t  s;
    207          
    208            HAL_ENTER_CRITICAL_SECTION(s);
   \   000002   0A42         MOV.W   SR, R10
   \   000004   32C2         dint
   \   000006   0343         nop
    209            if (macRxEnableFlags)
   \   000008   C293....     CMP.B   #0x0, &macRxEnableFlags
   \   00000C   0224         JEQ     ??macRxOnRequest_0
    210            {
    211              macRxOn();
   \   00000E   ........     CALLA   #macRxOn
    212            }
    213            HAL_EXIT_CRITICAL_SECTION(s);
   \                     ??macRxOnRequest_0:
   \   000012   ....         JMP     ?Subroutine0
    214          }
    215          
    216          
    217          /**************************************************************************************************
    218           * @fn          macRxOffRequest
    219           *
    220           * @brief       Turn off receiver if permitted.
    221           *
    222           * @param       none
    223           *
    224           * @return      none
    225           **************************************************************************************************
    226           */

   \                                 In  segment CODE, align 2, keep-with-next
    227          MAC_INTERNAL_API void macRxOffRequest(void)
   \                     macRxOffRequest:
    228          {
   \   000000   0A12         PUSH.W  R10
    229            halIntState_t  s;
    230          
    231            HAL_ENTER_CRITICAL_SECTION(s);
   \   000002   0A42         MOV.W   SR, R10
   \   000004   32C2         dint
   \   000006   0343         nop
    232            if (!macRxEnableFlags)
   \   000008   C293....     CMP.B   #0x0, &macRxEnableFlags
   \   00000C   0B20         JNE     ??macRxOffRequest_0
    233            {
    234              if (!MAC_RX_IS_PHYSICALLY_ACTIVE() && !MAC_TX_IS_PHYSICALLY_ACTIVE())
   \   00000E   C293....     CMP.B   #0x0, &macRxActive
   \   000012   0838         JL      ??macRxOffRequest_0
   \   000014   C293....     CMP.B   #0x0, &macRxOutgoingAckFlag
   \   000018   0520         JNE     ??macRxOffRequest_0
   \   00001A   C293....     CMP.B   #0x0, &macTxActive
   \   00001E   0238         JL      ??macRxOffRequest_0
    235              {
    236                macRxOff();
   \   000020   ........     CALLA   #macRxOff
    237              }
    238            }
    239            HAL_EXIT_CRITICAL_SECTION(s);
   \                     ??macRxOffRequest_0:
   \   000024                REQUIRE ?Subroutine0
   \   000024                // Fall through to label ?Subroutine0
    240          }
    241          
    242          
    243          /**************************************************************************************************
    244           * @fn          macRxOn
    245           *
    246           * @brief       Turn on the receiver if it's not already on.
    247           *
    248           * @param       none
    249           *
    250           * @return      none
    251           **************************************************************************************************
    252           */

   \                                 In  segment CODE, align 2, keep-with-next
    253          MAC_INTERNAL_API void macRxOn(void)
   \                     macRxOn:
    254          {
   \   000000   0A12         PUSH.W  R10
    255            halIntState_t  s;
    256          
    257            HAL_ENTER_CRITICAL_SECTION(s);
   \   000002   0A42         MOV.W   SR, R10
   \   000004   32C2         dint
   \   000006   0343         nop
    258            if (!macRxOnFlag)
   \   000008   C293....     CMP.B   #0x0, &macRxOnFlag
   \   00000C   0620         JNE     ??macRxOn_0
    259            {
    260              macRxOnFlag = 1;
   \   00000E   D243....     MOV.B   #0x1, &macRxOnFlag
    261              MAC_RADIO_RX_ON();
   \   000012   7C404200     MOV.B   #0x42, R12
   \   000016   ........     CALLA   #macSpiCmdStrobe
    262              MAC_DEBUG_TURN_ON_RX_LED();
    263            }
    264            HAL_EXIT_CRITICAL_SECTION(s);
   \                     ??macRxOn_0:
   \   00001A   ....         JMP     ?Subroutine0
    265          }
    266          
    267          
    268          /**************************************************************************************************
    269           * @fn          macRxOff
    270           *
    271           * @brief       Turn off the receiver if it's not already off.
    272           *
    273           * @param       none
    274           *
    275           * @return      none
    276           **************************************************************************************************
    277           */

   \                                 In  segment CODE, align 2, keep-with-next
    278          MAC_INTERNAL_API void macRxOff(void)
   \                     macRxOff:
    279          {
   \   000000   0A12         PUSH.W  R10
    280            halIntState_t  s;
    281          
    282            HAL_ENTER_CRITICAL_SECTION(s);
   \   000002   0A42         MOV.W   SR, R10
   \   000004   32C2         dint
   \   000006   0343         nop
    283            if (macRxOnFlag)
   \   000008   C293....     CMP.B   #0x0, &macRxOnFlag
   \   00000C   0524         JEQ     ??macRxOff_0
    284            {
    285              macRxOnFlag = 0;
   \   00000E   ........     CALLA   #?Subroutine1
    286              MAC_RADIO_RXTX_OFF();
    287              MAC_DEBUG_TURN_OFF_RX_LED();
    288              
    289              /* just in case a receive was about to start, flush the receive FIFO */
    290              MAC_RADIO_FLUSH_RX_FIFO();
    291          
    292              /* clear any receive interrupt that happened to squeak through */
    293              MAC_RADIO_CLEAR_RX_THRESHOLD_INTERRUPT_FLAG();
   \                     ??CrossCallReturnLabel_1:
   \   000012   F2C040002300 BIC.B   #0x40, &0x23
    294          
    295            }
    296            HAL_EXIT_CRITICAL_SECTION(s);
   \                     ??macRxOff_0:
   \   000018   ....         JMP     ?Subroutine0
   \   00001A                REQUIRE P1IFG
    297          }
    298          
    299          
    300          /**************************************************************************************************
    301          */

   Maximum stack usage in bytes:

   CSTACK Function
   ------ --------
      6   macRxDisable
        6   -> halAssertHandler
        6   -> macRxOffRequest
      8   macRxEnable
        8   -> halAssertHandler
        8   -> macRxOn
      6   macRxHardDisable
        6   -> macRxHaltCleanup
        6   -> macSpiCmdStrobe
      6   macRxOff
        6   -> macSpiCmdStrobe
      6   macRxOffRequest
        6   -> macRxOff
      6   macRxOn
        6   -> macSpiCmdStrobe
      4   macRxOnOffInit
      6   macRxOnRequest
        6   -> macRxOn
      6   macRxSoftEnable
        6   -> halAssertHandler


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
       6  ?Subroutine0
      28  ?Subroutine1
      14  ?Subroutine2
       1  P1IFG
      26  macRxDisable
      32  macRxEnable
       1  macRxEnableFlags
      26  macRxHardDisable
      26  macRxOff
      36  macRxOffRequest
      28  macRxOn
       1  macRxOnFlag
      10  macRxOnOffInit
      20  macRxOnRequest
      20  macRxSoftEnable

 
 272 bytes in segment CODE
   1 byte  in segment DATA16_AN
   2 bytes in segment DATA16_Z
 
 272 bytes of CODE memory
   2 bytes of DATA memory (+ 1 byte shared)

Errors: none
Warnings: none
